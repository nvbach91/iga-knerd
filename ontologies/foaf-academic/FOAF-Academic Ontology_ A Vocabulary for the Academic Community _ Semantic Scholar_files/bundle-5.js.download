(window.webpackJsonp=window.webpackJsonp||[]).push([[5,12],{1014:function(e,t,r){"use strict";var a=/^[-!#$%&'*+\/0-9=?A-Z^_a-z{|}~](\.?[-!#$%&'*+\/0-9=?A-Z^_a-z`{|}~])*@[a-zA-Z0-9](-*\.?[a-zA-Z0-9])*\.[a-zA-Z](-?[a-zA-Z0-9])+$/;t.validate=function(e){if(!e)return!1;if(e.length>254)return!1;if(!a.test(e))return!1;var t=e.split("@");return!(t[0].length>64)&&!t[1].split(".").some((function(e){return e.length>63}))}},1073:function(e,t){e.exports=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},1074:function(e,t,r){"use strict";var a=r(1075);function n(){}function o(){}o.resetWarningCache=n,e.exports=function(){function e(e,t,r,n,o,i){if(i!==a){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:n};return r.PropTypes=r,r}},1075:function(e,t,r){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},1110:function(e,t,r){"use strict";r.r(t);var a=r(14),n=r.n(a);function o(e){let{children:t}=e;if(!t)return null;const r=a.Children.toArray(t);return a.createElement("div",{className:"account-bar"},a.createElement("div",{className:"account-bar__columns"},a.createElement("div",{className:"account-bar__column account-bar__left"},r.find(e=>e.type===i)),a.createElement("div",{className:"account-bar__column account-bar__message"},r.find(e=>e.type===l)),a.createElement("div",{className:"account-bar__column account-bar__right"},r.find(e=>e.type===s))))}function i(e){let{children:t}=e;return t}function s(e){let{children:t}=e;return t}function l(e){let{children:t}=e;return t}var c=r(730),u=r(818),d=r(819),h=r(784),m=r(814),p=r(725),b=r(886);const g={ENTER:13,ESC:27};Object.freeze(g);Object.freeze(Object.keys(g).reduce((e,t)=>(e[g[t]]=t,e),{}));var f=r(226);var _=e=>{let{onSubmit:t}=e;const[r,n]=a.useState(!1),[o,i]=a.useState("");function s(){return!!o&&b.a.test(o)}function l(){s&&(t(o),i(""))}return a.createElement("div",{className:"author-add-papers__index-request-url__add-new"},r?a.createElement(a.Fragment,null,a.createElement(m.default,null),a.createElement("div",{className:"author-add-papers__index-request-url__add-new__form"},a.createElement("label",null,a.createElement(u.default,{className:"author-add-papers__index-request-url__add-new__form__label"},Object(f.b)(e=>e.authorAddPapers.indexRequests.add.urlField.label)),a.createElement(d.default,{placeholder:Object(f.b)(e=>e.authorAddPapers.indexRequests.add.urlField.placeholder),value:o,onChange:e=>i(e.target.value),onKeyDown:function(e){switch(e.keyCode){case 13:e.preventDefault(),l()}}})),a.createElement("div",{className:"author-add-papers__index-request-url__add-new__form__buttons"},a.createElement(c.default,{type:c.TYPE.TERTIARY,label:Object(f.b)(e=>e.authorAddPapers.indexRequests.add.cancelButton),onClick:function(){n(!1),i("")}}),a.createElement(c.default,{type:c.TYPE.PRIMARY,label:Object(f.b)(e=>e.authorAddPapers.indexRequests.add.submitButton),onClick:l,disabled:!s()})),a.createElement("div",{className:"author-add-papers__index-request-url__add-new__note"},a.createElement(p.a,{content:Object(f.b)(e=>e.authorAddPapers.indexRequests.add.note)})))):a.createElement(h.default,{label:Object(f.b)(e=>e.authorAddPapers.indexRequests.add.expandLink),onClick:()=>n(!0)}))},y=r(745);function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(Object(r),!0).forEach((function(t){S(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function S(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const v=e=>Object(y.a)(O({},e,{id:"author_add_paper_position_select"})),C=e=>Object(y.a)(O({},e,{},e,{id:"author_add_paper_position_unselect"}));var w=r(7);function P(){return(P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}class N extends a.PureComponent{constructor(){var e,t,r;super(...arguments),r=e=>{const{onChangePosition:t,position:r}=this.props;if(t)try{const a=JSON.parse(e.currentTarget.getAttribute("data-position")||"");a!==r&&t(a)}catch(e){w.a.error("failed to parse position",e)}},(t="onClickPosition")in(e=this)?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}render(){const{paper:e,position:t,reason:r,viewerFullName:n}=this.props;return a.createElement("div",{className:"author-add-papers__position__between"},e.authors.map(e=>e.alias.name).map((o,i)=>a.createElement(a.Fragment,{key:"".concat(e.id,"|").concat(o,"|").concat(i)},t===i?a.createElement(j,{viewerFullName:n,reason:r,position:i,onClick:this.onClickPosition}):a.createElement(x,{reason:r,position:i,onClick:this.onClickPosition}),a.createElement("div",{className:"author-add-papers__position__between__name"},o))),t===e.authors.size?a.createElement(j,{viewerFullName:n,reason:r,position:e.authors.size,onClick:this.onClickPosition}):a.createElement(x,{reason:r,position:e.authors.size,onClick:this.onClickPosition}))}}const x=e=>{let{reason:t,position:r,onClick:n}=e;return a.createElement("div",P({className:"author-add-papers__position__between__placement","data-position":r},v({reason:t,position:r}),{onClick:n}))},j=e=>{let{viewerFullName:t,reason:r,position:n,onClick:o}=e;return a.createElement("div",P({className:"author-add-papers__position__between__selected","data-position":"null"},C({reason:r,position:n}),{onClick:o}),a.createElement("div",{className:"author-add-papers__position__between__selected__author-name"},t),a.createElement("div",{className:"author-add-papers__position__you-tag"},Object(f.b)(e=>e.authorAddPapers.youTagLabel)))};function R(){return(R=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}const T=Object.freeze({NOT_LISTED:"notListed",WRONG_AUTHOR:"wrongAuthor",WRONG_NAME:"wrongName"}),A=Object.freeze(Object.keys(T).map(e=>e)),I=Object.freeze(A.map(e=>T[e]));class k extends a.PureComponent{constructor(){var e,t,r;super(...arguments),r=()=>{const{reason:e,onSelect:t}=this.props;t(e)},(t="onClickReason")in(e=this)?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}render(){const{label:e,reason:t}=this.props;return a.createElement("div",R({},(r={reason:t},Object(y.a)(O({},r,{id:"author_add_paper_reason"}))),{className:"author-add-papers__position-reason"}),a.createElement("div",{className:"author-add-papers__position-reason__label",onClick:this.onClickReason},e));var r}}var F=r(716),D=r.n(F);function L(){return(L=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function q(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class M extends a.PureComponent{constructor(){super(...arguments),q(this,"onClickPosition",e=>{const{onChangePosition:t,position:r}=this.props;if(t)try{const a=JSON.parse(e.currentTarget.getAttribute("data-position")||"");a!==r&&t(a)}catch(e){w.a.error("failed to parse position",e)}})}render(){const{paper:e,position:t,reason:r,viewerFullName:n,showReplacedName:o}=this.props;return a.createElement("div",{className:"author-add-papers__position__replace"},e.authors.map(e=>e.alias.name).map((i,s)=>{const l=s===t,c=o||!l;return a.createElement("div",L({className:D()({"author-add-papers__position__replace__name":!0,"author-add-papers__position__replace__is-selected":l}),key:"".concat(e.id,"|").concat(i,"|").concat(s),"data-position":l?"null":s},l?C({reason:r,position:s}):v({reason:r,position:s}),{onClick:this.onClickPosition}),c&&a.createElement("div",{className:"author-add-papers__position__replace__name__author-name"},i),a.createElement("div",{className:"author-add-papers__position__replace__name__viewer-name"},n),a.createElement("div",{className:"author-add-papers__position__you-tag"},Object(f.b)(e=>e.authorAddPapers.youTagLabel)))}))}}q(M,"defaultProps",{showReplacedName:!1});var H=r(152),z=r(151),U=r(113),V=r(3),B=r.n(V),Y=r(8),K=r.n(Y);function W(){return(W=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function G(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class X extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),G(this,"onClickBack",()=>{const{onChangeReason:e}=this.props;e&&e(null)}),G(this,"onSelectReason",e=>{const{onChangeReason:t}=this.props;t&&t(e)}),G(this,"onSelectPosition",e=>{const{reason:t,onChangePosition:r}=this.props;r&&(B()(t,"reason was not selected before a position was"),r(t,e))}),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(r),!0).forEach((function(t){G(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromAuthorProfileStore(),{},this.getStateFromAuthorCorrectionsStore(),{},this.getStateFromAuthorStore()),this.context.authorProfileStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorProfileStore())}),this.context.authorCorrectionsStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorCorrectionsStore())}),this.context.authorStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorStore())})}getStateFromAuthorProfileStore(){const e=this.context.authorProfileStore.getAuthorProfile();return{viewerFullName:e?e.fullName:null}}getStateFromAuthorCorrectionsStore(){const e=this.context.authorCorrectionsStore;return{moderatorCorrectionsAuthorId:e.getModeratorCorrectionsAuthorId(),isModeratorCorrecting:e.isModeratorCorrecting()}}getStateFromAuthorStore(){var e;const{authorStore:t}=this.context;return{authorName:null!=(e=t)&&null!=(e=e.author)?e.name:e}}render(){const{paper:e,reason:t,position:r}=this.props,{viewerFullName:n,authorName:o,isModeratorCorrecting:i}=this.state,s=i?o:n;return a.createElement("div",{className:"author-add-papers__position"},a.createElement("div",{className:"author-add-papers__position__instructions"},t?a.createElement(a.Fragment,null,a.createElement("span",{className:"author-add-papers__position__instructions__label"},Object(f.b)(e=>e.authorAddPapers.reason.choices[t].instructions)),a.createElement("span",{className:"author-add-papers__position__instructions__back"},"(",a.createElement("a",W({onClick:this.onClickBack},(l={reason:t},Object(y.a)(O({},l,{id:"author_add_paper_reason_back"})))),Object(f.b)(e=>e.authorAddPapers.reason.backLabel)),")")):a.createElement("span",{className:"author-add-papers__position__instructions__label"},Object(f.b)(e=>e.authorAddPapers.reason.instructions))),a.createElement("div",{className:"author-add-papers__position__controls"},(()=>{switch(t){case T.NOT_LISTED:return a.createElement(N,{paper:e,position:r,reason:T.NOT_LISTED,viewerFullName:s,onChangePosition:this.onSelectPosition});case T.WRONG_AUTHOR:return a.createElement(M,{paper:e,position:r,reason:T.WRONG_AUTHOR,viewerFullName:s,onChangePosition:this.onSelectPosition,showReplacedName:!0});case T.WRONG_NAME:return a.createElement(M,{paper:e,position:r,reason:T.WRONG_NAME,viewerFullName:s,onChangePosition:this.onSelectPosition});default:return I.map(e=>a.createElement(k,{key:e,onSelect:this.onSelectReason,reason:e,label:Object(f.b)(t=>t.authorAddPapers.reason.choices[e].reasonLabel)}))}})()));var l}}G(X,"contextTypes",{authorProfileStore:K.a.instanceOf(U.a).isRequired,authorCorrectionsStore:K.a.instanceOf(z.a).isRequired,authorStore:K.a.instanceOf(H.a).isRequired});var J=r(717);function Z(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class $ extends a.PureComponent{constructor(){super(...arguments),Z(this,"onClickRemove",()=>{const{paper:e,onRemovePaper:t}=this.props;t&&t(e)}),Z(this,"onChangeReason",e=>{const{paper:t,onChangeReason:r}=this.props;r&&r(t,e)}),Z(this,"onChangePosition",(e,t)=>{const{paper:r,onChangePosition:a}=this.props;a&&a(r,e,t)})}render(){const{paper:e,position:t,reason:r}=this.props,n=!r||"number"!=typeof t;return a.createElement("div",{"data-paper-id":e.id,className:D()({"author-add-papers__paper":!0,"author-add-papers__paper__is-draft":n})},a.createElement("div",{className:"author-add-papers__paper__remove-button",onClick:this.onClickRemove},a.createElement(J.a,{icon:"circle-plus"})),a.createElement("div",{className:"author-add-papers__paper__content"},a.createElement("div",{className:"author-add-papers__paper__section author-add-papers__paper__details"},a.createElement("div",{className:"author-add-papers__paper__title"},e.title.text),!r&&a.createElement("div",{className:"author-add-papers__paper__authors"},e.authors.map(e=>e.alias.name).join(", "))),a.createElement("div",{className:"author-add-papers__paper__section author-add-papers__paper__position"},a.createElement(X,{paper:e,position:t,reason:r,onChangeReason:this.onChangeReason,onChangePosition:this.onChangePosition}))))}}function ee(){return(ee=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function te(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class re extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),te(this,"onFocusSearch",()=>{const{onFocus:e}=this.props;e&&e()}),te(this,"onInputSearch",e=>{const{onChange:t}=this.props;if(t){const{value:r}=e.currentTarget;this.setState({searchText:r}),t(r)}}),this.state={searchText:""}}render(){const{isLoading:e}=this.props,{searchText:t}=this.state;return a.createElement("div",{className:D()({"author-add-papers__search":!0,"author-add-papers__search__is-loading":e})},a.createElement("input",ee({className:"legacy__input author-add-papers__search__input",type:"text",value:t,placeholder:Object(f.b)(e=>e.authorAddPapers.searchLabel)},Object(y.a)({id:"author_add_paper_search"}),{onFocus:this.onFocusSearch,onChange:this.onInputSearch})),a.createElement(J.a,{icon:e?"gear":"search-small"}))}}var ae=r(732),ne=r(0),oe=r.n(ne);function ie(){return(ie=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function se(e){let{onAddPaper:t,papers:r}=e;return a.createElement("div",{className:"author-add-papers__results"},r.isEmpty()?a.createElement("div",{className:"author-add-papers__results__empty"},Object(f.b)(e=>e.authorAddPapers.noResultsLabel)):a.createElement("ul",{className:"author-add-papers__results__paper-list"},r.map(e=>a.createElement(le,{key:e.id,onAddPaper:t,paper:e}))))}function le(e){let{onAddPaper:t,paper:r}=e;const n=function(e){let{venue:t,year:r}=e;if(t&&r)return Object(f.b)(e=>e.authorRemovePapers.publisher.bothYearAndVenue,r.text,t.text);if(r)return Object(f.b)(e=>e.authorRemovePapers.publisher.onlyYear,r.text);if(t)return Object(f.b)(e=>e.authorRemovePapers.publisher.onlyVenue,t.text);return null}({year:r.year,venue:r.venue});return a.createElement("li",ie({className:"author-add-papers__results__paper"},Object(y.a)({id:"author_add_paper_result"}),{onClick:()=>t(r)}),a.createElement("div",{className:"author-add-papers__results__paper__title"},a.createElement(ae.a,{field:r.title})),a.createElement("div",{className:"author-add-papers__results__paper__author-list"},r.authors.map(e=>a.createElement(ae.a,{key:"".concat(r.id,"|").concat(e.alias.ids.join(","),"|").concat(e.alias.slug),className:"author-add-papers__results__paper__author",field:e.highlightedField}))),n&&a.createElement("div",{className:"author-add-papers__results__paper__publisher"},n))}class ce extends a.PureComponent{render(){return a.createElement("div",{className:"author-add-papers__blank-state"},a.createElement("div",{className:"author-add-papers__blank-state__content"},a.createElement(J.a,{className:"author-add-papers__blank-state__icon",icon:"paper-magnifying-glass",width:"60",height:"77.5"}),a.createElement("div",{className:"author-add-papers__blank-state__description"},Object(f.b)(e=>e.authorAddPapers.blankLabel))))}}var ue=r(723);var de=e=>{let{url:t,onRemove:r}=e;return a.createElement("div",{className:D()("author-add-papers__paper")},a.createElement("div",{className:"author-add-papers__paper__remove-button",onClick:()=>r(t)},a.createElement(J.a,{icon:"circle-plus"})),a.createElement("div",{className:"author-add-papers__paper__content"},a.createElement("div",{className:"author-add-papers__paper__section author-add-papers__paper__details"},a.createElement("div",{className:"author-add-papers__index-request-url__label"},Object(f.b)(e=>e.authorAddPapers.indexRequests.listItem.label)),a.createElement("div",{className:"author-add-papers__index-request-url__url"},t))))},he=r(746),me=r(42),pe=r(149),be=r(48),ge=r(9),fe=r(74),_e=r.n(fe);function ye(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Ee extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),ye(this,"onKeyDown",e=>{switch(e.keyCode){case 27:this.setState({canResultsBeVisible:!1})}}),ye(this,"onChangeSearch",e=>{this.setState({searchText:e},()=>{e?this.searchPapers().catch(e=>this.onApiError(e)):this.setState({searchPapers:ne.List()})})}),ye(this,"onFocusSearch",()=>{this.setState({canResultsBeVisible:!0})}),ye(this,"onAddPaper",e=>{const t=this.context.authorCorrectionsStore,{addedPapers:r}=this.state;this.setState({canResultsBeVisible:!1,addedPapers:r.set(e.id,{paper:e,position:null,reason:null})}),t.addDraftPaperId(e.id)}),ye(this,"onRemovePaper",e=>{const{addedPapers:t}=this.state;this.setState({addedPapers:t.delete(e.id)}),this.context.authorCorrectionsStore.cancelPendingCorrectionByPaperId(e.id)}),ye(this,"onAddIndexUrl",e=>{const{addedPapers:t}=this.state,r=t.set(e,e);this.setState({addedPapers:r}),this.context.authorCorrectionsStore.addPendingIndexRequestUrl(e)}),ye(this,"onRemoveIndexUrl",e=>{const{addedPapers:t}=this.state;this.setState({addedPapers:t.delete(e)}),this.context.authorCorrectionsStore.removePendingIndexRequestUrl(e)}),ye(this,"onChangeReason",(e,t)=>{const{addedPapers:r}=this.state;this.setState({addedPapers:r.set(e.id,{paper:e,position:null,reason:t})});const a=this.context.authorCorrectionsStore;a.cancelPendingCorrectionByPaperId(e.id),a.addDraftPaperId(e.id)}),ye(this,"onChangePosition",(e,t,r)=>{const{addedPapers:a}=this.state;this.setState({addedPapers:a.set(e.id,{paper:e,position:r,reason:t})});const n=this.context.authorCorrectionsStore;if("number"==typeof r)switch(t){case T.NOT_LISTED:n.enqueueAddPaperCorrection({paperId:e.id,position:r});break;case T.WRONG_AUTHOR:case T.WRONG_NAME:{const t=e.authors.get(r).alias.canonicalId(),a=t?parseInt(t,10):null;n.enqueueSwapPaperCorrection({fromAuthorId:a,paperId:e.id,position:r});break}}else n.cancelPendingCorrectionByPaperId(e.id),n.addDraftPaperId(e.id)}),ye(this,"onClickCapture",e=>{e.preventDefault(),e.stopPropagation(),this.setState({canResultsBeVisible:!1})}),this.state={isLoading:!1,errorMessage:null,canResultsBeVisible:!1,hasFetchedPapers:!1,addedPapers:ne.OrderedMap(),searchPapers:ne.List(),searchText:""},this.onChangeSearchThrottled=Object(he.a)(this.onChangeSearch,1e3,{leading:!0,trailing:!0})}onApiError(e){w.a.error("Api Error",e),this.setState({errorMessage:Object(f.b)(e=>e.authorRemovePapers.error.apiQueryFailed),isLoading:!1})}async searchPapers(){var e;await Object(me.d)(this,{isLoading:!0,canResultsBeVisible:!0});const{authorId:t}=this.props,{api:r}=this.context,{searchText:a}=this.state;let n=a;const{protocol:o,pathname:i}=_e.a.parse(a);if(o){const e=ge.a.PAPER_DETAIL.exec(i)[2];e&&(n=e)}const s=await r.searchPapers({query:n,page:1,limit:10,excludeAuthorId:t,model:"Paper",prependSuggestions:!0});if(this.state.searchText!==a)return void w.a.info("Search results dropped, text is no longer ".concat(a));await Object(me.d)(this,{isLoading:!1,hasFetchedPapers:!0});const l=ne.List((null!=(e=s)&&null!=(e=e.resultData)?e.papers:e)||[]).map(be.a.fromJs);await Object(me.d)(this,{searchPapers:l})}render(){const{showDraftAsError:e}=this.props,{isLoading:t,hasFetchedPapers:r,addedPapers:n,searchPapers:o,searchText:i,canResultsBeVisible:s}=this.state,l=s&&r&&i;return a.createElement("div",{onKeyDown:this.onKeyDown,className:D()({"author-add-papers":!0,"author-add-papers__is-empty":!1,"author-add-papers__is-loading":t,"author-add-papers__show-draft-as-error":e})},l&&a.createElement("div",{className:"author-add-papers__click-capture",onClick:this.onClickCapture}),a.createElement("div",{className:"author-add-papers__controls"},a.createElement(re,{isLoading:t,onChange:this.onChangeSearchThrottled,onFocus:this.onFocusSearch}),a.createElement(ue.c,{feature:e=>e.AuthorAddPapersIndexRequests},a.createElement(ue.b,null,a.createElement(_,{onSubmit:this.onAddIndexUrl}))),l&&a.createElement(se,{onAddPaper:this.onAddPaper,papers:o})),n.isEmpty()&&a.createElement(ce,null),a.createElement("div",{className:"author-add-papers__paper-list"},n.valueSeq().reverse().map(e=>"string"==typeof e?a.createElement(de,{key:e,url:e,onRemove:this.onRemoveIndexUrl}):a.createElement($,{key:e.paper.id,paper:e.paper,position:e.position,reason:e.reason,onRemovePaper:this.onRemovePaper,onChangeReason:this.onChangeReason,onChangePosition:this.onChangePosition}))))}}ye(Ee,"contextTypes",{api:K.a.instanceOf(pe.a).isRequired,authorCorrectionsStore:K.a.instanceOf(z.a).isRequired});var Oe,Se,ve,Ce=r(721),we=r(34);class Pe extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),this.state={isLoading:!0,authorPapers:ne.List()}}componentDidMount(){this.fetchAuthorPapers().catch(e=>this.onApiError(e))}onApiError(e){w.a.error("Api Error",e),this.setState({isLoading:!1})}async fetchAuthorPapers(){var e,t;await Object(me.d)(this,{isLoading:!0});const{authorId:r}=this.props,{api:a}=this.context,n=await a.fetchPapersWithCorrectionsAppliedForAuthor({authorId:r,model:"PaperLite"});await Object(me.d)(this,{isLoading:!1});const o=null!=(t=n)&&null!=(t=t.resultData)?t.authorId:t;B()(r===o,"browser and server author IDs do not match");const i=ne.List((null!=(e=n)&&null!=(e=e.resultData)?e.paperLites:e)||[]).map(we.a.fromJs);await Object(me.d)(this,{authorPapers:i})}render(){const{isLoading:e,authorPapers:t}=this.state;return e?a.createElement(Ce.a,null):a.createElement("div",null,a.createElement("h2",null,Object(f.a)(e=>e.correctionsCurrentPapers.headerText,t.size)),a.createElement("ul",null,t.map(e=>a.createElement("li",{key:e.id,className:"corrections-curent-papers__paper"},e.title))))}}Oe=Pe,Se="contextTypes",ve={api:K.a.instanceOf(pe.a).isRequired},Se in Oe?Object.defineProperty(Oe,Se,{value:ve,enumerable:!0,configurable:!0,writable:!0}):Oe[Se]=ve;var Ne=r(104),xe=r(73),je=r(83),Re=r(55),Te=r.n(Re);function Ae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ie(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var ke=function(e){function t(){return Ae(this,t),Ie(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.enable=function(e){this.unblock&&this.unblock(),this.unblock=this.context.router.history.block(e)},t.prototype.disable=function(){this.unblock&&(this.unblock(),this.unblock=null)},t.prototype.componentWillMount=function(){B()(this.context.router,"You should not use <Prompt> outside a <Router>"),this.props.when&&this.enable(this.props.message)},t.prototype.componentWillReceiveProps=function(e){e.when?this.props.when&&this.props.message===e.message||this.enable(e.message):this.disable()},t.prototype.componentWillUnmount=function(){this.disable()},t.prototype.render=function(){return null},t}(n.a.Component);ke.propTypes={when:Te.a.bool,message:Te.a.oneOfType([Te.a.func,Te.a.string]).isRequired},ke.defaultProps={when:!0},ke.contextTypes={router:Te.a.shape({history:Te.a.shape({block:Te.a.func.isRequired}).isRequired}).isRequired};var Fe=ke,De=r(5);function Le(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function qe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Me=[xe.a.AddAuthorship,xe.a.SwapAuthorship];class He extends a.Component{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),qe(this,"onSubmitForm",e=>{e.preventDefault(),this.state.hasDraftPapers?this.setState({hasAttemptedSubmit:!0,errorMessage:Object(f.b)(e=>e.authorAddPapers.error.papersInDraft)},()=>{Object(De.a)()&&this.scrollToPaper(this.context.authorCorrectionsStore.getDraftPaperIds().first())}):this.setState({hasAttemptedSubmit:!0},()=>{this.attemptSubmit()})}),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Le(Object(r),!0).forEach((function(t){qe(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Le(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({isSending:!1,errorMessage:null,successMessage:null,hasAttemptedSubmit:!1},this.getStateFromAuthStore(),{},this.getStateFromAuthorCorrectionsStore(),{},this.getStateFromAuthorStore()),this.context.authStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthStore())}),this.context.authorCorrectionsStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorCorrectionsStore())}),this.context.authorStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorStore())}),this.state.authorId=this.state.isModeratorCorrecting?this.state.moderatorCorrectionsAuthorId:this.state.authorId}getStateFromAuthStore(){return{authorId:this.context.authStore.getClaimedAuthorId()}}getStateFromAuthorCorrectionsStore(){const e=this.context.authorCorrectionsStore,t=e.hasDraftPapers();return{isFormDirty:e.hasPendingCorrections()||t,pendingCorrections:e.getPendingCorrections().filter(e=>Me.includes(e.correctionType)),hasDraftPapers:t,isModeratorCorrecting:e.isModeratorCorrecting(),moderatorCorrectionsAuthorId:e.getModeratorCorrectionsAuthorId()}}getStateFromAuthorStore(){var e;const{authorStore:t}=this.context;return{authorName:null!=(e=t)&&null!=(e=e.author)?e.name:e}}scrollToPaper(e){if(!e)return!1;const t=document.querySelector('.author-add-papers__paper[data-paper-id="'.concat(e,'"]'));return!!t&&(t.scrollIntoView({behavior:"smooth"}),!0)}async attemptSubmit(){const{authorId:e,pendingCorrections:t,isModeratorCorrecting:r}=this.state,a=this.context.authorCorrectionsStore,n=this.context.api,o=a.getPendingIndexRequestUrls();await Object(me.d)(this,{isSending:!0,errorMessage:null,successMessage:null});try{t&&await n.submitPaperAuthorCorrections({authorId:e,corrections:t.toJS()}),o&&await n.submitAuthorIndexRequests({urls:o.toJS()}),a.clearPendingCorrections(),a.clearPendingIndexRequests();const i=this.context.history,s=r?"AUTHOR_CORRECTIONS_TOOL_STATUS":"ACCOUNT_CORRECTIONS";i.push(Object(ge.d)({routeName:s}))}catch(e){w.a.error("Failed to submit paper changes",e),this.setState({isSending:!1,errorMessage:Object(f.b)(e=>e.authorAddPapers.error.apiSubmitFailed),successMessage:null})}}renderMessage(){const{errorMessage:e,successMessage:t}=this.state;return e?a.createElement("div",{className:"account__error-msg"},e):t?a.createElement("div",{className:"account__success-msg"},t):null}render(){const{authorId:e,isSending:t,hasDraftPapers:r,hasAttemptedSubmit:n,isFormDirty:i,isModeratorCorrecting:c,authorName:u}=this.state,d=c?Object(f.b)(e=>e.moderatorCorrections.addPapers.pageHeading,u):Object(f.b)(e=>e.account.page.addPapers.pageHeading),h=c?Object(f.b)(e=>e.moderatorCorrections.addPapers.pageDescription):Object(f.b)(e=>e.account.page.addPapers.pageDescription);return a.createElement("div",{className:"account-add-papers"},a.createElement("h2",{className:"account-add-papers__headline"},d),a.createElement("div",{className:"account-add-papers__description"},a.createElement(p.a,{content:h})),a.createElement("hr",{className:"account__divider"}),e&&a.createElement(Ee,{key:e,showDraftAsError:n&&r,authorId:e}),a.createElement(o,null,a.createElement(l,null,this.renderMessage()),a.createElement(s,null,t&&a.createElement(J.a,{className:"account__loading",icon:"gear"}),a.createElement("button",{className:"account-add-papers__submit-button button button--primary",onClick:this.onSubmitForm},Object(f.b)(e=>e.account.button.submit)))),e&&a.createElement(Pe,{authorId:e}),a.createElement(Fe,{when:i,message:Object(f.b)(e=>e.authorAddPapers.error.dirtyForm)}))}}qe(He,"contextTypes",{api:K.a.instanceOf(pe.a).isRequired,authStore:K.a.instanceOf(Ne.a).isRequired,authorCorrectionsStore:K.a.instanceOf(z.a).isRequired,authorStore:K.a.instanceOf(H.a).isRequired,history:K.a.instanceOf(je.a).isRequired});var ze=r(103);function Ue(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("shared-AccountAddPapersPage"),a.createElement(He,e)}class Ve extends a.Component{render(){return a.createElement(Ue,null)}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Ve,"getPageTitle",()=>Object(f.b)(e=>e.account.page.addPapers.pageTitle));var Be=r(718);function Ye(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Ke(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class We extends a.Component{constructor(e,t){super(e,t),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ye(Object(r),!0).forEach((function(t){Ke(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ye(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromAuthStore()),this.context.authStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthStore())})}getStateFromAuthStore(){return{claimedAuthorId:this.context.authStore.getClaimedAuthorId()}}render(){const{claimedAuthorId:e}=this.state;return e?a.createElement("div",{className:"account-author-claim-pending"},a.createElement("h2",null,Object(f.b)(e=>e.account.page.authorClaimPending.pageHeading)),a.createElement("div",{className:"account-author-claim-pending__description"},Object(f.b)(e=>e.authorClaimPending.description)),a.createElement("div",{className:"account-author-claim-pending__banner"},a.createElement(J.a,{icon:"status-waiting"}),a.createElement("div",{className:"account-author-claim-pending__banner__label"},Object(f.b)(e=>e.authorClaimPending.bannerLabel))),a.createElement("hr",{className:"account-author-claim-pending__rule"}),a.createElement("div",{className:"account-author-claim-pending__status-instructions"},a.createElement(p.a,{content:Object(f.b)(e=>e.authorClaimPending.statusInstruction)})),a.createElement("div",{className:"account-author-claim-pending__button-row"},a.createElement(Be.a,{to:"AUTHOR_PROFILE_BY_ID",params:{authorId:e},className:"button button--secondary"},Object(f.b)(e=>e.authorClaimPending.authorLinkLabel)))):null}}function Qe(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("shared-AccountAuthorClaimPendingPage"),a.createElement(We,e)}Ke(We,"contextTypes",{authStore:K.a.instanceOf(Ne.a).isRequired});class Ge extends a.Component{render(){return a.createElement(Qe,null)}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Ge,"getPageTitle",()=>Object(f.b)(e=>e.account.page.authorClaimPending.pageTitle));var Xe=r(6),Je=r(171),Ze=r.n(Je);function $e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function et(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$e(Object(r),!0).forEach((function(t){tt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$e(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function tt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const{EventEmitter:rt}=Ze.a;class at extends Xe.a{constructor(e){super(),this._api=e,this._formEventEmitter=new rt,this._registeredFields=new Map,this._stateOfFields=new Map,this._isSending=!1,this._formErrorMsg=null,this._formEventEmitter.setMaxListeners(1e3)}destroy(){this._formEventEmitter.removeAllListeners(),this._stateOfFields.clear(),this._registeredFields.clear()}subscribe(e,t){return this._addListener(e,t),()=>{this._removeListener(e,t)}}triggerSubmit(){this._emit("submit")}async submitToApi(e){this._isSending&&w.a.warn("Second attempt to submit a form while data is sending to API."),this.setSending(!0);try{const t=this.getFormValues(),r=await e(this._api,t);return this._cleanFormValues(),r}catch(e){this.setFormErrorMessage(e.message)}finally{this.setSending(!1)}}_addListener(e,t){this._formEventEmitter.addListener(e,t)}_removeListener(e,t){this._formEventEmitter.removeListener(e,t)}_emit(e){this._formEventEmitter.emit(e)}registerField(e){const{fieldName:t,initialValue:r,onChange:a,onClear:n,onReset:o}=e;B()(!this._registeredFields.has(t),"Field ".concat(t," already exists in FormStore")),this._registeredFields.set(t,e),this._stateOfFields.set(t,{errorMessage:null,fieldName:t,value:r}),a&&this._addListener("change-".concat(t),a),n&&this._addListener("clear",n),o&&this._addListener("reset",o)}unregisterField(e){const t=this._registeredFields.get(e);t&&(this._registeredFields.delete(e),this._stateOfFields.delete(e),t.onChange&&this._removeListener("change-".concat(e),t.onChange),t.onClear&&this._removeListener("clear",t.onClear),t.onReset&&this._removeListener("reset",t.onReset))}getFieldNames(){return[...this._registeredFields.keys()]}setFieldErrorMessage(e,t){const r=this._stateOfFields.get(e);B()(r,"Field ".concat(e," cannot set error message, it's missing from state")),r.errorMessage!==t&&(this._stateOfFields.set(e,et({},r,{errorMessage:t})),this._emit("change-".concat(e)),this.emitChange())}getFieldErrorMessage(e){const t=this._stateOfFields.get(e);return B()(t,"Field ".concat(e," cannot get error message, it's missing from state")),t.errorMessage||null}getFieldsWithErrors(){return[...this._stateOfFields.values()].filter(e=>!!e.errorMessage).map(e=>e.fieldName)}hasFieldError(e){return!!this.getFieldErrorMessage(e)}hasFieldErrors(){return this.getFieldsWithErrors().length>0}setInitialFieldValue(e,t){const r=this._registeredFields.get(e);return B()(r,"Field ".concat(e," was unable to set initial value because it was not yet registered.")),this.isFieldDirty(e)?(w.a.warn("Was unable to set the initial field value for ".concat(e," because it was dirty")),!1):(this._registeredFields.set(e,et({},r,{initialValue:t})),this.setFieldValue(e,t),!0)}getFieldValue(e){const t=this._stateOfFields.get(e);return B()(t,"Field ".concat(e," cannot get value, it's missing from state")),t.value}setFieldValue(e,t){this._setFieldValue(e,t)&&this._emit("change-".concat(e))}_setFieldValue(e,t){const r=this._stateOfFields.get(e);return B()(r,"Field ".concat(e," cannot be updated, it's missing from state")),r.value!==t&&(this._stateOfFields.set(e,et({},r,{errorMessage:null,value:t})),!0)}resetFieldValue(e){this._resetFieldValue(e)&&this._emit("change-".concat(e))}_resetFieldValue(e){const t=this._registeredFields.get(e);return B()(t,"Field ".concat(e," cannot be reset, it's missing from state")),B()(void 0!==t.initialValue,"Field ".concat(e," cannot be reset, it's initial value is undefined")),this._setFieldValue(e,t.initialValue)}clearFieldValue(e){this._clearFieldValue(e)&&this._emit("change-".concat(e))}_clearFieldValue(e){return this._setFieldValue(e,null)}resetForm(){const e=[];for(const[t]of this._stateOfFields)this._resetFieldValue(t)&&e.push(t);for(const t of e)this._emit("change-".concat(t));this._emit("reset")}clearForm(){const e=[];for(const[t]of this._stateOfFields)this._clearFieldValue(t)&&e.push(t);for(const t of e)this._emit("change-".concat(t));this._emit("clear")}hasError(){return!!this.getFormErrorMessage()||this.hasFieldErrors()}getFormErrorMessage(){return this._formErrorMsg||null}setFormErrorMessage(e){this._formErrorMsg!==e&&(this._formErrorMsg=e||null,this.emitChange())}_clearFormErrorMessage(){this._formErrorMsg=null}getFormValues(){const e={};for(const[t,r]of this._stateOfFields)e[t]=r.value;return e}getDirtyFieldNames(){return this.getFieldNames().filter(e=>this.isFieldDirty(e))}_cleanFormValues(){for(const[e]of this._stateOfFields){const t=this._registeredFields.get(e),r=this._stateOfFields.get(e);B()(t&&r,"Field ".concat(e," was missing when attempting to clean the fieldValue.")),this._registeredFields.set(e,et({},t,{initialValue:r.value}))}}isFieldDirty(e){const t=this._registeredFields.get(e),r=this._stateOfFields.get(e);return B()(t&&r,"Field ".concat(e," was not registered at the time of checking dirty state.")),t.initialValue&&"function"==typeof t.initialValue.equals?!t.initialValue.equals(r.value):t.initialValue!==r.value}isFormDirty(){const e=this.getFieldNames();for(const t of e)if(this.isFieldDirty(t))return!0;return!1}isSending(){return this._isSending}setSending(e){this._isSending!==e&&(this._isSending=e,this.emitChange())}async validate(){this._clearFormErrorMessage();const e=[...this._registeredFields.values()].filter(e=>e.onValidate),t=0===(await Promise.all(e.map(e=>e.onValidate&&e.onValidate(this).then(t=>(this.setFieldErrorMessage(e.fieldName,t),!t),t=>(t instanceof Error?(w.a.error("Failed to validate ".concat(e.fieldName,": threw Error"),t),this.setFieldErrorMessage(e.fieldName,t.message)):"string"==typeof t?this.setFieldErrorMessage(e.fieldName,t):t?(w.a.error("Failed to validate ".concat(e.fieldName,": unexpected error message type"),t),this.setFieldErrorMessage(e.fieldName,t.toString())):(w.a.error("Failed to validate ".concat(e.fieldName,": message was falsy"),t),this.setFieldErrorMessage(e.fieldName,"Field is invalid.")),!1))))).filter(e=>!e).length;return this._emit("validate"),t}}function nt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function ot(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class it extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),this.onChange=this.onChange.bind(this);const{fieldName:n,initialValue:o}=this.props;this.context.formStore.registerField({fieldName:n,initialValue:o,onValidate:e.onValidate,onChange:()=>this.setState(this.getStateFromFormStore())}),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?nt(Object(r),!0).forEach((function(t){ot(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromFormStore())}componentDidUpdate(e){const t=this.context.formStore,r=this.props.initialValue||"";e.initialValue!==r&&t.setInitialFieldValue(e.fieldName,r)}componentWillUnmount(){this.context.formStore.unregisterField(this.props.fieldName)}getStateFromFormStore(){const e=this.context.formStore,{fieldName:t}=this.props;return{value:e.getFieldValue(t)||"",error:e.getFieldErrorMessage(t)}}onChange(e){const t=this.context.formStore,{fieldName:r}=this.props,{value:a}=e.currentTarget;t.setFieldValue(r,a)}render(){const{fieldName:e,label:t,placeholder:r,isRequired:n}=this.props,{value:o,error:i}=this.state;return a.createElement("label",{className:D()("author-edit__field",{"author-edit__has-error":i})},a.createElement("div",{className:"author-edit__field__label"},a.createElement("span",{className:"author-edit__field__label-text"},t),!n&&a.createElement("span",{className:"author-edit__field__label-optional"},Object(f.b)(e=>e.authorEdit.form.optional))),a.createElement("div",{className:"author-edit__field__input"},a.createElement("input",{type:"text",name:e,className:"legacy__input author-edit__field__input-text",value:o,onChange:this.onChange,placeholder:r}),a.createElement("div",{className:"author-edit__field__error"},i)))}}function st(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function lt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}ot(it,"contextTypes",{formStore:K.a.instanceOf(at).isRequired});class ct extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?st(Object(r),!0).forEach((function(t){lt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):st(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromAuthorProfileStore()),this.context.authorProfileStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorProfileStore())})}getStateFromAuthorProfileStore(){const e=this.context.authorProfileStore.getAuthorProfile();return e?{initialFirstName:e.firstName,initialMiddleNames:e.middleNames.join(" "),initialLastName:e.lastName}:{initialFirstName:"",initialMiddleNames:"",initialLastName:""}}render(){const{initialFirstName:e,initialMiddleNames:t,initialLastName:r}=this.state;return a.createElement(a.Fragment,null,a.createElement(it,{fieldName:"firstName",initialValue:e,label:Object(f.b)(e=>e.authorEdit.form.firstNameLabel),placeholder:Object(f.b)(e=>e.authorEdit.form.firstNamePlaceholder),isRequired:!1}),a.createElement(it,{fieldName:"middleNames",initialValue:t,label:Object(f.b)(e=>e.authorEdit.form.middleNamesLabel),placeholder:Object(f.b)(e=>e.authorEdit.form.middleNamesPlaceholder),isRequired:!1}),a.createElement(it,{fieldName:"lastName",initialValue:r,label:Object(f.b)(e=>e.authorEdit.form.lastNameLabel),placeholder:Object(f.b)(e=>e.authorEdit.form.lastNamePlaceholder),onValidate:ut,isRequired:!0}))}}async function ut(e){const t=e.getFieldValue("lastName");return"string"!=typeof t||0===t.trim().length?Object(f.b)(e=>e.authorEdit.error.lastNameMissing):null}lt(ct,"contextTypes",{authorProfileStore:K.a.instanceOf(U.a).isRequired});var dt=r(822),ht=r(823);function mt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function pt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class bt extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?mt(Object(r),!0).forEach((function(t){pt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromAuthorProfileStore()),this.context.authorProfileStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorProfileStore())})}getStateFromAuthorProfileStore(){const e=this.context.authorProfileStore.getAuthorProfile();if(!e)return{initialAffiliation:"",initialOrcidId:"",initialHomepageUrl:""};const{affiliations:t=[],orcidId:r="",homepageUrl:a=""}=e;return{initialAffiliation:t.join("; "),initialOrcidId:r,initialHomepageUrl:a}}render(){const{initialAffiliation:e,initialOrcidId:t,initialHomepageUrl:r}=this.state;return a.createElement(a.Fragment,null,a.createElement(it,{fieldName:"affiliation",initialValue:e,label:Object(f.b)(e=>e.authorEdit.form.affiliationLabel),placeholder:Object(f.b)(e=>e.authorEdit.form.affiliationPlaceholder),isRequired:!1}),a.createElement(it,{fieldName:"orcidId",initialValue:t,label:Object(f.b)(e=>e.authorEdit.form.orcidIdLabel),placeholder:Object(f.b)(e=>e.authorEdit.form.orcidIdPlaceholder),onValidate:gt,isRequired:!1}),a.createElement(it,{fieldName:"homepageUrl",initialValue:r,label:Object(f.b)(e=>e.authorEdit.form.homepageUrlLabel),placeholder:Object(f.b)(e=>e.authorEdit.form.homepageUrlPlaceholder),onValidate:ft,isRequired:!1}))}}async function gt(e){const t=e.getFieldValue("orcidId");return t?(B()("string"==typeof t,"value of orcid id was not a string"),t&&!ht.a.test(t)?Object(f.b)(e=>e.authorEdit.error.orcidIdInvalid):null):null}async function ft(e){const t=e.getFieldValue("homepageUrl");return t?(B()("string"==typeof t,"value of homepage was not a string"),t&&!dt.a.test(t)?Object(f.b)(e=>e.authorEdit.error.homepageUrlInvalid):null):null}function _t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function yt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}pt(bt,"contextTypes",{authorProfileStore:K.a.instanceOf(U.a).isRequired});class Et extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_t(Object(r),!0).forEach((function(t){yt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_t(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromFormStore()),this.context.formStore.registerComponent(this,()=>{this.setState(this.getStateFromFormStore())})}getStateFromFormStore(){return{isSending:this.context.formStore.isSending()}}render(){return a.createElement("div",{className:"author-edit"},a.createElement("div",{className:"author-edit__fields"},a.createElement(ct,null),a.createElement("hr",{className:"author-edit__divider"}),a.createElement(bt,null)))}}yt(Et,"contextTypes",{formStore:K.a.instanceOf(at).isRequired});var Ot=r(230),St=r(40);function vt(){return(vt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Ct(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Pt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Nt extends a.Component{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?wt(Object(r),!0).forEach((function(t){Pt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({successMessage:null},this.getStateFromFormStore(),{},this.getStateFromAuthorCorrectionsStore(),{},this.getStateFromAuthorStore()),this.props.formStore.registerComponent(this,()=>{this.setState(this.getStateFromFormStore())}),this.props.formStore.subscribe("submit",()=>{this.attemptSubmit()}),this.context.authorCorrectionsStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorCorrectionsStore())}),this.context.authorStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorStore())}),this.onClickUnclaim=this.onClickUnclaim.bind(this),this.onSubmitForm=this.onSubmitForm.bind(this)}getStateFromFormStore(){const{formStore:e}=this.props;return{errorMessage:e.getFormErrorMessage(),isFormDirty:e.isFormDirty(),isSending:e.isSending()}}getStateFromAuthorCorrectionsStore(){const{authorCorrectionsStore:e}=this.context;return{moderatorCorrectionsAuthorId:e.getModeratorCorrectionsAuthorId(),isModeratorCorrecting:e.isModeratorCorrecting()}}getStateFromAuthorStore(){var e;const{authorStore:t}=this.context;return{authorName:null!=(e=t)&&null!=(e=e.author)?e.name:e}}onSubmitForm(e){e.preventDefault(),this.attemptSubmit()}onClickUnclaim(e){e.preventDefault(),window.confirm(Object(f.b)(e=>e.authorEdit.unclaimDialogue))&&this.attemptUnclaim()}navigateToAuthorPage(e){this.context.history.push(Object(ge.d)({routeName:"AUTHOR_PROFILE_BY_ID",params:{authorId:e}}))}async attemptSubmit(){const{formStore:e}=this.props,{moderatorCorrectionsAuthorId:t,isModeratorCorrecting:r}=this.state,a=this.context.history;if(!await e.validate())return;const n=t||this.context.authStore.getClaimedAuthorId();if(!n)return void e.setFormErrorMessage(Object(f.b)(e=>e.authorEdit.error.noAuthorClaimed));await e.submitToApi(async(e,t)=>{try{await Promise.all([e.updateAuthorProfile({authorId:n,lastName:(t.lastName||"").trim(),middleNames:(t.middleNames||"").split(/\s+/).map(e=>e.trim()),firstName:(t.firstName||"").trim(),affiliation:(t.affiliation||"").split("; ").map(e=>e.trim()),homepageUrl:(t.homepageUrl||"").trim(),orcidId:(t.orcidId||"").trim()}),Object(me.a)(2e3)])}catch(e){throw new Error(Object(f.b)(e=>e.authorEdit.error.apiFailed))}});const o=r?"AUTHOR_CORRECTIONS_TOOL_STATUS":"ACCOUNT_CORRECTIONS",i=new St.a({routeName:o,replace:!0,status:302});Object(Ot.a)({redirect:i,history:a})}async attemptUnclaim(){const{formStore:e}=this.props,t=this.context.authStore.getClaimedAuthorId();if(!t)return void e.setFormErrorMessage(Object(f.b)(e=>e.authorEdit.error.noAuthorClaimed));const r=this.context.api;await r.unclaimAuthorProfile({authorId:t}),await r.fetchUserInfo(),this.navigateToAuthorPage(t)}renderMessage(){const{errorMessage:e,successMessage:t}=this.state;return e?a.createElement("div",{className:"account__error-msg"},e):t?a.createElement("div",{className:"account__success-msg"},t):null}render(){const{isSending:e,isFormDirty:t,isModeratorCorrecting:r,authorName:n}=this.state,c=r?Object(f.b)(e=>e.moderatorCorrections.contactInfo.pageHeading,n):Object(f.b)(e=>e.account.page.authorContact.pageHeading),u=r?Object(f.b)(e=>e.moderatorCorrections.contactInfo.pageDescription):Object(f.b)(e=>e.account.page.authorContact.pageDescription);return a.createElement("div",{className:"account-author-contact"},a.createElement("div",{className:"account-author-contact__headline"},c),a.createElement("div",{className:"account-author-contact__description"},a.createElement(p.a,{content:u})),a.createElement("hr",{className:"account__divider"}),a.createElement("form",{onSubmit:this.onSubmitForm},a.createElement(Et,null),a.createElement(o,null,a.createElement(l,null,this.renderMessage()),a.createElement(s,null,e&&a.createElement(J.a,{className:"account__loading",icon:"gear"}),a.createElement("button",{className:"account-author-contact__submit-button button button--primary",onClick:this.onSubmitForm},Object(f.b)(e=>e.account.button.submit))),a.createElement(i,null,!r&&a.createElement("button",{className:"button button--tertiary",onClick:this.onClickUnclaim},Object(f.b)(e=>e.authorEdit.form.unlinkLabel))))),a.createElement(Fe,{when:t,message:Object(f.b)(e=>e.authorEdit.error.dirtyForm)}))}}Pt(Nt,"contextTypes",{api:K.a.instanceOf(pe.a).isRequired,authorCorrectionsStore:K.a.instanceOf(z.a).isRequired,authorProfileStore:K.a.instanceOf(U.a).isRequired,authStore:K.a.instanceOf(Ne.a).isRequired,authorStore:K.a.instanceOf(H.a).isRequired,history:K.a.instanceOf(je.a).isRequired});var xt=function(e){class t extends a.Component{constructor(e,t){super(e,t);const r=new at(this.context.api);this.state={formStore:r},e.getFormStore&&e.getFormStore(r)}getChildContext(){const{formStore:e}=this.state;return{formStore:e}}render(){return a.createElement(e,vt({},this.props,{formStore:this.state.formStore}))}}return Ct(t,"contextTypes",{api:K.a.instanceOf(pe.a).isRequired}),Ct(t,"childContextTypes",{formStore:K.a.instanceOf(at)}),new Proxy(t,{get:(t,r)=>r in t?t[r]:r in e?e[r]:void 0})}(Nt);function jt(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("shared-AccountAuthorContactPage"),a.createElement(xt,e)}class Rt extends a.Component{static async willRouteTo(e){let{api:t,authStore:r,authorProfileStore:a,authorCorrectionsStore:n}=e;if(n.isModeratorCorrecting()){const e=n.getModeratorCorrectionsAuthorId();if(e)return t.fetchAuthorDetail(e,null,!1)}else{const e=r.getClaimedAuthorId(),n=a.getAuthorProfile();if(!e)return new St.a({routeName:"ACCOUNT_CONTACT",replace:!0,status:302});if(!n)return t.fetchAuthorProfile({authorId:e})}}render(){return a.createElement(jt,null)}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Rt,"getPageTitle",()=>Object(f.b)(e=>e.account.page.authorContact.pageTitle));var Tt=r(137),At=r(163);function It(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function kt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Ft extends a.PureComponent{constructor(){super(...arguments),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?It(Object(r),!0).forEach((function(t){kt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):It(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromAuthStore(),{},this.getStateFromCorrectionsStore()),this.context.authStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthStore())}),this.context.correctionsStore.registerComponent(this,()=>{this.setState(this.getStateFromCorrectionsStore())})}getStateFromAuthStore(){return{viewerClaimedAuthorId:this.context.authStore.getClaimedAuthorId()}}getStateFromCorrectionsStore(){const e=this.context.correctionsStore,{correction:t}=this.props;return{paper:e.getCorrectedPaperById(t.paperHash)}}buildViewerAuthor(){const{correction:{authorId:e}}=this.props,t=this.context.correctionsStore.getAuthorCorrections().findLast(e=>e.fieldNames&&e.fieldNames.includes("authorName"));if(t&&t.fieldCorrections){const r=t.fieldCorrections.find(e=>"authorName"===e.field);if(r&&r.changeValue){const{first:t,middle:a,last:n}=r.changeValue;return Tt.a.fromJs({ids:[e],name:[t,...a,n].join(" ")})}}const r=this.context.authorProfileStore.getAuthorProfile();return r?Tt.a.fromJs({ids:[e],name:r.fullName}):Tt.a.fromJs({ids:[e],name:"You"})}renderAuthor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{correction:r}=this.props,n=e.canonicalId()===this.state.viewerClaimedAuthorId;return a.createElement("li",{key:[r.paperHash,e.canonicalId()].join("|"),className:D()({"corrections-summary__paper-correction__author":!0,"corrections-summary__paper-correction__author__added":t.isAdd,"corrections-summary__paper-correction__author__removed":t.isRemove})},a.createElement("span",{className:"corrections-summary__paper-correction__author__name"},e.name),n&&a.createElement("span",{className:"corrections-summary__paper-correction__author__viewer-claimed-tag"},Object(f.b)(e=>e.correctionSummary.viewerClaimedLabel)))}renderAddAuthorship(e){const{correction:t}=this.props,r=t.position,n=e.slice(0,r),o=e.slice(r);return a.createElement("ul",{className:"corrections-summary__paper-correction__author-list corrections-summary__paper-correction__add-authorship"},n.map(e=>this.renderAuthor(e)),this.renderAuthor(this.buildViewerAuthor(),{isAdd:!0}),o.map(e=>this.renderAuthor(e)))}renderRemoveAuthorship(e){const{correction:t}=this.props,r=t.position,n=e.slice(0,r),o=e.slice(r+1),i=e.get(r);return a.createElement("ul",{className:"corrections-summary__paper-correction__author-list corrections-summary__paper-correction__remove-authorship"},n.map(e=>this.renderAuthor(e)),this.renderAuthor(i,{isRemove:!0}),o.map(e=>this.renderAuthor(e)))}renderSwapAuthorship(e){const{correction:t}=this.props,r=t.position,n=e.slice(0,r),o=e.slice(r+1),i=e.get(r);return a.createElement("ul",{className:"corrections-summary__paper-correction__author-list corrections-summary__paper-correction__swap-authorship"},n.map(e=>this.renderAuthor(e)),this.renderAuthor(i,{isRemove:!0}),this.renderAuthor(this.buildViewerAuthor(),{isAdd:!0}),o.map(e=>this.renderAuthor(e)))}render(){const{correction:e}=this.props,{paper:t}=this.state;if(!t)return null;const r=t.authors.map(e=>e.alias);return a.createElement("div",{className:"corrections-summary__paper-correction"},a.createElement("div",{className:"corrections-summary__paper-correction__title"},a.createElement(Be.a,{to:"PAPER_DETAIL",params:{paperId:t.id,slug:t.slug}},t.title)),(()=>{switch(e.correctionType){case xe.a.AddAuthorship:return this.renderAddAuthorship(r);case xe.a.SwapAuthorship:return this.renderSwapAuthorship(r)}})())}}kt(Ft,"contextTypes",{authStore:K.a.instanceOf(Ne.a).isRequired,authorProfileStore:K.a.instanceOf(U.a).isRequired,correctionsStore:K.a.instanceOf(At.a).isRequired});r(432);const Dt={ChangeNameField:"authorName",ChangeOrcidField:"orcidId",ChangeHomepageField:"homepage",ChangeAffiliationField:"affiliations"},Lt=Object.keys(Dt).reduce((e,t)=>(e[Dt[t]]=t,e),{});var qt=Object.freeze(Dt);Object.freeze(Lt);var Mt=r(37);function Ht(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function zt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Ut=[xe.a.AddAuthorship,xe.a.SwapAuthorship],Vt=[xe.a.RemoveAuthorship];class Bt extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ht(Object(r),!0).forEach((function(t){zt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ht(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({errorMessage:null},this.getStateFromAuthStore(),{},this.getStateFromCorrectionsStore()),this.context.authStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthStore())}),this.context.correctionsStore.registerComponent(this,()=>{this.setState(this.getStateFromCorrectionsStore())})}getStateFromAuthStore(){return{authorId:this.context.authStore.getClaimedAuthorId()}}getStateFromCorrectionsStore(){const e=this.context.correctionsStore;return{isLoading:e.isLoading(),authorCorrectionsStatus:e.getAuthorCorrectionsStatus(),nameFieldCorrections:e.getFieldCorrectionsByName(qt.ChangeNameField),affiliationsFieldCorrections:e.getFieldCorrectionsByName(qt.ChangeAffiliationField),homepageFieldCorrections:e.getFieldCorrectionsByName(qt.ChangeHomepageField),orcidFieldCorrections:e.getFieldCorrectionsByName(qt.ChangeOrcidField),addCorrections:e.getPaperAuthorCorrectionsByTypes(Ut),addCorrectionsStatus:e.getPaperAuthorCorrectionsStatusByTypes(Ut),removeCorrections:e.getPaperAuthorCorrectionsByTypes(Vt),removeCorrectionsStatus:e.getPaperAuthorCorrectionsStatusByTypes(Vt)}}renderNameFieldCorrection(){const{nameFieldCorrections:e}=this.state;if(e.isEmpty())return null;const{previousValue:t}=e.first(),{changeValue:r}=e.last(),n=[t.first,...t.middle,t.last].join(" "),o=[r.first,...r.middle,r.last].join(" ");return a.createElement("li",{key:"name-field",className:"corrections-summary__author-corrections__item"},a.createElement("div",{className:"corrections-summary__author-corrections__item-label"},Object(f.b)(e=>e.correctionSummary.authorCorrections.nameFieldLabel)),a.createElement("div",{className:"corrections-summary__author-corrections__item-change"},a.createElement("div",{className:"corrections-summary__author-corrections__item-change__old-value"},n),a.createElement("div",{className:"corrections-summary__author-corrections__item-change__new-value"},o)))}renderAffiliationsFieldCorrection(){const{affiliationsFieldCorrections:e}=this.state;if(e.isEmpty())return null;const{previousValue:t}=e.first(),{changeValue:r}=e.last(),n=r.filter(e=>!t.includes(e)),o=t.filter(e=>!r.includes(e));return n.length+o.length===0?null:a.createElement("li",{key:"affiliations-field",className:"corrections-summary__author-corrections__item"},a.createElement("div",{className:"corrections-summary__author-corrections__item-label"},Object(f.b)(e=>e.correctionSummary.authorCorrections.affiliationsFieldLabel)),a.createElement("div",{className:"corrections-summary__author-corrections__item-change"},o.map(e=>a.createElement("div",{key:e,className:"corrections-summary__author-corrections__item-change__remove-value"},e)),n.map(e=>a.createElement("div",{key:e,className:"corrections-summary__author-corrections__item-change__add-value"},e))))}renderOrcidFieldCorrection(){var e,t;const{orcidFieldCorrections:r}=this.state;if(r.isEmpty())return null;const n=null!=(t=r.first())&&null!=(t=t.previousValue)?t.id:t,o=null!=(e=r.last())&&null!=(e=e.changeValue)?e.id:e;return a.createElement("li",{key:"orcid-field",className:"corrections-summary__author-corrections__item"},a.createElement("div",{className:"corrections-summary__author-corrections__item-label"},Object(f.b)(e=>e.correctionSummary.authorCorrections.orcidFieldLabel)),a.createElement("div",{className:"corrections-summary__author-corrections__item-change"},n&&a.createElement("div",{className:"corrections-summary__author-corrections__item-change__old-value"},n),o&&a.createElement("div",{className:"corrections-summary__author-corrections__item-change__new-value"},o)))}renderHomepageFieldCorrection(){const{homepageFieldCorrections:e}=this.state;if(e.isEmpty())return null;const t=e.first().previousValue,r=e.last().changeValue;return a.createElement("li",{key:"homepage-field",className:"corrections-summary__author-corrections__item"},a.createElement("div",{className:"corrections-summary__author-corrections__item-label"},Object(f.b)(e=>e.correctionSummary.authorCorrections.homepageFieldLabel)),a.createElement("div",{className:"corrections-summary__author-corrections__item-change"},t&&a.createElement("div",{className:"corrections-summary__author-corrections__item-change__old-value"},t),r&&a.createElement("div",{className:"corrections-summary__author-corrections__item-change__new-value"},r)))}renderAuthorCorrections(){const{authorCorrectionsStatus:e}=this.state,t=[this.renderNameFieldCorrection(),this.renderAffiliationsFieldCorrection(),this.renderOrcidFieldCorrection(),this.renderHomepageFieldCorrection()].filter(e=>!!e);return 0===t.length?null:a.createElement("section",{className:"corrections-summary__section corrections-summary__author-corrections"},a.createElement("h3",{className:"corrections-summary__correction-headline"},a.createElement("span",{className:"corrections-summary__correction-headline__text"},Object(f.b)(e=>e.correctionSummary.authorCorrections.headerText))),a.createElement(Yt,{status:e}),a.createElement("ul",{className:"corrections-summary__author-corrections__list"},t))}renderAddCorrections(){const{addCorrections:e}=this.state;return e.isEmpty()?null:a.createElement("section",{className:"corrections-summary__section corrections-summary__paper-corrections corrections-summary__add-corrections"},a.createElement("h3",{className:"corrections-summary__correction-headline"},a.createElement("span",{className:"corrections-summary__correction-headline__text"},Object(f.a)(e=>e.correctionSummary.addCorrections.headerText,e.size))),a.createElement("ul",{className:"corrections-summary__paper-corrections__list"},e.map(e=>a.createElement("li",{key:"add-"+(e.id||0),className:"corrections-summary__paper-corrections__item"},a.createElement(Yt,{status:e.completionStatus}),a.createElement(Ft,{correction:e})))))}renderRemoveCorrections(){const{removeCorrections:e}=this.state;return e.isEmpty()?null:a.createElement("section",{className:"corrections-summary__section corrections-summary__paper-corrections corrections-summary__remove-corrections"},a.createElement("h3",{className:"corrections-summary__correction-headline"},a.createElement("span",{className:"corrections-summary__correction-headline__text"},Object(f.a)(e=>e.correctionSummary.removeCorrections.headerText,e.size))),a.createElement("ul",{className:"corrections-summary__paper-corrections__list"},e.map(e=>a.createElement("li",{key:"remove-"+(e.id||0),className:"corrections-summary__paper-corrections__item"},a.createElement(Yt,{status:e.completionStatus}),a.createElement(Ft,{correction:e})))))}render(){return a.createElement("div",{className:"corrections-summary"},this.renderAuthorCorrections(),this.renderRemoveCorrections(),this.renderAddCorrections())}}function Yt(e){let{status:t}=e;return t?a.createElement("span",{className:"corrections-summary__correction-headline__status"},a.createElement("span",{className:"corrections-summary__correction-headline__status__label"},Object(f.b)(e=>e.correctionSummary.statusLabel[t])),(()=>{switch(t){default:return null;case Mt.a.Submitted:case Mt.a.Processing:return a.createElement(J.a,{icon:"status-waiting"});case Mt.a.Cancelled:case Mt.a.Failed:return a.createElement(J.a,{icon:"status-warning"});case Mt.a.Succeeded:return a.createElement(J.a,{icon:"status-approved"})}})()):null}function Kt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Wt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}zt(Bt,"contextTypes",{api:K.a.instanceOf(pe.a).isRequired,authStore:K.a.instanceOf(Ne.a).isRequired,correctionsStore:K.a.instanceOf(At.a).isRequired});class Qt extends a.Component{constructor(e,t){super(e,t),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Kt(Object(r),!0).forEach((function(t){Wt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Kt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromAuthStore(),{},this.getStateFromAuthorCorrectionsStore()),this.context.authStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthStore())}),this.context.authorCorrectionsStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorCorrectionsStore())})}getStateFromAuthStore(){return{claimedAuthorId:this.context.authStore.getClaimedAuthorId()}}getStateFromAuthorCorrectionsStore(){const e=this.context.authorCorrectionsStore;return{isModeratorCorrecting:e.isModeratorCorrecting(),moderatorCorrectionsAuthorId:e.getModeratorCorrectionsAuthorId()}}render(){const{claimedAuthorId:e,isModeratorCorrecting:t,moderatorCorrectionsAuthorId:r}=this.state,n=t?r:e;return a.createElement("div",{className:"account-correction-summary"},a.createElement("h2",{className:"account-correction-summary__headline"},Object(f.b)(e=>e.account.page.corrections.pageHeading)),a.createElement(Bt,null),a.createElement(o,null,a.createElement(s,null,!!n&&a.createElement(Be.a,{className:"account-correction-summary__link-button button button--primary",to:"AUTHOR_PROFILE_BY_ID",params:{authorId:n}},Object(f.b)(e=>e.account.page.corrections.authorPageLink)))))}}function Gt(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("shared-AccountCorrectionsStatusPage"),a.createElement(Qt,e)}Wt(Qt,"getPageTitle",()=>Object(f.b)(e=>e.account.page.corrections.pageTitle)),Wt(Qt,"contextTypes",{authStore:K.a.instanceOf(Ne.a).isRequired,authorCorrectionsStore:K.a.instanceOf(z.a).isRequired});class Xt extends a.Component{static async willRouteTo(e){let{api:t,authorCorrectionsStore:r}=e;const a=r.isModeratorCorrecting?r.getModeratorCorrectionsAuthorId():null;if(a)return Promise.all([t.fetchAuthorCorrectionsForAuthor({authorId:a}),t.fetchPaperAuthorCorrectionsForAuthor({authorId:a,includePaperModel:"PaperLite"})])}render(){return a.createElement(Gt,null)}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Xt,"getPageTitle",()=>Object(f.b)(e=>e.account.page.corrections.pageTitle));var Jt=r(740),Zt=r(798),$t=r(227),er=r(16),tr=(r(164),r(229)),rr=r(734);const ar=["productFeaturesSpotlightSubscription","semanticScholarNewsletterSubscription","betaTestGroupSubscription","allenInstituteNewsletterSubscription"];var nr=r(71),or=r(213);function ir(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function sr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ir(Object(r),!0).forEach((function(t){lr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ir(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function lr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class cr extends a.Component{constructor(e,t){super(e,t),lr(this,"generateErrorList",e=>ne.List(e.filter(e=>!!e))),lr(this,"submitUserContactInfo",e=>{const{userContact:t}=this.state,r=t?t.merge(sr({},e)):e;this.setState({userContact:r}),this.context.api.submitUserContactInfo(r)}),lr(this,"onToggle",e=>{const{userId:t,contactEmail:r}=this.state;if(!r)return Object(nr.a)(tr.a.create($t.a.AccountSettings.NO_EMAIL_ERROR,t)),void this.setState({emailError:Object(f.b)(e=>e.account.page.contact.email.noEmailError)});const a={[e]:!this.state[e]};this.submitUserContactInfo(a),Object(nr.a)(rr.a.create($t.a.AccountSettings.CHANGE_SUBSCRIPTION,t)),this.setState(a)}),lr(this,"onUnsubscribeAll",()=>{const{userId:e,contactEmail:t}=this.state;if(!t)return Object(nr.a)(tr.a.create($t.a.AccountSettings.NO_EMAIL_ERROR,e)),void this.setState({emailError:Object(f.b)(e=>e.account.page.contact.email.noEmailError)});const r={};ar.map(e=>r[e]=!1),this.submitUserContactInfo(r),Object(nr.a)(rr.a.create($t.a.AccountSettings.UNSUBSCRIBE_ALL,e)),this.setState(r)}),lr(this,"onClickUpdateEmail",async()=>{const{contactEmail:e,userId:t,_updateEmailInput:r}=this.state;if(!r&&e)return void this.setState({showEmailInput:!1,_updateEmailInput:null});if(r===e)return void this.setState({showEmailInput:!1,emailError:null,_updateEmailInput:null});const a={s2AccountEmail:r};try{this.setState({isEmailUpdating:!0}),await this.submitUserContactInfo(a),Object(nr.a)(rr.a.create($t.a.AccountSettings.CHANGE_CONTACT_EMAIL,t))}catch(e){var n,o;return void("ContactEmailTaken"===(null!=(o=e)?o.errorCode:o)?(Object(nr.a)(tr.a.create($t.a.AccountSettings.CONTACT_EMAIL_CONFLICT,t)),this.setState({isEmailUpdating:!1,emailError:Object(f.b)(e=>e.account.page.contact.email.emailInUseError)})):"ContactInvalidEmail"===(null!=(n=e)?n.errorCode:n)?this.setState({isEmailUpdating:!1,emailError:Object(f.b)(e=>e.account.page.contact.email.invalidEmailError)}):(w.a.error(e),this.setState({isEmailUpdating:!1,emailError:Object(f.b)(e=>e.account.page.contact.email.invalidEmailError)})))}this.setState({showEmailInput:!1,contactEmail:r,emailError:null,isEmailUpdating:!1,_updateEmailInput:null})}),lr(this,"onCancelEmail",()=>{this.setState({showEmailInput:!1,updatedEmail:null,emailError:null,_updateEmailInput:null})}),lr(this,"onUpdateEmail",e=>{this.setState({_updateEmailInput:e})}),lr(this,"displayEmailInput",()=>{this.setState({showEmailInput:!0,_updateEmailInput:this.state.contactEmail})}),this.state=sr({updatedEmail:null,showEmailInput:!1,emailError:null,isEmailUpdating:!1,_updateEmailInput:null},this.getStateFromUserContactStore(),{},this.getStateFromAuthStore()),this.context.authStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthStore)}),this.context.userContactStore.registerComponent(this,()=>{this.setState(this.getStateFromUserContactStore())})}getStateFromAuthStore(){const e=this.context.authStore.getUser();return{userId:e?e.id:null}}getStateFromUserContactStore(){var e,t,r,a,n;const o=this.context.userContactStore.getUserContact();return{userContact:o,contactEmail:(null!=(n=o)?n.s2AccountEmail:n)||"",betaTestGroupSubscription:null!=(a=o)?a.betaTestGroupSubscription:a,productFeaturesSpotlightSubscription:null!=(r=o)?r.productFeaturesSpotlightSubscription:r,semanticScholarNewsletterSubscription:null!=(t=o)?t.semanticScholarNewsletterSubscription:t,allenInstituteNewsletterSubscription:null!=(e=o)?e.allenInstituteNewsletterSubscription:e}}renderSubscriptionToggle(e){var t;const r=!!(null!=(t=this.state)?t[e]:t),n=D()("email-subscription",{"is-disabled":!r});return a.createElement("ul",null,a.createElement("li",{className:n},a.createElement("div",{className:"account-contact__subscriptions__toggle"},a.createElement(Zt.a,{className:"subscription__toggle",selected:r,onClick:()=>this.onToggle(e)}),a.createElement("div",{className:"account-contact__subscription__label flex-static"},Object(f.b)(t=>t.account.page.contact.subscriptionType[e].label))),a.createElement("div",{className:"account-contact__subscription__description"},Object(f.b)(t=>t.account.page.contact.subscriptionType[e].description))))}renderEmailChange(){const{contactEmail:e,emailError:t,isEmailUpdating:r,_updateEmailInput:n}=this.state;return a.createElement("div",{className:"account-contact__update-email__change"},a.createElement("h2",{className:"account-contact__subscriptions__headline"},Object(f.b)(e=>e.account.page.contact.email.label)),a.createElement("div",{className:"account-contact__update-email__headline__buttons"},a.createElement("div",{className:"account-contact__update-email__input"},a.createElement(Jt.a,{className:"standard-form account-contact__update-email__input-box",value:n,onChange:this.onUpdateEmail,errors:this.generateErrorList([t]),isRequired:!0,placeholder:e})),a.createElement("div",{className:"account-contact__update-email__change-buttons"},a.createElement("button",{className:"button button--secondary account-contact__update-email__update-button",onClick:this.onClickUpdateEmail,disabled:r},a.createElement("div",{className:"flex-row-centered"},a.createElement("span",{className:"icon-button-text"},Object(f.b)(e=>e.account.page.contact.email.updateLabel)))),a.createElement("button",{className:"button button--secondary account-contact__update-email__cancel-button",onClick:this.onCancelEmail},a.createElement("div",{className:"flex-row-centered"},a.createElement("span",{className:"icon-button-text"},Object(f.b)(e=>e.account.page.contact.email.cancelLabel)))))))}renderEmailNoChange(){const{contactEmail:e,emailError:t}=this.state;return a.createElement("div",{className:"account-contact__update-email__no-change"},a.createElement("h2",{className:"account-contact__subscriptions__headline"},Object(f.b)(e=>e.account.page.contact.email.label)),a.createElement("div",{className:"account-contact__update-email__headline__buttons"},a.createElement("span",{className:"account-contact__update-email__email"},e||""),a.createElement("span",{className:"account-contact__update-email__no-email-error"},t&&t),a.createElement(ue.c,{feature:er.b.LockedContactEmails},a.createElement(ue.a,null,a.createElement("button",{className:"button button--secondary account-contact__update-email__button",onClick:this.displayEmailInput},a.createElement("div",{className:"flex-row-centered"},a.createElement("span",{className:"icon-button-text"},Object(f.b)(e=>e.account.page.contact.email.buttonLabel))))))))}render(){const{showEmailInput:e}=this.state;return a.createElement("div",{className:"account-contact"},a.createElement("div",{className:"account-settings-nav-label"},Object(f.b)(e=>e.account.section.general.navLabel)),a.createElement("h2",{className:"account-contact__headline"},Object(f.b)(e=>e.account.page.contact.pageHeading)),a.createElement("hr",{className:"account__divider"}),a.createElement("div",{className:"account-contact__email-section"},e?this.renderEmailChange():this.renderEmailNoChange()),a.createElement("hr",{className:"account__divider"}),a.createElement("div",{className:"account-contact__subscriptions"},a.createElement("h2",{className:"account-contact__subscriptions__headline"},Object(f.b)(e=>e.account.page.contact.subscriptionLabel)),a.createElement("div",{className:"account-contact__subscriptions__list"},ar.map(e=>a.createElement("div",{className:"account-contact__subscription",key:e},this.renderSubscriptionToggle(e))))),a.createElement("hr",{className:"account__divider"}),a.createElement("div",{className:"account-contact__subscriptions__unsubscribe"},a.createElement("h2",{className:"account-contact__subscriptions__headline"},Object(f.b)(e=>e.account.page.contact.unsubscribe.label)),a.createElement("button",{className:"button button--secondary account-contact__unsubscribe-button",onClick:this.onUnsubscribeAll},a.createElement("div",{className:"flex-row-centered"},a.createElement("span",{className:"icon-button-text"},Object(f.b)(e=>e.account.page.contact.unsubscribe.buttonLabel))))),a.createElement("div",{className:"account-contact__subscriptions__description"},a.createElement(p.a,{content:Object(f.b)(e=>e.account.page.contact.unsubscribe.description)})))}}function ur(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("shared-AccountContactPage"),a.createElement(cr,e)}lr(cr,"contextTypes",{api:K.a.instanceOf(pe.a).isRequired,authStore:K.a.instanceOf(Ne.a).isRequired,userContactStore:K.a.instanceOf(or.a).isRequired});class dr extends a.Component{static async willRouteTo(e){let{userContactStore:t,api:r}=e;return t.isUninitialized()?r.getUserContact().catch(e=>{var t;if("contactMissing"!==(null!=(t=e)?t.errorCode:t))throw e;w.a.info("No contact associated yet")}):Promise.resolve()}render(){return a.createElement(ur,null)}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(dr,"getPageTitle",()=>Object(f.b)(e=>e.account.page.contact.pageTitle));var hr=r(881),mr=r(824),pr=r(112);function br(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function gr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class fr extends a.Component{constructor(){super(...arguments),gr(this,"onChangeFieldsOfStudy",e=>{this.setState({fieldsOfStudy:e})}),gr(this,"generateErrorList",e=>ne.List(e.filter(e=>!!e))),gr(this,"onSubmitForm",async()=>{if(this._onSubmitFormPromise)throw new Error("Already sending form");const e=this.onSubmitFormImpl();this._onSubmitFormPromise=e;try{await e}catch(e){w.a.error(e)}finally{this._onSubmitFormPromise=null}}),gr(this,"renderInput",e=>{let{label:t,isRequired:r,value:n,onChange:o,errors:i,placeholder:s}=e;return a.createElement(Jt.a,{label:t,className:"standard-form",isRequired:r,value:n||"",onChange:o,errors:this.generateErrorList([...i]),placeholder:s})}),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?br(Object(r),!0).forEach((function(t){gr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):br(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromUserContactStore(),{},this.getStateFromAuthStore()),this.context.userContactStore.registerComponent(this,()=>{this.setState(this.getStateFromUserContactStore())}),this.onChangefirstName=this.onChangeInput.bind(this,"firstName"),this.onChangelastName=this.onChangeInput.bind(this,"lastName"),this.onChangeCurrentRole=this.onChangeInput.bind(this,"currentOccupation"),this.onChangeWebsiteUrl=this.onChangeInput.bind(this,"websiteUrl")}getStateFromAuthStore(){const e=this.context.authStore.getUser();return{userId:e?e.id:null}}getStateFromUserContactStore(){var e,t,r,a,n;const{userContactStore:o}=this.context,i=o.getUserContact();return{userContact:i,firstName:null!=(n=i)?n.firstName:n,lastName:null!=(a=i)?a.lastName:a,websiteUrl:null!=(r=i)?r.websiteUrl:r,currentOccupation:null!=(t=i)?t.currentOccupation:t,fieldsOfStudy:(null!=(e=i)?e.fieldsOfStudy:e)||[],firstNameError:null,lastNameError:null}}onChangeInput(e,t){const r=t.currentTarget?t.currentTarget.value:t;this.setState({["".concat(e,"Error")]:null,["".concat(e)]:r})}async onSubmitFormImpl(){const{userId:e,firstName:t,lastName:r,websiteUrl:a,currentOccupation:n,fieldsOfStudy:o,userContact:i}=this.state;try{const s=i?i.merge({firstName:t,lastName:r,websiteUrl:a,currentOccupation:n,fieldsOfStudy:o}):{firstName:t,lastName:r,websiteUrl:a,currentOccupation:n,fieldsOfStudy:o};this.setState({userContact:s}),await this.context.api.submitUserContactInfo(s),Object(nr.a)(rr.a.create($t.a.ManageAccount.MANAGE_ACCOUNT_SUBMIT,e))}catch(e){w.a.error(e)}}render(){const{lastName:e,firstName:t,websiteUrl:r,fieldsOfStudy:n,currentOccupation:o}=this.state,i=Object(f.b)(e=>e.demographicForm.firstNameLabel),s=Object(f.b)(e=>e.demographicForm.lastNameLabel),l=Object(f.b)(e=>e.demographicForm.websiteUrlLabel),c=Object(f.b)(e=>e.demographicForm.fieldsOfStudyLabel);return a.createElement("div",{className:"account-manage"},a.createElement("div",{className:"account-settings-nav-label"},Object(f.b)(e=>e.account.section.general.navLabel)),a.createElement("h2",{className:"account-manage__headline"},Object(f.b)(e=>e.account.page.manageAccount.pageHeading)),a.createElement("hr",{className:"account-manage__rule"}),a.createElement("form",{onSubmit:this.onSubmitForm},a.createElement("div",{className:"flex-row"},a.createElement("div",{className:"account-manage__name-input account-manage__first-name"},this.renderInput({label:i,isRequired:!0,value:t,onChange:this.onChangefirstName,errors:[],placeholder:"First Name"})),a.createElement("div",{className:"account-manage__name-input account-manage__last-name"},this.renderInput({label:s,isRequired:!0,value:e,onChange:this.onChangelastName,errors:[],placeholder:"Last Name"}))),a.createElement("hr",{className:"account-manage__rule"}),this.renderInput({label:l,value:r,onChange:this.onChangeWebsiteUrl,errors:[]}),a.createElement(mr.a,{currentOccupation:o,onChangeCurrentRole:this.onChangeCurrentRole}),a.createElement(hr.a,{isRequired:!1,options:pr.a.selectors().map(e=>e.name),selected:n,label:c,onChange:this.onChangeFieldsOfStudy})),a.createElement("button",{className:"button button--primary account-manage__submit-button",onClick:this.onSubmitForm},Object(f.b)(e=>e.account.page.manageAccount.submitButtonLabel)))}}function _r(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("shared-AccountManagePage"),a.createElement(fr,e)}gr(fr,"contextTypes",{api:K.a.instanceOf(pe.a).isRequired,authStore:K.a.instanceOf(Ne.a).isRequired,userContactStore:K.a.instanceOf(or.a).isRequired});class yr extends a.Component{static async willRouteTo(e){let{userContactStore:t,api:r}=e;return t.isUninitialized()?r.getUserContact().catch(e=>{var t;if("contactMissing"!==(null!=(t=e)?t.errorCode:t))throw e;w.a.info("No contact associated yet")}):Promise.resolve()}render(){return a.createElement(_r,null)}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(yr,"getPageTitle",()=>Object(f.b)(e=>e.account.page.addPapers.pageTitle));class Er extends a.PureComponent{render(){const{activeRouteName:e,navSections:t}=this.props;return a.createElement("nav",{className:"nav-bar"},t.map(t=>a.createElement("section",{key:t.label,className:"nav-bar__section"},a.createElement("div",{className:"nav-bar__section__label"},t.label),a.createElement("ul",{className:"nav-bar__section__links"},t.links.map(t=>a.createElement("li",{key:t.label,className:D()({"nav-bar__link":!0,"nav-bar__is-active":t.routeName===e})},a.createElement(Be.a,{to:t.routeName},a.createElement("div",{className:"nav-bar__link__label"},t.label))))))))}}var Or=r(997),Sr=r(722),vr=r(72),Cr=r(105),wr=r(111);function Pr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Nr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class xr extends a.Component{constructor(e,t){super(e,t),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Pr(Object(r),!0).forEach((function(t){Nr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromCorrectionsStore(),{},this.getStateFromWeblabStore(),{},this.getStateFromAuthStore()),this.context.correctionsStore.registerComponent(this,()=>{this.setState(this.getStateFromCorrectionsStore())}),this.context.weblabStore.registerComponent(this,()=>{this.setState(this.getStateFromWeblabStore())}),this.context.authStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthStore())})}getStateFromCorrectionsStore(){return{hasPendingCorrections:this.context.correctionsStore.hasCorrections()}}getStateFromWeblabStore(){const e=this.context.weblabStore;return{isAccountContactSectionEnabled:e.isFeatureEnabled(er.b.AccountContactSection),isContactEmailLocked:e.isFeatureEnabled(er.b.LockedContactEmails)}}getStateFromAuthStore(){var e;const t=this.context.authStore;return{claimedAuthorId:t.getClaimedAuthorId(),claimStatus:t.getAuthorClaimModerationStatus(),s2AccountEmail:null!=(e=t.getUser())?e.email:e}}getNavSections(){const{claimStatus:e,claimedAuthorId:t,hasPendingCorrections:r,isAccountContactSectionEnabled:a,isContactEmailLocked:n,s2AccountEmail:o}=this.state,i=[],s={routeName:"ACCOUNT_CORRECTIONS",label:Object(f.b)(e=>e.account.page.corrections.navLabel)};if(a&&n&&!o?i.push({label:Object(f.b)(e=>e.account.section.general.navLabel),links:[{routeName:"ACCOUNT_MANAGE",label:Object(f.b)(e=>e.account.page.manageAccount.navLabel)},{routeName:"ACCOUNT_ALERTS",label:Object(f.b)(e=>e.account.page.alerts.navLabel)}]}):a&&i.push({label:Object(f.b)(e=>e.account.section.general.navLabel),links:[{routeName:"ACCOUNT_MANAGE",label:Object(f.b)(e=>e.account.page.manageAccount.navLabel)},{routeName:"ACCOUNT_CONTACT",label:Object(f.b)(e=>e.account.page.contact.navLabel)},{routeName:"ACCOUNT_ALERTS",label:Object(f.b)(e=>e.account.page.alerts.navLabel)}]}),t)switch(e){case vr.b.Approved:{const e={label:Object(f.b)(e=>e.account.section.authorPage.navLabel),links:[{routeName:"ACCOUNT_AUTHOR_CONTACT",label:Object(f.b)(e=>e.account.page.authorContact.navLabel)},{routeName:"ACCOUNT_REMOVE_PAPERS",label:Object(f.b)(e=>e.account.page.removePapers.navLabel)},{routeName:"ACCOUNT_ADD_PAPERS",label:Object(f.b)(e=>e.account.page.addPapers.navLabel)}]};r&&e.links.push(s),i.push(e);break}case vr.b.Pending:case vr.b.PendingEmailVerification:i.push({label:Object(f.b)(e=>e.account.section.authorPage.navLabel),links:[{routeName:"ACCOUNT_AUTHOR_CLAIM_PENDING",label:Object(f.b)(e=>e.account.page.authorClaimPending.navLabel)}]})}return i}getActiveRouteName(){var e;const t=this.context.history,{route:r}=this.props,a=null!=(e=Object(wr.a)(r.routes,t.location.pathname))&&null!=(e=e[0])&&null!=(e=e.route)?e.path:e;return Object(ge.c)(a)||"ACCOUNT"}render(){const e=this.getActiveRouteName(),t=this.getNavSections();return a.createElement(Sr.a,{className:"account"},a.createElement(Or.e,{className:"account__layout",useDefaultBreakpoints:!1},a.createElement(Or.d,null,a.createElement("div",{className:"account__nav"},a.createElement(Er,{activeRouteName:e,navSections:t}))),a.createElement(Or.c,null,a.createElement("div",{className:"account__main"},Object(wr.b)(this.props.route.routes)))))}}function jr(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("shared-AccountPage"),a.createElement(xr,e)}function Rr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Nr(xr,"contextTypes",{api:K.a.instanceOf(pe.a).isRequired,authStore:K.a.instanceOf(Ne.a).isRequired,correctionsStore:K.a.instanceOf(At.a).isRequired,history:K.a.instanceOf(je.a).isRequired,weblabStore:K.a.instanceOf(Cr.b).isRequired});class Tr extends a.Component{static async willRouteTo(e,t){let{api:r,authStore:a,weblabStore:n}=e;if(t.path===ge.b.ACCOUNT){const e=function(e,t){if(t.isFeatureEnabled(er.b.AccountContactSection))return"ACCOUNT_MANAGE";switch(e.getAuthorClaimModerationStatus()){case vr.b.Pending:case vr.b.PendingEmailVerification:return"ACCOUNT_AUTHOR_CLAIM_PENDING";case vr.b.Approved:return"ACCOUNT_AUTHOR_CONTACT"}return"HOME"}(a,n);return new St.a({routeName:e,replace:!0,status:302})}const o=[],i=a.getClaimedAuthorId();i&&o.push(r.fetchAuthorProfile({authorId:i}),r.fetchAuthorCorrectionsForAuthor({authorId:i}),r.fetchPaperAuthorCorrectionsForAuthor({authorId:i,includePaperModel:"PaperLite"}))}render(){return a.createElement(jr,this.props)}}Rr(Tr,"requiresAuthentication",()=>!0),Rr(Tr,"getPageTitle",()=>Object(f.b)(e=>e.account.fallbackPageTitle));function Ar(){return(Ar=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}class Ir extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(this,"onInputFilter",e=>{const{value:t}=e.currentTarget;this.setState({filterText:t}),this.props.onChange(t)}),this.state={filterText:""}}render(){const{filterText:e}=this.state;return a.createElement("div",{className:"author-remove-papers__filter"},a.createElement("input",Ar({id:"remove-filter-input",className:"legacy__input author-remove-papers__filter__input",type:"text",value:e,placeholder:Object(f.b)(e=>e.authorRemovePapers.filterLabel)},Object(y.a)({id:"author_remove_paper_filter"}),{onChange:this.onInputFilter})),a.createElement(J.a,{icon:"filter"}))}}function kr(){if(!Object(De.a)())return;const e=window.document.getElementById("remove-filter-input");e&&(e.value="",e.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0})),e.focus())}class Fr extends a.PureComponent{getClearFilterButton(){return a.createElement("div",{className:"author-remove-papers__blank-state__clear-filter"},a.createElement("button",{className:"author-remove-papers__blank-state__clear-filter-button button button--secondary",onClick:kr},Object(f.b)(e=>e.authorRemovePapers.clearFilter)))}render(){const{hasAuthorPapers:e,filterText:t}=this.props,r=e?Object(f.b)(e=>e.authorRemovePapers.blankFilterLabel,t):Object(f.b)(e=>e.authorRemovePapers.blankPaperLabel);return a.createElement("div",{className:"author-remove-papers__blank-state"},a.createElement("div",{className:"author-remove-papers__blank-state__content"},a.createElement(J.a,{className:"author-remove-papers__blank-state__icon",icon:"paper-question-mark",width:"60",height:"77.5"}),a.createElement("div",{className:"author-remove-papers__blank-state__description"},r),e&&this.getClearFilterButton()))}}function Dr(){return(Dr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Lr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function qr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Mr extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),qr(this,"onClickRemove",e=>{e.preventDefault();const{authorCorrectionsStore:t}=this.context,{paperLite:r,viewerAuthorId:a}=this.props;t.enqueueRemovePaperCorrection({paperId:r.id,position:Hr(a,r)})}),qr(this,"onClickUndo",e=>{e.preventDefault();const{authorCorrectionsStore:t}=this.context,{paperLite:r}=this.props;t.cancelPendingCorrectionByPaperId(r.id)}),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Lr(Object(r),!0).forEach((function(t){qr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromAuthorCorrectionsStore()),this.context.authorCorrectionsStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorCorrectionsStore())})}getStateFromAuthorCorrectionsStore(){const{authorCorrectionsStore:e}=this.context,{paperLite:t}=this.props;return{hasPendingRemove:e.getPendingCorrectionTypeForPaperId(t.id)===xe.a.RemoveAuthorship}}render(){const{paperLite:e,viewerAuthorId:t}=this.props,{hasPendingRemove:r}=this.state,n=function(e){let{venue:t,year:r}=e;if(t&&r)return Object(f.b)(e=>e.authorRemovePapers.publisher.bothYearAndVenue,r,t);if(r)return Object(f.b)(e=>e.authorRemovePapers.publisher.onlyYear,r);if(t)return Object(f.b)(e=>e.authorRemovePapers.publisher.onlyVenue,t);return null}({year:e.year,venue:e.venue}),o=function(e,t){return"number"==typeof Hr(e,t)}(t,e);return a.createElement("div",{className:D()({"author-remove-papers__paper":!0,"author-remove-papers__paper__has-pending-remove":r,"author-remove-papers__paper__locked":!o})},!o&&a.createElement("div",{className:"author-remove-papers__paper__status-message"},Object(f.b)(e=>e.authorRemovePapers.error.correctionPending)),a.createElement("div",{className:"author-remove-papers__paper__controls-left"},a.createElement("div",Dr({role:"button",className:"author-remove-papers__paper__remove-button"},Object(y.a)({id:"author_remove_paper_remove"}),{onClick:o?this.onClickRemove:null}),a.createElement(J.a,{icon:"circle-plus"}))),a.createElement("div",{className:"author-remove-papers__paper__details"},a.createElement("div",{className:"author-remove-papers__paper__title"},e.title),a.createElement("div",{className:"author-remove-papers__paper__authors"},e.authors.map(e=>e.alias.name).join(", ")),n&&a.createElement("div",{className:"author-remove-papers__paper__publisher"},n)),a.createElement("div",{className:"author-remove-papers__paper__controls-right"},a.createElement("div",Dr({role:"button",className:"author-remove-papers__paper__undo-button"},Object(y.a)({id:"author_remove_paper_undo"}),{onClick:this.onClickUndo}),Object(f.b)(e=>e.authorRemovePapers.undoLabel))))}}function Hr(e,t){const r=e.toString(),a=t.authors.findIndex(e=>e.alias.ids.includes(r));return a>=0?a:null}function zr(e){let{numPapers:t,onRemoveAll:r}=e;return a.createElement("div",{className:"author-remove-papers__results-header"},a.createElement("div",{className:"author-remove-papers__results-header__left"},Object(f.a)(e=>e.authorRemovePapers.numResults,t)),a.createElement("div",{className:"author-remove-papers__results-header__right"},a.createElement("button",{className:"author-remove-papers__results-header__link-button",onClick:r,disabled:0===t,type:"button"},Object(f.b)(e=>e.authorRemovePapers.removeAllLabel))))}function Ur(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}qr(Mr,"contextTypes",{authorCorrectionsStore:K.a.instanceOf(z.a).isRequired});class Vr extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),Ur(this,"onRemoveAll",()=>{const{authorId:e}=this.props,{authorPapers:t,filteredPaperIds:r}=this.state,a=this.context.authorCorrectionsStore;(r?t.filter(e=>r.has(e.id)):t).forEach(t=>{const r=t.authors.findIndex(t=>t.alias.ids.includes(e.toString()));B()(r>=0,"viewing author is not in paper's list of authors"),a.enqueueRemovePaperCorrection({paperId:t.id,position:r})})}),this.state={isLoading:!1,isInitialLoad:!0,errorMessage:null,authorPapers:ne.List(),filteredPaperIds:null,filterText:""},this.onChangeFilterThrottled=Object(he.a)(this.onChangeFilter.bind(this),1e3,{leading:!0,trailing:!0})}componentDidMount(){this.fetchAuthorPapers().catch(e=>this.onApiError(e))}onApiError(e){w.a.error("Api Error",e),this.setState({errorMessage:Object(f.b)(e=>e.authorRemovePapers.error.apiQueryFailed),isLoading:!1,isInitialLoad:!1})}onChangeFilter(e){this.setState({filterText:e},()=>{this.filterAuthorPapers().catch(e=>this.onApiError(e))})}async fetchAuthorPapers(){var e,t;await Object(me.d)(this,{isLoading:!0});const{authorId:r}=this.props,{api:a}=this.context,n=await a.fetchPapersWithCorrectionsAppliedForAuthor({authorId:r,model:"PaperLite"});await Object(me.d)(this,{isLoading:!1,isInitialLoad:!1});const o=null!=(t=n)&&null!=(t=t.resultData)?t.authorId:t;B()(r===o,"browser and server author IDs do not match");const i=ne.List((null!=(e=n)&&null!=(e=e.resultData)?e.paperLites:e)||[]).map(we.a.fromJs);await Object(me.d)(this,{authorPapers:i})}async filterAuthorPapers(){var e,t;const{filterText:r}=this.state;if(!r)return Object(me.d)(this,{filteredPaperIds:null});const{authorId:a}=this.props,{api:n}=this.context;await Object(me.d)(this,{isLoading:!0,isInitialLoad:!0});const o=await n.fetchPapersWithCorrectionsAppliedForAuthor({authorId:a,model:"PaperId",filterText:r});await Object(me.d)(this,{isLoading:!1,isInitialLoad:!1});const i=null!=(t=o)&&null!=(t=t.resultData)?t.authorId:t;if(B()(a===i,"browser and server author IDs do not match"),r!==this.state.filterText)return void w.a.info("Dropping old filter data",{queryFilterText:r,currentFilterText:this.state.filterText});const s=ne.Set(((null!=(e=o)&&null!=(e=e.resultData)?e.paperIds:e)||[]).map(e=>e.id));await Object(me.d)(this,{filteredPaperIds:s})}render(){const{authorId:e}=this.props,{isLoading:t,isInitialLoad:r,authorPapers:n,filteredPaperIds:o,filterText:i}=this.state,s=o?n.filter(e=>o.has(e.id)):n;return a.createElement("div",{className:D()({"author-remove-papers":!0,"author-remove-papers__is-empty":n.isEmpty(),"author-remove-papers__is-loading":t})},a.createElement("div",{className:"author-remove-papers__controls"},a.createElement(zr,{numPapers:s.size,onRemoveAll:this.onRemoveAll}),a.createElement(Ir,{onChange:this.onChangeFilterThrottled})),s.isEmpty()&&!r&&a.createElement(Fr,{hasAuthorPapers:!n.isEmpty(),filterText:i}),a.createElement("div",{className:D()({"author-remove-papers__papers":!0,"author-remove-papers__papers-loading":t})},t&&a.createElement(Ce.a,null),!t&&s.map(t=>a.createElement(Mr,{key:t.id,paperLite:t,viewerAuthorId:e}))))}}function Br(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Yr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Ur(Vr,"contextTypes",{api:K.a.instanceOf(pe.a).isRequired,authorCorrectionsStore:K.a.instanceOf(z.a).isRequired});class Kr extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),Yr(this,"handleReset",()=>{this.context.authorCorrectionsStore.clearPendingCorrections(xe.a.RemoveAuthorship)}),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Br(Object(r),!0).forEach((function(t){Yr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Br(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromAuthorCorrectionsStore(),{},this.getStateFromAuthorStore()),this.context.authorCorrectionsStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorCorrectionsStore())}),this.context.authorStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorStore())})}getStateFromAuthorCorrectionsStore(){const e=this.context.authorCorrectionsStore;return{stagedPapersCount:e.getPendingCorrections().filter(e=>e.correctionType===xe.a.RemoveAuthorship).size,isModeratorCorrecting:e.isModeratorCorrecting()}}getStateFromAuthorStore(){var e;const{authorStore:t}=this.context;return{authorName:null!=(e=t)&&null!=(e=e.author)?e.name:e}}render(){const{stagedPapersCount:e,isModeratorCorrecting:t,authorName:r}=this.state;if(!e)return null;const n=t?Object(f.a)(e=>e.moderatorCorrections.removePapers.status,e,r):Object(f.a)(e=>e.authorRemovePapers.stagedRemoveCorrections,e);return a.createElement("div",{className:"author-remove-papers-papers-count"},a.createElement(p.a,{content:n}),a.createElement("span",{className:"middot"},""),a.createElement("button",{className:"author-remove-papers-papers-count__link-button",onClick:this.handleReset},Object(f.b)(e=>e.authorRemovePapers.resetStagedLabel)))}}function Wr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Qr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Yr(Kr,"contextTypes",{authorCorrectionsStore:K.a.instanceOf(z.a).isRequired,authorStore:K.a.instanceOf(H.a).isRequired});class Gr extends a.Component{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),Qr(this,"onSubmitForm",e=>{e.preventDefault(),this.attemptSubmit()}),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Wr(Object(r),!0).forEach((function(t){Qr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Wr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({isSending:!1,errorMessage:null,successMessage:null},this.getStateFromAuthStore(),{},this.getStateFromAuthorCorrectionsStore(),{},this.getStateFromAuthorStore()),this.context.authStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthStore())}),this.context.authorCorrectionsStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorCorrectionsStore())}),this.context.authorStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorStore())}),this.state.authorId=this.state.isModeratorCorrecting?this.state.moderatorCorrectionsAuthorId:this.state.authorId}getStateFromAuthStore(){const{authStore:e}=this.context;return{authorId:e.getClaimedAuthorId()}}getStateFromAuthorCorrectionsStore(){const e=this.context.authorCorrectionsStore;return{isFormDirty:e.hasPendingCorrections()||e.hasDraftPapers(),pendingCorrections:e.getPendingCorrections().filter(e=>e.correctionType===xe.a.RemoveAuthorship),isModeratorCorrecting:e.isModeratorCorrecting(),moderatorCorrectionsAuthorId:e.getModeratorCorrectionsAuthorId()}}getStateFromAuthorStore(){var e;const{authorStore:t}=this.context;return{authorName:null!=(e=t)&&null!=(e=e.author)?e.name:e}}async attemptSubmit(){const{authorId:e,pendingCorrections:t,isModeratorCorrecting:r}=this.state,{api:a,authorCorrectionsStore:n}=this.context;await Object(me.d)(this,{isSending:!0,errorMessage:null,successMessage:null});try{await a.submitPaperAuthorCorrections({authorId:e,corrections:t.toJS()}),await n.clearPendingCorrections();const o=this.context.history,i=r?"AUTHOR_CORRECTIONS_TOOL_STATUS":"ACCOUNT_CORRECTIONS";o.push(Object(ge.d)({routeName:i}))}catch(e){w.a.error("Failed to submit paper changes",e),this.setState({isSending:!1,errorMessage:Object(f.b)(e=>e.authorRemovePapers.error.apiSubmitFailed),successMessage:null})}}renderMessage(){const{errorMessage:e,successMessage:t}=this.state;return e?a.createElement("div",{className:"account__error-msg"},e):t?a.createElement("div",{className:"account__success-msg"},t):null}render(){const{authorId:e,isSending:t,isFormDirty:r,isModeratorCorrecting:n,authorName:c}=this.state,u=n?Object(f.b)(e=>e.moderatorCorrections.removePapers.pageHeading,c):Object(f.b)(e=>e.account.page.removePapers.pageHeading),d=n?Object(f.b)(e=>e.moderatorCorrections.removePapers.pageDescription):Object(f.b)(e=>e.account.page.removePapers.pageDescription);return a.createElement("div",{className:"account-remove-papers"},a.createElement("div",{className:"account-remove-papers__headline"},u),a.createElement("div",{className:"account-remove-papers__description"},a.createElement(p.a,{content:d})),a.createElement("hr",{className:"account__divider"}),e&&a.createElement(Vr,{key:e,authorId:e}),a.createElement(o,null,a.createElement(i,null,a.createElement(Kr,null)),a.createElement(l,null,this.renderMessage()),a.createElement(s,null,t&&a.createElement(J.a,{className:"account__loading",icon:"gear"}),a.createElement("button",{className:"account-remove-papers__submit-button button button--primary",onClick:this.onSubmitForm},Object(f.b)(e=>e.account.button.submit)))),a.createElement(Fe,{when:r,message:Object(f.b)(e=>e.authorRemovePapers.error.dirtyForm)}))}}function Xr(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("shared-AccountRemovePapersPage"),a.createElement(Gr,e)}Qr(Gr,"contextTypes",{api:K.a.instanceOf(pe.a).isRequired,authStore:K.a.instanceOf(Ne.a).isRequired,authorCorrectionsStore:K.a.instanceOf(z.a).isRequired,authorStore:K.a.instanceOf(H.a).isRequired,history:K.a.instanceOf(je.a).isRequired});class Jr extends a.Component{render(){return a.createElement(Xr,null)}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Jr,"getPageTitle",()=>Object(f.b)(e=>e.account.page.removePapers.pageTitle));var Zr=r(893);class $r extends a.PureComponent{render(){const{navItems:e,activeRouteName:t}=this.props;return a.createElement("nav",{className:"admin-nav"},a.createElement("ul",{className:"admin-nav__list"},e.map((e,r)=>{let{routeName:n,label:o}=e;const i=n===t;return a.createElement("li",{key:r,className:D()({"admin-nav__item":!0,"admin-nav__is-active":i})},a.createElement(Be.a,{to:n},o))})))}}var ea=r(754);function ta(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function ra(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class aa extends a.Component{componentDidMount(){const e=this.context.history;if("ADMIN"===Object(ge.c)(e.location.pathname)){const t=new St.a(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ta(Object(r),!0).forEach((function(t){ra(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ta(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.pickRedirectRoute(),{replace:!0,status:302}));Object(Ot.a)({redirect:t,history:e})}}pickRedirectRoute(){return{routeName:"ADMIN_EXPERIMENTS"}}getActiveRouteName(){var e;const t=this.context.history,{route:r}=this.props,a=null!=(e=Object(wr.a)(r.routes,t.location.pathname))&&null!=(e=e[0])&&null!=(e=e.route)?e.path:e;return Object(ge.c)(a)||"ADMIN_EXPERIMENTS"}getNavItems(){return[{routeName:"ADMIN_EXPERIMENTS",label:Object(f.b)(e=>e.admin.nav.experimentsLabel)},{routeName:"ADMIN_FEATURE_FLAGS",label:Object(f.b)(e=>e.admin.nav.featureFlagsLabel)}]}render(){const{route:e}=this.props,t=this.getNavItems(),r=this.getActiveRouteName();return a.createElement(Sr.a,{header:a.createElement(ea.a,{isAdminPage:!0})},a.createElement("div",{className:"admin",role:"main"},a.createElement("h2",{className:"admin__header"},Object(f.b)(e=>e.admin.headerLabel)),a.createElement($r,{navItems:t,activeRouteName:r}),a.createElement("div",{className:"admin__sub-page"},Object(wr.b)(e.routes))))}}function na(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-AdminPage"),a.createElement(aa,e)}function oa(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}ra(aa,"contextTypes",{history:K.a.instanceOf(je.a).isRequired});class ia extends a.Component{render(){return a.createElement(na,this.props)}}function sa(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}oa(ia,"getPageTitle",()=>Object(f.b)(e=>e.moderation.pageTitle)),oa(ia,"requiresAuthentication",()=>!0);class la extends a.PureComponent{constructor(){super(...arguments),sa(this,"onChangePercentage",e=>{const{onChange:t,name:r}=this.props;if(t){t(r,parseFloat(e.currentTarget.value)/100)}}),sa(this,"onChangeValue",e=>{const{onChange:t,name:r}=this.props;if(t){t(r,parseFloat(e.currentTarget.value))}})}render(){const{min:e,max:t,step:r,value:n,name:o,showPercentage:i,showValue:s,isDisabled:l}=this.props;return a.createElement("div",{className:"admin__ratio-slider"},a.createElement("input",{className:"legacy__input admin__ratio-slider__range",type:"range",name:o+"__range",min:e,max:t,step:r,value:n,onChange:this.onChangeValue,disabled:l}),i&&a.createElement("input",{className:"legacy__input admin__ratio-slider__input admin__ratio-slider__percentage",type:"text",name:o+"__value",min:e,max:t,value:(100*n|0)+"%",onChange:this.onChangePercentage,disabled:l}),s&&a.createElement("input",{className:"legacy__input admin__ratio-slider__input admin__ratio-slider__value",type:"text",name:o+"__value",min:e,max:t,value:n,onChange:this.onChangeValue,disabled:l}))}}sa(la,"defaultProps",{max:1,min:0,showPercentage:!0,showValue:!1,step:.01,isDisabled:!1});var ca=r(209);function ua(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class da extends a.PureComponent{constructor(){super(...arguments),ua(this,"onChangeVariationRatio",(e,t)=>{const{experiment:r,onChange:a}=this.props;a(r.KEY,t.KEY,parseFloat(e.currentTarget.value)/100)})}getVariationRatio(e){const{experiment:t,variationRatios:r}=this.props,a=r.get(t.KEY);return a?parseFloat(a.get(e)):0}render(){const{experiment:e,isDisabled:t}=this.props;return a.createElement(a.Fragment,null,a.createElement("span",{className:"admin__experiment__details__label"},Object(f.b)(e=>e.admin.experiments.variationsLabel)),a.createElement("ul",null,e.variations.map(r=>a.createElement("li",{key:r.KEY},r.KEY===e.defaultVariation?r.KEY+"*":r.KEY,a.createElement("input",{type:"text",value:(100*this.getVariationRatio(r.KEY)|0)+"%",onChange:e=>this.onChangeVariationRatio(e,r),className:"legacy__input admin__variation-input",disabled:t})))))}}ua(da,"contextTypes",{experimentsStore:K.a.instanceOf(ca.a).isRequired}),ua(da,"defaultProps",{isDisabled:!1});var ha=r(17),ma=r(106),pa=(r(450),r(60)),ba=r(31),ga=r(107),fa=r(110);function _a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function ya(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Ea extends a.Component{constructor(e,t){super(e,t),ya(this,"onChangeRatio",(e,t)=>{const{ratios:r}=this.state;r.set(e,t),this.setState({ratios:new Map(r)})}),ya(this,"clearErrors",()=>{this.setState({errors:new Map})}),ya(this,"onChangeVariationRatio",(e,t,r)=>{const a=this.state.variationRatios,n=a.get(e);n?n.set(t,r):a.set(e,new Map([[t,r]])),this.setState({variationRatios:new Map(a)})}),ya(this,"onSubmitUpdate",async e=>{var t;const{ratios:r,experimentStates:a,errors:n}=this.state,o=this.context.api,i=a.get(e.KEY),s=Sa(a.get(e.KEY)),l=this.generateVariationRatios(e.KEY,e.variations),c=(null!=(t=i)?t.trafficRatio:t)||0,u=r.get(e.KEY),d=u||c,h=u?u-c:0;if(this.validateSubmission(l.sum,h,e,s),0===n.size){const t={key:e.KEY,variations:l.ratios,trafficRatio:d,status:d>0?pa.d:pa.c,salt:e.KEY};try{await o.setExperimentState(t),await o.getExperiments()}catch(t){this.setState({errors:n.set(e.KEY,Object(f.b)(e=>e.admin.errors.apiError))})}}}),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_a(Object(r),!0).forEach((function(t){ya(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({errors:new Map},this.getStateFromExperimentsStore()),this.context.experimentsStore.registerComponent(this,()=>{this.setState(this.getStateFromExperimentsStore())})}getStateFromExperimentsStore(){const e=this.context.experimentsStore,t=e.getExperimentStates()?new Map(Object.entries(e.getExperimentStates())):new Map,r=new Map,a=new Map;return t.forEach((e,t)=>{const n=e.trafficRatio;r.set(t,n);const o=new Map;e.variations.forEach(e=>{o.set(e.key,e.ratio)}),a.set(e.key,o)}),{experimentStates:t,ratios:r,variationRatios:a}}terminateExperiment(e){this.clearErrors(),this.context.dispatcher.dispatch(Object(ga.b)({id:ba.b.TERMINATE_EXPERIMENT,data:e}))}validateSubmission(e,t,r,a){const{errors:n}=this.state;switch(this.clearErrors(),Math.abs(e-1)>Number.EPSILON&&(n.set(r.KEY,Object(f.b)(e=>e.admin.errors.validVariationRatios)),this.setState({errors:new Map(n)})),a){case pa.d:t<0&&(n.set(r.KEY,Object(f.b)(e=>e.admin.errors.alreadyRunning)),this.setState({errors:new Map(n)}));break;case pa.a:n.set(r.KEY,Object(f.b)(e=>e.admin.errors.finishedExperiment)),this.setState({errors:new Map(n)})}}generateVariationRatios(e,t){const r=this.state.variationRatios.get(e),a=[];let n=0;return t.forEach(e=>{const t=r?r.get(e.KEY):0;a.push({key:e.KEY,ratio:t||0}),n+=t||0}),{ratios:a,sum:n}}render(){const{ratios:e,experimentStates:t,variationRatios:r,errors:n}=this.state,{envInfo:{hostname:o}}=this.context;return a.createElement("div",{className:"admin__experiments"},a.createElement("ul",{className:"admin__experiments__experiment-list"},Object(ha.e)(ha.b).map(i=>a.createElement("li",{key:i.KEY,className:"admin__experiments__experiment"},a.createElement(Oa,{error:n.get(i.KEY),hostname:o,experiment:i,onChangeRatio:this.onChangeRatio,onSubmitUpdate:this.onSubmitUpdate,experimentStoreModel:t.get(i.KEY),onClickTerminate:()=>this.terminateExperiment(i),ratio:e.get(i.KEY)||0,variationRatios:r,onChangeVariationRatio:this.onChangeVariationRatio})))))}}function Oa(e){let{error:t,experiment:r,hostname:n,ratio:o,onChangeRatio:i,onSubmitUpdate:s,onClickTerminate:l,variationRatios:c,onChangeVariationRatio:u,experimentStoreModel:d}=e;const h=Object(De.c)(n),m=Object(De.d)(n),p=!h&&!m,b=Sa(d),g=function(e){var t;const r=(e&&(null!=(t=e)?t.variations:t)||[]).find(e=>1==e.ratio)||null;return r?r.key:null}(d),_=r.defaultVariation,y=g!==_,E=b===pa.a,O=b===pa.d,S=b===pa.c;return a.createElement("div",{className:D()("admin__experiment",{"admin__experiment__finished ":E})},a.createElement("div",{className:"admin__experiment__details"},a.createElement("div",{className:"admin__experiment__details__row admin__experiment__key"},r.KEY," ",a.createElement(Be.a,{to:"ADMIN_EXPERIMENT_AUDIT",params:{key:r.KEY}},"audit")),r.description?a.createElement("div",{className:"admin__experiment__details__row admin__experiment__desc"},r.description):a.createElement("div",{className:"admin__experiment__details__row admin__experiment__desc admin__experiment__desc--not-set"},Object(f.b)(e=>e.admin.experiments.descNotSetLabel)),a.createElement("div",{className:"admin__experiment__details__row admin__experiment__variations"},a.createElement(da,{experiment:r,max:100,min:0,variationRatios:c,onChange:u,isDisabled:O||E})),a.createElement("div",{className:"admin__experiment__details__row admin__experiment__status"},a.createElement("span",{className:"admin__experiment__details__label"},Object(f.b)(e=>e.admin.experiments.statusLabel)),a.createElement("span",{className:D()("admin__experiment__details__value",{"admin-experiment__status-running":b===pa.d,"admin-experiment__status-pending":b===pa.c,"admin-experiment__status-finished":b===pa.a})},b),E&&g&&a.createElement("div",{className:"admin__experiment__details__row admin__experiment__default"},a.createElement("span",{className:"admin__experiment__details__label"},Object(f.b)(e=>e.admin.experiments.defaultVariationLabel)),a.createElement("span",{className:"admin__experiment__details__default__value"},g,y&&a.createElement("div",null,a.createElement("div",{className:"admin-experiment__stale-warning"},'WARNING - HARDCODED DEFAULT IS STILL "',_,'"'),a.createElement("div",null,"Please remove the experiment or update the defaultVariation in code so tests/local reflect reality."))))),r.path&&a.createElement("div",{className:"admin__experiment__details__row admin__experiment__path"},a.createElement("span",{className:"admin__experiment__details__label"},Object(f.b)(e=>e.admin.experiments.pathLabel)),a.createElement("span",{className:"admin__experiment__details__value"},r.path)),r.manualExposure&&a.createElement("div",{className:"admin__experiment__details__row admin__experiment__manual-exposure"},a.createElement("span",{className:"admin__experiment__details__label"},Object(f.b)(e=>e.admin.experiments.manuallyExposedLabel)),a.createElement("span",{className:"admin__experiment__details__value"},r.manualExposure.toString()))),a.createElement("div",{className:"admin__experiment__inputs"},h&&a.createElement("div",{className:"admin__experiment__slider"},a.createElement("div",{className:"admin__experiment__slider__label"},Object(f.b)(e=>e.admin.experiments.localLabel)),a.createElement(la,{name:"".concat(r.KEY),value:o,onChange:i,showPercentage:!0,isDisabled:E}),a.createElement("button",{className:"admin__experiment__update button button--secondary",disabled:E,onClick:()=>s(r)},Object(f.b)(e=>e.admin.updateButton))),p&&a.createElement("div",{className:"admin__experiment__slider"},a.createElement("div",{className:"admin__experiment__slider__label"},Object(f.b)(e=>e.admin.experiments.devLabel)),a.createElement(la,{name:"".concat(r.KEY),value:o,onChange:i,showPercentage:!0,isDisabled:E}),a.createElement("button",{className:"admin__experiment__update button button--secondary",disabled:E,onClick:()=>s(r)},Object(f.b)(e=>e.admin.updateButton))),m&&a.createElement("div",{className:"admin__experiment__slider"},a.createElement("div",{className:"admin__experiment__slider__label"},Object(f.b)(e=>e.admin.experiments.prodLabel)),a.createElement(la,{name:"".concat(r.KEY),value:o,onChange:i,showPercentage:!0,isDisabled:E}),a.createElement("button",{className:"admin__experiment__update button button--secondary",disabled:E,onClick:()=>s(r)},Object(f.b)(e=>e.admin.updateButton))),a.createElement("button",{className:"button button--primary admin__experiment__terminate-button",disabled:E||S,onClick:l},Object(f.b)(e=>e.admin.experiments.terminateButtonLabel)),t&&a.createElement("span",{className:"admin__experiment__update__error"},t)))}function Sa(e){var t;return(null!=(t=e)&&null!=(t=t.status)?t.value:t)||pa.b}function va(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-AdminExperimentsPage"),a.createElement(Ea,e)}ya(Ea,"contextTypes",{dispatcher:K.a.instanceOf(fa.Dispatcher).isRequired,experimentsStore:K.a.instanceOf(ca.a).isRequired,envInfo:K.a.instanceOf(ma.a).isRequired,api:K.a.instanceOf(pe.a).isRequired});class Ca extends a.Component{static willRouteTo(e){let{api:t}=e;return t.getExperiments()}render(){return a.createElement(va,null)}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Ca,"getPageTitle",()=>Object(f.b)(e=>e.general.appName));var wa=r(2),Pa=r.n(wa),Na=r(731);function xa(e){let{experimentKey:t}=e;const[r,n]=a.useState(!0),[o,i]=a.useState([]),{api:s}=Object(ze.c)();return t?(a.useEffect(()=>{s.getExperimentAudit(t).then(e=>{i(e.resultData),n(!1)})},[]),r?a.createElement("div",null,"Loading..."):a.createElement("table",null,a.createElement("thead",null,a.createElement("tr",null,a.createElement("th",null,"Date"),a.createElement("th",null,"Status"),a.createElement("th",null,"Traffic Ratio"),a.createElement("th",null,"Variation Ratios"))),a.createElement("tbody",null,o.map(e=>a.createElement("tr",{key:e.id},a.createElement(ja,null,Pa.a.unix(e.createdAtUtc).format("lll")),a.createElement(ja,null,e.status.value),a.createElement(ja,null,e.trafficRatio),a.createElement(ja,null,a.createElement("ul",null,e.variations.map(e=>a.createElement("li",{key:e.key},e.key,": ",e.ratio))))))))):"No experiment key found"}const ja=Na.b.td.withConfig({displayName:"AdminExperimentAuditPage__StyledTD",componentId:"sc-1uauilp-0"})(["padding:10px;"]);function Ra(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-AdminExperimentAuditPage"),a.createElement(xa,e)}function Ta(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Aa extends a.Component{render(){var e;const{match:t}=this.props,r=null!=(e=t)&&null!=(e=e.params)?e.key:e;return a.createElement(Ra,{experimentKey:r})}}Ta(Aa,"getPageTitle",()=>Object(f.b)(e=>e.general.appName)),Ta(Aa,"requiresAuthentication",()=>!0);var Ia=r(221);r(451);function ka(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Fa(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Da extends a.Component{constructor(e,t){super(e,t),Fa(this,"onChangeRatio",(e,t)=>{const{ratios:r}=this.state;r.set(e,t),this.setState({ratios:new Map(r)})}),Fa(this,"onSubmitUpdate",async e=>{var t;const{ratios:r,featureFlags:a,errors:n}=this.state,o=this.context.api;this.setState({errors:new Map});const i=a.get(e.KEY),s=r.get(e.KEY),l=s||0===s?s:(null!=(t=i)?t.trafficRatio:t)||0;if(0===n.size){const t={key:e.KEY,trafficRatio:l,salt:e.KEY};try{await o.setFeatureFlagState(t),await o.getFeatureFlags()}catch(t){this.setState({errors:n.set(e.KEY,Object(f.b)(e=>e.admin.errors.apiError))})}}}),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ka(Object(r),!0).forEach((function(t){Fa(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ka(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({errors:new Map},this.getStateFromFeatureFlagStore()),this.context.featureFlagStore.registerComponent(this,()=>{this.setState(this.getStateFromFeatureFlagStore())})}getStateFromFeatureFlagStore(){const e=this.context.featureFlagStore,t=e.getFeatureFlags()?new Map(Object.entries(e.getFeatureFlags())):new Map,r=new Map;return t.forEach((e,t)=>{const a=e.trafficRatio||0;r.set(t,a)}),{featureFlags:t,ratios:r}}render(){const{ratios:e,errors:t}=this.state,{envInfo:{hostname:r}}=this.context;return a.createElement("div",{className:"admin__features"},a.createElement("ul",{className:"admin__features__feature-flag-list"},Object(er.c)(er.b).map(n=>a.createElement("li",{key:n.KEY,className:"admin__features__feature-flag"},a.createElement(La,{feature:n,onChangeRatio:this.onChangeRatio,ratio:e.get(n.KEY)||0,hostname:r,onSubmitUpdate:this.onSubmitUpdate,error:t.get(n.KEY)})))))}}function La(e){let{hostname:t,feature:r,onChangeRatio:n,ratio:o,onSubmitUpdate:i,error:s}=e;const l=Object(De.c)(t),c=Object(De.d)(t),u=!l&&!c;return a.createElement("div",{className:"admin__feature-flag"},a.createElement("div",{className:"admin__feature-flag__details"},a.createElement("div",{className:"admin__feature-flag__details__row admin__feature-flag__key"},r.KEY),r.description?a.createElement("div",{className:"admin__feature-flag__details__row admin__feature-flag__desc"},r.description):a.createElement("div",{className:"admin__feature-flag__details__row admin__feature-flag__desc admin__feature-flag__desc--not-set"},Object(f.b)(e=>e.admin.featureFlags.descNotSetLabel)),a.createElement("div",{className:"admin__feature-flag__details__row admin__feature-flag__fallback"},a.createElement("span",{className:"admin__feature-flag__details__label"},Object(f.b)(e=>e.admin.featureFlags.fallbackLabel)),a.createElement("span",{className:"admin__feature-flag__details__value"},Object(f.b)(e=>e.admin.featureFlags.fallbackState[r.fallbackState.toString()])))),a.createElement("div",{className:"admin__feature-flag__inputs"},l&&a.createElement("div",{className:"admin__feature-flag__slider"},a.createElement("div",{className:"admin__feature-flag__slider__label"},Object(f.b)(e=>e.admin.featureFlags.localLabel)),a.createElement(la,{name:r.KEY,value:o,onChange:n,showPercentage:!0}),a.createElement("button",{className:"admin__experiment__update button button--secondary",onClick:()=>i(r)},Object(f.b)(e=>e.admin.updateButton))),u&&a.createElement("div",{className:"admin__feature-flag__slider"},a.createElement("div",{className:"admin__feature-flag__slider__label"},Object(f.b)(e=>e.admin.featureFlags.devLabel)),a.createElement(la,{name:r.KEY,value:o,onChange:n,showPercentage:!0}),a.createElement("button",{className:"admin__feature-flag__update button button--secondary",onClick:()=>i(r)},Object(f.b)(e=>e.admin.updateButton))),c&&a.createElement("div",{className:"admin__feature-flag__slider"},a.createElement("div",{className:"admin__feature-flag__slider__label"},Object(f.b)(e=>e.admin.featureFlags.prodLabel)),a.createElement(la,{name:r.KEY,value:o,onChange:n,showPercentage:!0}),a.createElement("button",{className:"admin__feature-flag__update button button--secondary",onClick:()=>i(r)},Object(f.b)(e=>e.admin.updateButton)),s&&a.createElement("span",{className:"admin__feature-flag__update__error"},s))))}function qa(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-AdminFeatureFlagsPage"),a.createElement(Da,e)}Fa(Da,"contextTypes",{api:K.a.instanceOf(pe.a).isRequired,envInfo:K.a.instanceOf(ma.a).isRequired,featureFlagStore:K.a.instanceOf(Ia.a).isRequired});class Ma extends a.Component{static willRouteTo(e){let{api:t}=e;return t.getFeatureFlags()}render(){return a.createElement(qa,null)}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Ma,"getPageTitle",()=>Object(f.b)(e=>e.general.appName));var Ha=r(109),za=r(25);function Ua(){return(Ua=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}const Va=e=>{let{queryType:t,queryValue:r,displayValue:n}=e;const o=function(e,t){switch(e){case Ha.b.SEARCH_RESULTS:return{to:"SEARCH",query:{q:t,sort:"relevance"}};case Ha.b.AUTHOR_PAPER:case Ha.b.AUTHOR_CITATION:return{to:"AUTHOR_PROFILE_BY_ID",params:{authorId:t}};case Ha.b.PAPER_CITATION:return{to:"PAPER_DETAIL_BY_ID",params:{paperId:t}};case Ha.b.ENTITY_PAPER:return{to:"ENTITY_BY_ID",params:{entityId:t}};case Ha.b.FEED_PAPER:return{to:"FEEDS_FEED",params:{feedId:t}};default:return null}}(t,r),i=Object(za.p)(n,100);return a.createElement(Be.a,Ua({className:"truncate-line"},o),i)};Va.propTypes={queryType:K.a.string.isRequired,queryValue:K.a.string.isRequired,displayValue:K.a.string.isRequired};var Ba=Va,Ya=r(747);r(68);function Ka(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Wa extends a.PureComponent{constructor(){super(...arguments),Ka(this,"onToggle",()=>{const{id:e,isActive:t}=this.props.alert,r=t?Ha.e.DISABLED:Ha.e.ACTIVE,{TOGGLE_SUCCESS:a,TOGGLE_FAILURE:n}=$t.a.UserAlerts;this.context.api.updateAlert({alertId:e,status:r}).then(()=>Object(nr.a)(rr.a.create(a,{alertId:e,alertStatus:r}))).catch(t=>{let{status:a,error:o}=t;Object(nr.a)(rr.a.create(n,{alertId:e,alertStatus:r,error:o,status:a}))})}),Ka(this,"onDelete",()=>{this.context.dispatcher.dispatch(Object(ga.b)({id:ba.b.DELETE_ALERT,data:this.props.alert}))})}render(){const{isActive:e,displayValue:t,queryType:r,queryValue:n}=this.props.alert,o=D()("alert-subscription","flex-row-vcenter",{"is-disabled":!e}),i=Object(f.b)(e=>e.alerts.queryType[r].description);return a.createElement("li",{className:o},a.createElement(Zt.a,{className:"account-alerts__subscriptions__toggle",selected:e,onClick:this.onToggle}),a.createElement(Ba,{queryType:r,queryValue:n,displayValue:t}),a.createElement("span",{className:"account-alerts__subscriptions__headline flex-static"},i),a.createElement(Ya.default,{type:Ya.TYPE.TERTIARY,className:"alert__delete-button flex-static mod-clickable",icon:a.createElement(J.a,{icon:"x",width:"15",height:"15"}),iconPosition:Ya.ICON_POSITION.RIGHT,onClick:this.onDelete,label:Object(f.b)(e=>e.alerts.delete.removeLabel)}))}}Ka(Wa,"contextTypes",{api:K.a.instanceOf(pe.a).isRequired,dispatcher:K.a.instanceOf(fa.Dispatcher).isRequired});var Qa=r(63),Ga=r(150),Xa=r(1014),Ja=r.n(Xa);function Za(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function $a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class en extends a.Component{constructor(e,t){super(e,t),$a(this,"generateErrorList",e=>ne.List(e.filter(e=>!!e))),$a(this,"onClickUpdateEmail",async()=>{const{savedEmail:e,_updateEmailInput:t}=this.state,{api:r}=this.context;t||!e?t!==e?(this.setState({isEmailUpdating:!0}),t&&r.updateUser({alertEmail:t.trim()}).then(()=>{this.setState({showEmailInput:!1,savedEmail:t,emailError:null,isEmailUpdating:!1,_updateEmailInput:null})}).catch(()=>{this.setState({isEmailUpdating:!1,emailError:Object(f.b)(e=>e.account.page.contact.email.invalidEmailError)})})):this.setState({showEmailInput:!1,emailError:null,_updateEmailInput:null}):this.setState({showEmailInput:!1,_updateEmailInput:null})}),$a(this,"onCancelEmail",()=>{this.setState({showEmailInput:!1,emailError:null,_updateEmailInput:null})}),$a(this,"onUpdateEmail",e=>{this.setState({_updateEmailInput:e})}),$a(this,"displayEmailInput",()=>{const{savedEmail:e}=this.state;this.setState({showEmailInput:!0,_updateEmailInput:e})}),$a(this,"showVerifyEmailButton",()=>{const{hasVerifiedAlertEmail:e,savedEmail:t,_updateEmailInput:r}=this.state;return!e&&t&&t!==r}),$a(this,"reVerify",()=>{const{api:e,messageStore:t}=this.context,r=Object(f.b)(e=>e.alerts.email.verifySuccess,this.state.savedEmail);e.resendVerificationEmail({email:this.state.savedEmail}).then(()=>t.addSuccess(r)).catch(()=>t.addError(Qa.a.getString("error.general-error")))}),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Za(Object(r),!0).forEach((function(t){$a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Za(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({showEmailInput:!1,emailError:null,isEmailUpdating:!1,_updateEmailInput:null},this.getStateFromAuthStore()),this.context.authStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthStore())})}getStateFromAuthStore(){const{authStore:e}=this.context,t=e.getAlertEmail()||"";return{savedEmail:t,hasVerifiedAlertEmail:e.hasVerifiedAlertEmail(),isValidEmail:Ja.a.validate(t)}}renderEmailChange(){const{savedEmail:e,emailError:t,isEmailUpdating:r,_updateEmailInput:n}=this.state;return a.createElement("div",{className:"account-alerts__update-email__change"},a.createElement("div",{className:"account-alerts__email__headline"},Object(f.b)(e=>e.alerts.email.headline)),a.createElement("div",{className:"account-alerts__update-email__headline__buttons"},a.createElement("div",{className:"account-alerts__update-email__input"},a.createElement(Jt.a,{className:"standard-form account-alerts__update-email__input-box",value:n,onChange:this.onUpdateEmail,errors:this.generateErrorList([t]),isRequired:!0,placeholder:e})),a.createElement("div",{className:"account-alerts__update-email__change-buttons"},a.createElement("button",{className:"button button--primary account-alerts__update-email__update-button",onClick:this.onClickUpdateEmail,disabled:r},a.createElement("div",{className:"flex-row-centered"},a.createElement("span",{className:"icon-button-text"},Object(f.b)(e=>e.account.page.contact.email.updateLabel)))),a.createElement("button",{className:"button button--secondary account-alerts__update-email__cancel-button",onClick:this.onCancelEmail},a.createElement("div",{className:"flex-row-centered"},a.createElement("span",{className:"icon-button-text"},Object(f.b)(e=>e.account.page.contact.email.cancelLabel)))))))}renderEmailNoChange(){const{savedEmail:e,emailError:t,isValidEmail:r,hasVerifiedAlertEmail:n}=this.state,o=n?"verified":"unverified";return a.createElement("div",{className:"account-alerts__update-email__no-change"},a.createElement("div",{className:"account-alerts__email__headline"},Object(f.b)(e=>e.alerts.email.headline)),a.createElement("div",{className:"account-alerts__update-email__headline__buttons"},a.createElement("span",{className:"account-alerts__update-email__email"},e||""),a.createElement("span",{className:"account-alerts__update-email__no-email-error"},t&&t),e&&a.createElement("div",{className:"account-alerts__update-email__verification-status-tag"},Object(f.b)(e=>e.alerts.email.verification[o]),a.createElement(J.a,{icon:n?"check-in-green-circle":"status-warning",className:"verify-icon",width:"12",height:"12"})),a.createElement("div",{className:"account-alerts__update-email__buttons"},this.showVerifyEmailButton()&&a.createElement("button",{className:"button button--primary account-alerts__email__verify-button",onClick:this.reVerify,disabled:n&&r},Object(f.b)(e=>e.alerts.email.resendEmail)),a.createElement("button",{className:"button button--secondary account-alerts__update-email__button",onClick:this.displayEmailInput},a.createElement("div",{className:"flex-row-centered"},a.createElement("span",{className:"icon-button-text"},Object(f.b)(e=>e.account.page.contact.email.buttonLabel)))))))}render(){const{showEmailInput:e}=this.state;return a.createElement("div",{className:"account-alerts__email-section"},e?this.renderEmailChange():this.renderEmailNoChange())}}$a(en,"contextTypes",{api:K.a.instanceOf(pe.a).isRequired,authStore:K.a.instanceOf(Ne.a).isRequired,messageStore:K.a.instanceOf(Ga.a).isRequired});var tn=r(135),rn=r(719);function an(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const nn=["daily","weekly"];class on extends a.PureComponent{constructor(){super(...arguments),an(this,"getStateFromAuthStore",()=>{const{authStore:e}=this.context;return{frequency:e.getAlertFrequency()}}),this.state=this.getStateFromAuthStore(),this.context.authStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthStore)})}onFrequencySelected(e){const{api:t}=this.context,{frequency:r}=this.state,{SET_FREQUENCY:a}=$t.a.UserAlerts;e!==r&&(t.updateAlertFrequency({alertFrequency:e}),Object(nr.a)(rn.a.create(a,{frequency:e})))}renderFrequency(e){const t=tn.a[e];return a.createElement("div",{className:"alert-frequency__option"},a.createElement("input",{type:"radio",key:e,value:t,className:"frequency-button","data-selenium-selector":this.state.frequency===t?"frequency-button-selected":"frequency-button","data-selenium-frequency":e,checked:this.state.frequency===t,onChange:()=>this.onFrequencySelected(t)}),a.createElement("label",{htmlFor:e},Object(f.b)(t=>t.alerts.frequency.frequencies[e])))}render(){return a.createElement("div",{className:"alert-frequency"},a.createElement("div",{className:"alert-frequency__headline"},Object(f.b)(e=>e.alerts.frequency.title)),a.createElement("div",{className:"alert-frequency__subtitle"},Object(f.b)(e=>e.alerts.frequency.subtitle)),a.createElement("div",null,nn.map(this.renderFrequency.bind(this))))}}an(on,"contextTypes",{api:K.a.instanceOf(pe.a).isRequired,authStore:K.a.instanceOf(Ne.a).isRequired});var sn=r(155);function ln(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class cn extends a.PureComponent{constructor(){super(...arguments),ln(this,"getStateFromAlertsStore",()=>{const{alertsStore:e}=this.context;return{alerts:e.getAlerts().toList().groupBy(e=>e.queryType),isLoading:e.isLoading()}}),ln(this,"renderAlertsList",e=>{const t=this.state.alerts.get(e),r=Object(f.b)(t=>t.alerts.queryType[e].title);return t&&a.createElement("div",{className:"account-alerts__subscription",key:e,"data-selenium-selector":"alerts-results","data-count":t.size},a.createElement("div",{className:"account-alerts__subscriptions__headline"},r),a.createElement("ul",null,t.map(this.renderAlert)))}),this.state=this.getStateFromAlertsStore(),this.context.alertsStore.registerComponent(this,()=>{this.setState(this.getStateFromAlertsStore)})}renderEmpty(){return a.createElement(a.Fragment,null,a.createElement("h4",{"data-selenium-selector":"alerts-results","data-count":0},Object(f.b)(e=>e.alerts.empty.title)),a.createElement("p",null,Object(f.b)(e=>e.alerts.empty.description)))}renderAlert(e){return a.createElement(Wa,{alert:e,key:e.id})}render(){const{isLoading:e,alerts:t}=this.state;return e?a.createElement(Ce.a,null):t.isEmpty()?this.renderEmpty():a.createElement("div",{className:"account-alerts"},a.createElement("div",{className:"account-settings-nav-label"},Object(f.b)(e=>e.account.section.general.navLabel)),a.createElement("h2",{className:"account-alerts__headline"},Object(f.b)(e=>e.account.page.alerts.pageHeading)),a.createElement("hr",{className:"account__divider"}),a.createElement("div",{className:"account-alerts__email-section"},a.createElement(en,null)),a.createElement("hr",{className:"account__divider"}),a.createElement(on,null),a.createElement("hr",{className:"account__divider"}),a.createElement("div",{className:"account-alerts__subscriptions"},a.createElement("div",{className:"account-alerts__subscriptions__list"},Ha.c.toList().map(this.renderAlertsList))))}}function un(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-AlertsListsPage"),a.createElement(cn,e)}ln(cn,"contextTypes",{alertsStore:K.a.instanceOf(sn.a).isRequired});class dn extends a.Component{static async willRouteTo(e){let{alertsStore:t,api:r}=e;return t.isLoading()?r.fetchAlerts():Promise.resolve()}render(){return a.createElement(un,null)}}function hn(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(dn,"getPageTitle",()=>Object(f.b)(e=>e.account.page.alerts.pageTitle));class mn extends a.Component{static willRouteTo(){return new St.a({routeName:"ACCOUNT_ALERTS"})}render(){return null}}hn(mn,"requiresAuthentication",()=>!0),hn(mn,"getPageTitle",()=>Object(f.b)(e=>e.alerts.pageTitle));var pn=r(966),bn=r(979),gn=r(720),fn=r(924),_n=r(167),yn=r(175),En=r(371);function On(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Sn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?On(Object(r),!0).forEach((function(t){vn(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):On(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function vn(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Cn extends a.PureComponent{constructor(e,t){super(e,t),vn(this,"onClickFlag",()=>{const{moderationTag:e}=this.state,t=e?null:"Awaiting Response";this.setState({moderationTag:t});const{authorProfile:r}=this.props;this.context.api.setAuthorProfileModerationTag({authorProfileId:r.id,moderationTag:t})}),vn(this,"onClickInternalNotesSave",()=>{const e=this.state.draftInternalNotes;this.setState({internalNotes:e,draftInternalNotes:e}),this.updateInternalNotes(e)}),vn(this,"onChangeReason",e=>{const t=Object(yn.d)(e.currentTarget.value);this.setState({isReasonHighlighted:!1,selectedReason:t})}),vn(this,"onClickApprove",()=>{const{selectedReason:e}=this.state;e?this.setState({isReasonHighlighted:!0}):(this.setState({selectedStatus:vr.b.Approved}),this.updateModerationStatus(vr.b.Approved))}),vn(this,"onClickDeny",()=>{const{selectedReason:e}=this.state;e&&yn.a[e]?(this.setState({selectedStatus:vr.b.Denied}),this.updateModerationStatus(vr.b.Denied)):this.setState({isReasonHighlighted:!0})}),vn(this,"onChangeInternalNotes",e=>{const{value:t}=e.currentTarget;this.setState({draftInternalNotes:t})});const{authorProfile:r}=this.props;this.state=Sn({isConfirmVisible:!1,moderationTag:r.moderationTag,isReasonHighlighted:!1,internalNotes:r.internalNotes||"",selectedStatus:r.moderationStatus||null,selectedReason:r.moderationStatusReason||null,draftInternalNotes:r.internalNotes||""},this.getStateFromClaimModerationStore()),this.runRuleChecks(r.id),this.context.claimModerationStore.registerComponent(this,()=>{this.setState(Sn({},this.getStateFromClaimModerationStore()))})}async runRuleChecks(e){const t=this.context.api,r=await t.getModerationRecommendation({authorRowId:e});return r?r.resultData.result:En.a.InsufficientData}getStateFromClaimModerationStore(){const e=this.context.claimModerationStore;return{claimedAuthor:e.getClaimedAuthor(),claimedPreviously:e.getClaimedPreviousAuthorProfiles(),claimingAppUser:e.getClaimingAppUser(),orcidVerifyResult:e.getOrcidResult()}}async updateModerationStatus(e){const{authorProfile:t}=this.props,{internalNotes:r,selectedReason:a}=this.state,n=this.context.api,o=this.context.authStore.getEmail();B()(o,"User have an email to moderate.");const i=a?yn.c[a]:null;await n.updateModerationStatus({authorProfileId:t.id,moderationStatus:e,moderator:o,moderatorNotes:"",moderationStatusReason:i,internalNotes:r}),this.props.onRefreshRows()}async updateInternalNotes(e){const{authorProfile:t}=this.props,r=this.context.api;await r.updateInternalNotes({authorProfileId:t.id,internalNotes:e})}renderAuthorName(){var e,t,r;const{authorProfile:n}=this.props,{claimedAuthor:o,claimingAppUser:i}=this.state,s=(null!=(r=n)?r.fullName:r)||a.createElement(Pn,null),l=(null!=(t=o)?t.name:t)||a.createElement(Pn,null),c=(null!=(e=i)?e.fullName:e)||a.createElement(Pn,null);return a.createElement("div",{className:"moderation__author-claim__details__comparison"},a.createElement("div",null,a.createElement("span",{className:"moderation__author-claim__details__comparison__label"},"Claim Form"),a.createElement("span",{className:"moderation__author-claim__details__comparison__value"},s)),a.createElement("div",null,a.createElement("span",{className:"moderation__author-claim__details__comparison__label"},"Login Name"),a.createElement("span",{className:"moderation__author-claim__details__comparison__value"},c)),a.createElement("div",null,a.createElement("span",{className:"moderation__author-claim__details__comparison__label"},"Author Page"),a.createElement("span",{className:"moderation__author-claim__details__comparison__value"},l)))}renderEmail(){var e,t,r,n;const{authorProfile:o}=this.props,{claimingAppUser:i}=this.state,s=(null!=(n=o)?n.email:n)||a.createElement(Pn,null),l=null!=(r=i)?r.email:r,c=(null!=(t=i)?t.alertEmail:t)||a.createElement(Pn,null),u=(null!=(e=i)?e.alertEmailIsVerified:e)||!1;return a.createElement("div",{className:"moderation__author-claim__details__comparison"},a.createElement("div",null,a.createElement("span",{className:"moderation__author-claim__details__comparison__label"},"Claim Form"),a.createElement("span",{className:"moderation__author-claim__details__comparison__value"},s)),a.createElement("div",null,a.createElement("span",{className:"moderation__author-claim__details__comparison__label"},"Login Email"),a.createElement("span",{className:"moderation__author-claim__details__comparison__value"},l?a.createElement(a.Fragment,null,a.createElement(Nn,null)," ",l):a.createElement(Pn,null))),a.createElement("div",null,a.createElement("span",{className:"moderation__author-claim__details__comparison__label"},"Alert Email"),a.createElement("span",{className:"moderation__author-claim__details__comparison__value"},u&&a.createElement(Nn,null)," ",c)))}renderFieldOfStudy(){const{claimingAppUser:e}=this.state;return e?0===e.fieldsOfStudy.size?a.createElement(Pn,null):1===e.fieldsOfStudy.size?e.fieldsOfStudy.get(0):a.createElement("ul",null,e.fieldsOfStudy.map(e=>a.createElement("li",{key:e},e))):a.createElement(Pn,null)}renderPreviouslyClaimed(){const{claimedPreviously:e}=this.state;return 0===e.size?a.createElement(Pn,null):a.createElement("ul",null,e.map(e=>a.createElement("li",{key:e.id},a.createElement("div",{className:"moderation__author-claim__details__comparison"},a.createElement("div",null,a.createElement("span",{className:"moderation__author-claim__details__comparison__label"},"Name"),a.createElement("span",{className:"moderation__author-claim__details__comparison__value"},e.fullName)),a.createElement("div",null,a.createElement("span",{className:"moderation__author-claim__details__comparison__label"},"Author ID"),a.createElement("span",{className:"moderation__author-claim__details__comparison__value"},e.ai2AuthorId)),a.createElement("div",null,a.createElement("span",{className:"moderation__author-claim__details__comparison__label"},"Status"),a.createElement("span",{className:"moderation__author-claim__details__comparison__value"},e.moderationStatus)),a.createElement("div",null,a.createElement("span",{className:"moderation__author-claim__details__comparison__label"},"Reason"),a.createElement("span",{className:"moderation__author-claim__details__comparison__value"},e.moderationStatusReason))))))}renderInternalNotesHistory(){const e=this.state.internalNotes;return a.createElement("div",{className:"moderation__author-claim__details__comparison"},a.createElement("div",null,a.createElement("span",{className:"moderation__author-claim__details__comparison__label"},"Note"),a.createElement("span",{className:"moderation__author-claim__details__comparison__value"},e)))}renderOrcidCheck(){const e=this.state.orcidVerifyResult;if(e){if(e==En.a.Passed)return a.createElement(Nn,null);if(e==En.a.Failed)return a.createElement(J.a,{icon:"circle-x",width:"20",height:"20"});if(e==En.a.InsufficientData)return a.createElement(J.a,{icon:"status-warning",width:"20",height:"20"})}return a.createElement(Pn,null)}formatHomepageUrl(e){return e.toLocaleLowerCase().startsWith("http")?e:"http://".concat(e)}render(){const{authorProfile:e}=this.props,{moderationTag:t,isReasonHighlighted:r,selectedStatus:n,selectedReason:o,claimingAppUser:i,draftInternalNotes:s}=this.state;return a.createElement("div",{className:"moderation__author-claim__details"},a.createElement("div",{className:"moderation__author-claim__details__header"},a.createElement(gn.a,{href:"/author/".concat(e.ai2AuthorId),className:"moderation__author-claim__details__name"},e.fullName),a.createElement("div",{className:D()({"moderation__author-claim__details__flag":!0,"moderation__author-claim__is-flagged":t}),title:"".concat(t?"Unflag":"Flag as",' "Awaiting Response"')},a.createElement(J.a,{icon:"moderation-flag",onClick:this.onClickFlag}))),a.createElement("div",{className:"moderation__author-claim__details__body"},a.createElement(wn,{label:"Author Name"},this.renderAuthorName()),a.createElement(wn,{label:"Affiliation(s)"},(()=>{switch(e.affiliations.length){case 0:return null;case 1:return e.affiliations.join("");default:return a.createElement("ul",{className:"moderation__author-claim__details__affiliations"},e.affiliations.map(e=>a.createElement("li",{key:e},e)))}})()),a.createElement(wn,{label:"Email(s)"},this.renderEmail()),a.createElement(wn,{label:"Field of Study"},this.renderFieldOfStudy()),a.createElement(wn,{label:"Current Role"},!!i&&i.currentRole),a.createElement(wn,{label:"ORCiD"},e.orcidId?a.createElement(fn.a,{orcidId:e.orcidId}):null,this.renderOrcidCheck()),a.createElement(wn,{label:"Homepage"},e.homepageUrl&&a.createElement(gn.a,{href:this.formatHomepageUrl(e.homepageUrl)},e.homepageUrl)),a.createElement(wn,{label:"Previously Claimed"},this.renderPreviouslyClaimed()),a.createElement(wn,{label:"User Comment"},e.userComment),a.createElement(wn,{label:"Internal Notes"},this.renderInternalNotesHistory())),a.createElement("div",{className:"moderation__author-claim__details__footer"},a.createElement("div",{className:"moderation__author-claim__details__internal-notes"},a.createElement("textarea",{className:"legacy__textarea moderation__author-claim__details__internal-notes__input",placeholder:"Type note here...",onChange:this.onChangeInternalNotes,value:s}),a.createElement(J.a,{icon:"circle-plus",className:"moderation__author-claim__details__internal-notes__submit",title:"Save notes only",onClick:this.onClickInternalNotesSave})),a.createElement("select",{className:D()({legacy__select:!0,"moderation__author-claim__details__reason":!0,"moderation__author-claim__details__is-highlighted":r}),value:o||"",onChange:this.onChangeReason},a.createElement("option",{key:"",value:""}),Object.keys(yn.c).map(e=>a.createElement("option",{key:e,value:e},yn.c[e]))),a.createElement("div",{className:"moderation__author-claim__details__button-row","data-moderation-status":n||e.moderationStatus},a.createElement("button",{onClick:this.onClickApprove,className:"moderation__author-claim__details__button moderation__author-claim__details__button__approve"},a.createElement(J.a,{icon:"check-in-green-circle"}),a.createElement("span",{className:"moderation__author-claim__details__button__label"},"APPROVE")),a.createElement("button",{onClick:this.onClickDeny,className:"moderation__author-claim__details__button moderation__author-claim__details__button__deny"},a.createElement(J.a,{icon:"circle-x"}),a.createElement("span",{className:"moderation__author-claim__details__button__label"},"DENY")))))}}vn(Cn,"contextTypes",{api:K.a.instanceOf(pe.a).isRequired,authStore:K.a.instanceOf(Ne.a).isRequired,claimModerationStore:K.a.instanceOf(_n.a).isRequired});const wn=e=>{let{label:t,children:r}=e;return a.createElement("div",{className:"moderation__author-claim__details__field"},a.createElement("div",{className:"moderation__author-claim__details__field__label"},t),a.createElement("div",{className:"moderation__author-claim__details__field__value"},null==r?a.createElement(Pn,null):r))},Pn=()=>a.createElement("div",{className:"moderation__author-claim__details__field__value__missing"},"No Value"),Nn=()=>a.createElement(xn,{icon:"checkmark",width:"15",height:"15"}),xn=Object(Na.b)(J.a).withConfig({displayName:"AuthorClaimModerationDetails__GreenIcon",componentId:"sc-1hreb8p-0"})(["fill:green;"]);var jn=r(775),Rn=r.n(jn),Tn=r(776),An=r.n(Tn),In=r(777),kn=r.n(In),Fn=r(778),Dn=r.n(Fn),Ln=r(762),qn=r.n(Ln),Mn=r(738),Hn=r.n(Mn),zn=r(817);function Un(){return(Un=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Vn(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function Bn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Yn="object"==typeof performance&&"function"==typeof performance.now?function(){return performance.now()}:function(){return Date.now()};function Kn(e){cancelAnimationFrame(e.id)}function Wn(e,t){var r=Yn();var a={id:requestAnimationFrame((function n(){Yn()-r>=t?e.call(null):a.id=requestAnimationFrame(n)}))};return a}var Qn=-1;var Gn=null;function Xn(e){if(void 0===e&&(e=!1),null===Gn||e){var t=document.createElement("div"),r=t.style;r.width="50px",r.height="50px",r.overflow="scroll",r.direction="rtl";var a=document.createElement("div"),n=a.style;return n.width="100px",n.height="100px",t.appendChild(a),document.body.appendChild(t),t.scrollLeft>0?Gn="positive-descending":(t.scrollLeft=1,Gn=0===t.scrollLeft?"negative":"positive-ascending"),document.body.removeChild(t),Gn}return Gn}var Jn=function(e){var t=e.columnIndex;e.data;return e.rowIndex+":"+t};function Zn(e){var t,r,n=e.getColumnOffset,o=e.getColumnStartIndexForOffset,i=e.getColumnStopIndexForStartIndex,s=e.getColumnWidth,l=e.getEstimatedTotalHeight,c=e.getEstimatedTotalWidth,u=e.getOffsetForColumnAndAlignment,d=e.getOffsetForRowAndAlignment,h=e.getRowHeight,m=e.getRowOffset,p=e.getRowStartIndexForOffset,b=e.getRowStopIndexForStartIndex,g=e.initInstanceProps,f=e.shouldResetStyleCacheOnItemSizeChange,_=e.validateProps;return r=t=function(e){function t(t){var r;return(r=e.call(this,t)||this)._instanceProps=g(r.props,Bn(Bn(r))),r._resetIsScrollingTimeoutId=null,r._outerRef=void 0,r.state={instance:Bn(Bn(r)),isScrolling:!1,horizontalScrollDirection:"forward",scrollLeft:"number"==typeof r.props.initialScrollLeft?r.props.initialScrollLeft:0,scrollTop:"number"==typeof r.props.initialScrollTop?r.props.initialScrollTop:0,scrollUpdateWasRequested:!1,verticalScrollDirection:"forward"},r._callOnItemsRendered=void 0,r._callOnItemsRendered=Object(zn.a)((function(e,t,a,n,o,i,s,l){return r.props.onItemsRendered({overscanColumnStartIndex:e,overscanColumnStopIndex:t,overscanRowStartIndex:a,overscanRowStopIndex:n,visibleColumnStartIndex:o,visibleColumnStopIndex:i,visibleRowStartIndex:s,visibleRowStopIndex:l})})),r._callOnScroll=void 0,r._callOnScroll=Object(zn.a)((function(e,t,a,n,o){return r.props.onScroll({horizontalScrollDirection:a,scrollLeft:e,scrollTop:t,verticalScrollDirection:n,scrollUpdateWasRequested:o})})),r._getItemStyle=void 0,r._getItemStyle=function(e,t){var a,o,i=r.props,l=i.columnWidth,c=i.direction,u=i.rowHeight,d=r._getItemStyleCache(f&&l,f&&c,f&&u),p=e+":"+t;d.hasOwnProperty(p)?a=d[p]:d[p]=((o={position:"absolute"})["rtl"===c?"right":"left"]=n(r.props,t,r._instanceProps),o.top=m(r.props,e,r._instanceProps),o.height=h(r.props,e,r._instanceProps),o.width=s(r.props,t,r._instanceProps),a=o);return a},r._getItemStyleCache=void 0,r._getItemStyleCache=Object(zn.a)((function(e,t,r){return{}})),r._onScroll=function(e){var t=e.currentTarget,a=t.clientHeight,n=t.clientWidth,o=t.scrollLeft,i=t.scrollTop,s=t.scrollHeight,l=t.scrollWidth;r.setState((function(e){if(e.scrollLeft===o&&e.scrollTop===i)return null;var t=r.props.direction,c=o;if("rtl"===t)switch(Xn()){case"negative":c=-o;break;case"positive-descending":c=l-n-o}c=Math.max(0,Math.min(c,l-n));var u=Math.max(0,Math.min(i,s-a));return{isScrolling:!0,horizontalScrollDirection:e.scrollLeft<o?"forward":"backward",scrollLeft:c,scrollTop:u,verticalScrollDirection:e.scrollTop<i?"forward":"backward",scrollUpdateWasRequested:!1}}),r._resetIsScrollingDebounced)},r._outerRefSetter=function(e){var t=r.props.outerRef;r._outerRef=e,"function"==typeof t?t(e):null!=t&&"object"==typeof t&&t.hasOwnProperty("current")&&(t.current=e)},r._resetIsScrollingDebounced=function(){null!==r._resetIsScrollingTimeoutId&&Kn(r._resetIsScrollingTimeoutId),r._resetIsScrollingTimeoutId=Wn(r._resetIsScrolling,150)},r._resetIsScrolling=function(){r._resetIsScrollingTimeoutId=null,r.setState({isScrolling:!1},(function(){r._getItemStyleCache(-1)}))},r}Vn(t,e),t.getDerivedStateFromProps=function(e,t){return $n(e,t),_(e),null};var r=t.prototype;return r.scrollTo=function(e){var t=e.scrollLeft,r=e.scrollTop;void 0!==t&&(t=Math.max(0,t)),void 0!==r&&(r=Math.max(0,r)),this.setState((function(e){return void 0===t&&(t=e.scrollLeft),void 0===r&&(r=e.scrollTop),e.scrollLeft===t&&e.scrollTop===r?null:{horizontalScrollDirection:e.scrollLeft<t?"forward":"backward",scrollLeft:t,scrollTop:r,scrollUpdateWasRequested:!0,verticalScrollDirection:e.scrollTop<r?"forward":"backward"}}),this._resetIsScrollingDebounced)},r.scrollToItem=function(e){var t=e.align,r=void 0===t?"auto":t,a=e.columnIndex,n=e.rowIndex,o=this.props,i=o.columnCount,s=o.height,h=o.rowCount,m=o.width,p=this.state,b=p.scrollLeft,g=p.scrollTop,f=function(e){if(void 0===e&&(e=!1),-1===Qn||e){var t=document.createElement("div"),r=t.style;r.width="50px",r.height="50px",r.overflow="scroll",document.body.appendChild(t),Qn=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return Qn}();void 0!==a&&(a=Math.max(0,Math.min(a,i-1))),void 0!==n&&(n=Math.max(0,Math.min(n,h-1)));var _=l(this.props,this._instanceProps),y=c(this.props,this._instanceProps)>m?f:0,E=_>s?f:0;this.scrollTo({scrollLeft:void 0!==a?u(this.props,a,r,b,this._instanceProps,E):b,scrollTop:void 0!==n?d(this.props,n,r,g,this._instanceProps,y):g})},r.componentDidMount=function(){var e=this.props,t=e.initialScrollLeft,r=e.initialScrollTop;if(null!=this._outerRef){var a=this._outerRef;"number"==typeof t&&(a.scrollLeft=t),"number"==typeof r&&(a.scrollTop=r)}this._callPropsCallbacks()},r.componentDidUpdate=function(){var e=this.props.direction,t=this.state,r=t.scrollLeft,a=t.scrollTop;if(t.scrollUpdateWasRequested&&null!=this._outerRef){var n=this._outerRef;if("rtl"===e)switch(Xn()){case"negative":n.scrollLeft=-r;break;case"positive-ascending":n.scrollLeft=r;break;default:var o=n.clientWidth,i=n.scrollWidth;n.scrollLeft=i-o-r}else n.scrollLeft=Math.max(0,r);n.scrollTop=Math.max(0,a)}this._callPropsCallbacks()},r.componentWillUnmount=function(){null!==this._resetIsScrollingTimeoutId&&Kn(this._resetIsScrollingTimeoutId)},r.render=function(){var e=this.props,t=e.children,r=e.className,n=e.columnCount,o=e.direction,i=e.height,s=e.innerRef,u=e.innerElementType,d=e.innerTagName,h=e.itemData,m=e.itemKey,p=void 0===m?Jn:m,b=e.outerElementType,g=e.outerTagName,f=e.rowCount,_=e.style,y=e.useIsScrolling,E=e.width,O=this.state.isScrolling,S=this._getHorizontalRangeToRender(),v=S[0],C=S[1],w=this._getVerticalRangeToRender(),P=w[0],N=w[1],x=[];if(n>0&&f)for(var j=P;j<=N;j++)for(var R=v;R<=C;R++)x.push(Object(a.createElement)(t,{columnIndex:R,data:h,isScrolling:y?O:void 0,key:p({columnIndex:R,data:h,rowIndex:j}),rowIndex:j,style:this._getItemStyle(j,R)}));var T=l(this.props,this._instanceProps),A=c(this.props,this._instanceProps);return Object(a.createElement)(b||g||"div",{className:r,onScroll:this._onScroll,ref:this._outerRefSetter,style:Un({position:"relative",height:i,width:E,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:o},_)},Object(a.createElement)(u||d||"div",{children:x,ref:s,style:{height:T,pointerEvents:O?"none":void 0,width:A}}))},r._callPropsCallbacks=function(){var e=this.props,t=e.columnCount,r=e.onItemsRendered,a=e.onScroll,n=e.rowCount;if("function"==typeof r&&t>0&&n>0){var o=this._getHorizontalRangeToRender(),i=o[0],s=o[1],l=o[2],c=o[3],u=this._getVerticalRangeToRender(),d=u[0],h=u[1],m=u[2],p=u[3];this._callOnItemsRendered(i,s,d,h,l,c,m,p)}if("function"==typeof a){var b=this.state,g=b.horizontalScrollDirection,f=b.scrollLeft,_=b.scrollTop,y=b.scrollUpdateWasRequested,E=b.verticalScrollDirection;this._callOnScroll(f,_,g,E,y)}},r._getHorizontalRangeToRender=function(){var e=this.props,t=e.columnCount,r=e.overscanColumnCount,a=e.overscanColumnsCount,n=e.overscanCount,s=e.rowCount,l=this.state,c=l.horizontalScrollDirection,u=l.isScrolling,d=l.scrollLeft,h=r||a||n||1;if(0===t||0===s)return[0,0,0,0];var m=o(this.props,d,this._instanceProps),p=i(this.props,m,d,this._instanceProps),b=u&&"backward"!==c?1:Math.max(1,h),g=u&&"forward"!==c?1:Math.max(1,h);return[Math.max(0,m-b),Math.max(0,Math.min(t-1,p+g)),m,p]},r._getVerticalRangeToRender=function(){var e=this.props,t=e.columnCount,r=e.overscanCount,a=e.overscanRowCount,n=e.overscanRowsCount,o=e.rowCount,i=this.state,s=i.isScrolling,l=i.verticalScrollDirection,c=i.scrollTop,u=a||n||r||1;if(0===t||0===o)return[0,0,0,0];var d=p(this.props,c,this._instanceProps),h=b(this.props,d,c,this._instanceProps),m=s&&"backward"!==l?1:Math.max(1,u),g=s&&"forward"!==l?1:Math.max(1,u);return[Math.max(0,d-m),Math.max(0,Math.min(o-1,h+g)),d,h]},t}(a.PureComponent),t.defaultProps={direction:"ltr",itemData:void 0,useIsScrolling:!1},r}var $n=function(e,t){e.children,e.direction,e.height,e.innerTagName,e.outerTagName,e.overscanColumnsCount,e.overscanCount,e.overscanRowsCount,e.width,t.instance};var eo=Zn({getColumnOffset:function(e,t){return t*e.columnWidth},getColumnWidth:function(e,t){return e.columnWidth},getRowOffset:function(e,t){return t*e.rowHeight},getRowHeight:function(e,t){return e.rowHeight},getEstimatedTotalHeight:function(e){var t=e.rowCount;return e.rowHeight*t},getEstimatedTotalWidth:function(e){var t=e.columnCount;return e.columnWidth*t},getOffsetForColumnAndAlignment:function(e,t,r,a,n,o){var i=e.columnCount,s=e.columnWidth,l=e.width,c=Math.max(0,i*s-l),u=Math.min(c,t*s),d=Math.max(0,t*s-l+o+s);switch("smart"===r&&(r=a>=d-l&&a<=u+l?"auto":"center"),r){case"start":return u;case"end":return d;case"center":var h=Math.round(d+(u-d)/2);return h<Math.ceil(l/2)?0:h>c+Math.floor(l/2)?c:h;case"auto":default:return a>=d&&a<=u?a:d>u?d:a<d?d:u}},getOffsetForRowAndAlignment:function(e,t,r,a,n,o){var i=e.rowHeight,s=e.height,l=e.rowCount,c=Math.max(0,l*i-s),u=Math.min(c,t*i),d=Math.max(0,t*i-s+o+i);switch("smart"===r&&(r=a>=d-s&&a<=u+s?"auto":"center"),r){case"start":return u;case"end":return d;case"center":var h=Math.round(d+(u-d)/2);return h<Math.ceil(s/2)?0:h>c+Math.floor(s/2)?c:h;case"auto":default:return a>=d&&a<=u?a:d>u?d:a<d?d:u}},getColumnStartIndexForOffset:function(e,t){var r=e.columnWidth,a=e.columnCount;return Math.max(0,Math.min(a-1,Math.floor(t/r)))},getColumnStopIndexForStartIndex:function(e,t,r){var a=e.columnWidth,n=e.columnCount,o=e.width,i=t*a,s=Math.ceil((o+r-i)/a);return Math.max(0,Math.min(n-1,t+s-1))},getRowStartIndexForOffset:function(e,t){var r=e.rowHeight,a=e.rowCount;return Math.max(0,Math.min(a-1,Math.floor(t/r)))},getRowStopIndexForStartIndex:function(e,t,r){var a=e.rowHeight,n=e.rowCount,o=e.height,i=t*a,s=Math.ceil((o+r-i)/a);return Math.max(0,Math.min(n-1,t+s-1))},initInstanceProps:function(e){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(e){e.columnWidth,e.rowHeight}});var to=function(e){function t(t){var r;return(r=e.call(this,t)||this).renderHeaderRow=r.renderHeaderRow.bind(Dn()(r)),r.renderFrozenRow=r.renderFrozenRow.bind(Dn()(r)),r._setRef=r._setRef.bind(Dn()(r)),r}qn()(t,e);var r=t.prototype;return r.scrollTo=function(e){this.headerRef&&(this.headerRef.scrollLeft=e)},r.renderHeaderRow=function(e,t){var r=this.props,a=r.columns,n=r.headerRenderer;return e<=0?null:n({style:{width:"100%",height:e},columns:a,headerIndex:t})},r.renderFrozenRow=function(e,t){var r=this.props,a=r.columns,n=r.rowHeight;return(0,r.rowRenderer)({style:{width:"100%",height:n},columns:a,rowData:e,rowIndex:-t-1})},r.render=function(){var e=this.props,t=e.className,r=e.width,a=e.height,o=e.rowWidth,i=e.headerHeight,s=e.frozenData;if(a<=0)return null;var l={width:r,height:a,position:"relative",overflow:"hidden"},c={width:o,height:a},u=Array.isArray(i)?i:[i];return n.a.createElement("div",{role:"grid",ref:this._setRef,className:t,style:l},n.a.createElement("div",{role:"rowgroup",style:c},u.map(this.renderHeaderRow),s.map(this.renderFrozenRow)))},r._setRef=function(e){this.headerRef=e},t}(n.a.PureComponent);to.propTypes={className:Hn.a.string,width:Hn.a.number.isRequired,height:Hn.a.number.isRequired,headerHeight:Hn.a.oneOfType([Hn.a.number,Hn.a.arrayOf(Hn.a.number)]).isRequired,rowWidth:Hn.a.number.isRequired,rowHeight:Hn.a.number.isRequired,columns:Hn.a.arrayOf(Hn.a.object).isRequired,data:Hn.a.arrayOf(Hn.a.object).isRequired,frozenData:Hn.a.arrayOf(Hn.a.object),headerRenderer:Hn.a.func.isRequired,rowRenderer:Hn.a.func.isRequired};var ro=to,ao=function(e){function t(t){var r;return(r=e.call(this,t)||this)._setHeaderRef=r._setHeaderRef.bind(Dn()(r)),r._setBodyRef=r._setBodyRef.bind(Dn()(r)),r._itemKey=r._itemKey.bind(Dn()(r)),r._handleItemsRendered=r._handleItemsRendered.bind(Dn()(r)),r.renderRow=r.renderRow.bind(Dn()(r)),r}qn()(t,e);var r=t.prototype;return r.forceUpdateTable=function(){this.headerRef&&this.headerRef.forceUpdate(),this.bodyRef&&this.bodyRef.forceUpdate()},r.scrollToPosition=function(e){this.headerRef&&this.headerRef.scrollTo(e.scrollLeft),this.bodyRef&&this.bodyRef.scrollTo(e)},r.scrollToTop=function(e){this.bodyRef&&this.bodyRef.scrollTo({scrollTop:e})},r.scrollToLeft=function(e){this.headerRef&&this.headerRef.scrollTo(e),this.bodyRef&&this.bodyRef.scrollToPosition({scrollLeft:e})},r.scrollToRow=function(e,t){void 0===e&&(e=0),void 0===t&&(t="auto"),this.bodyRef&&this.bodyRef.scrollToItem({rowIndex:e,columnIndex:0,align:t})},r.renderRow=function(e){var t=this.props,r=t.data,a=t.columns,n=t.rowRenderer,o=r[e.rowIndex];return n(An()({},e,{columns:a,rowData:o}))},r.render=function(){var e=this.props,t=e.containerStyle,r=e.classPrefix,a=e.className,o=e.data,i=e.frozenData,s=e.width,l=e.height,c=e.rowHeight,u=e.headerWidth,d=e.bodyWidth,h=e.useIsScrolling,m=e.onScroll,p=e.hoveredRowKey,b=e.overscanRowCount,g=(e.style,e.onScrollbarPresenceChange,Rn()(e,["containerStyle","classPrefix","className","data","frozenData","width","height","rowHeight","headerWidth","bodyWidth","useIsScrolling","onScroll","hoveredRowKey","overscanRowCount","style","onScrollbarPresenceChange"])),f=this._getHeaderHeight(),_=i.length,y=c*_,E=D()(r+"__table",a),O=t?{style:t}:null;return n.a.createElement("div",kn()({role:"table",className:E},O),n.a.createElement(eo,kn()({},g,{className:r+"__body",ref:this._setBodyRef,data:o,itemKey:this._itemKey,frozenData:i,width:s,height:Math.max(l-f-y,0),rowHeight:c,rowCount:o.length,overscanRowCount:b,columnWidth:d,columnCount:1,overscanColumnCount:0,useIsScrolling:h,hoveredRowKey:p,onScroll:m,onItemsRendered:this._handleItemsRendered,children:this.renderRow})),f+y>0&&n.a.createElement(ro,kn()({},g,{className:r+"__header",ref:this._setHeaderRef,data:o,frozenData:i,width:s,height:Math.min(f+y,l),rowWidth:u,rowHeight:c,headerHeight:this.props.headerHeight,headerRenderer:this.props.headerRenderer,rowRenderer:this.props.rowRenderer,hoveredRowKey:_>0?p:null})))},r._setHeaderRef=function(e){this.headerRef=e},r._setBodyRef=function(e){this.bodyRef=e},r._itemKey=function(e){var t=e.rowIndex,r=this.props,a=r.data,n=r.rowKey;return a[t][n]},r._getHeaderHeight=function(){var e=this.props.headerHeight;return Array.isArray(e)?e.reduce((function(e,t){return e+t}),0):e},r._handleItemsRendered=function(e){var t=e.overscanRowStartIndex,r=e.overscanRowStopIndex,a=e.visibleRowStartIndex,n=e.visibleRowStopIndex;this.props.onRowsRendered({overscanStartIndex:t,overscanStopIndex:r,startIndex:a,stopIndex:n})},t}(n.a.PureComponent);ao.propTypes={containerStyle:Hn.a.object,classPrefix:Hn.a.string,className:Hn.a.string,width:Hn.a.number.isRequired,height:Hn.a.number.isRequired,headerHeight:Hn.a.oneOfType([Hn.a.number,Hn.a.arrayOf(Hn.a.number)]).isRequired,headerWidth:Hn.a.number.isRequired,bodyWidth:Hn.a.number.isRequired,rowHeight:Hn.a.number.isRequired,columns:Hn.a.arrayOf(Hn.a.object).isRequired,data:Hn.a.arrayOf(Hn.a.object).isRequired,rowKey:Hn.a.oneOfType([Hn.a.string,Hn.a.number]).isRequired,frozenData:Hn.a.arrayOf(Hn.a.object),useIsScrolling:Hn.a.bool,overscanRowCount:Hn.a.number,hoveredRowKey:Hn.a.oneOfType([Hn.a.string,Hn.a.number]),style:Hn.a.object,onScrollbarPresenceChange:Hn.a.func,onScroll:Hn.a.func,onRowsRendered:Hn.a.func,headerRenderer:Hn.a.func.isRequired,rowRenderer:Hn.a.func.isRequired};var no,oo=ao;function io(e,t){return n.a.isValidElement(e)?n.a.cloneElement(e,t):"function"==typeof e?e.prototype&&e.prototype.isReactComponent?n.a.createElement(e,t):e.defaultProps?e(An()({},e.defaultProps,t)):e(t):null}function so(e){var t=[];return n.a.Children.forEach(e,(function(e){if(n.a.isValidElement(e)&&e.key){var r=An()({},e.props,{key:e.key});t.push(r)}})),t}function lo(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return"function"==typeof e?e.apply(void 0,r):e}function co(e){return Array.isArray(e)?[].concat(e):[]}function uo(){}var ho=function(e){var t=e.className,r=e.style,a=e.columns,o=e.headerIndex,i=e.cellRenderer,s=e.headerRenderer,l=e.expandColumnKey,c=e.expandIcon,u=e.tagName,d=Rn()(e,["className","style","columns","headerIndex","cellRenderer","headerRenderer","expandColumnKey","expandIcon","tagName"]),h=a.map((function(e,t){return i({columns:a,column:e,columnIndex:t,headerIndex:o,expandIcon:e.key===l&&n.a.createElement(c,null)})}));return s&&(h=io(s,{cells:h,columns:a,headerIndex:o})),n.a.createElement(u,kn()({},d,{className:t,style:r}),h)};ho.defaultProps={tagName:"div"},ho.propTypes={isScrolling:Hn.a.bool,className:Hn.a.string,style:Hn.a.object,columns:Hn.a.arrayOf(Hn.a.object).isRequired,headerIndex:Hn.a.number,cellRenderer:Hn.a.func,headerRenderer:Hn.a.oneOfType([Hn.a.func,Hn.a.element]),expandColumnKey:Hn.a.string,expandIcon:Hn.a.func,tagName:Hn.a.elementType};var mo=ho,po=function(e){function t(t){var r;return(r=e.call(this,t)||this)._handleExpand=r._handleExpand.bind(Dn()(r)),r}qn()(t,e);var r=t.prototype;return r.render=function(){var e=this.props,t=e.isScrolling,r=e.className,a=e.style,o=e.columns,i=e.rowIndex,s=e.rowData,l=e.expandColumnKey,c=e.depth,u=e.rowEventHandlers,d=e.rowRenderer,h=e.cellRenderer,m=e.expandIconRenderer,p=e.tagName,b=(e.rowKey,e.onRowHover,e.onRowExpand,Rn()(e,["isScrolling","className","style","columns","rowIndex","rowData","expandColumnKey","depth","rowEventHandlers","rowRenderer","cellRenderer","expandIconRenderer","tagName","rowKey","onRowHover","onRowExpand"])),g=m({rowData:s,rowIndex:i,depth:c,onExpand:this._handleExpand}),f=o.map((function(e,r){return h({isScrolling:t,columns:o,column:e,columnIndex:r,rowData:s,rowIndex:i,expandIcon:e.key===l&&g})}));d&&(f=io(d,{isScrolling:t,cells:f,columns:o,rowData:s,rowIndex:i,depth:c}));var _=this._getEventHandlers(u);return n.a.createElement(p,kn()({},b,{className:r,style:a},_),f)},r._handleExpand=function(e){var t=this.props,r=t.onRowExpand,a=t.rowData,n=t.rowIndex,o=t.rowKey;r&&r({expanded:e,rowData:a,rowIndex:n,rowKey:o})},r._getEventHandlers=function(e){void 0===e&&(e={});var t=this.props,r=t.rowData,a=t.rowIndex,n=t.rowKey,o=t.onRowHover,i={};if(Object.keys(e).forEach((function(t){var o=e[t];"function"==typeof o&&(i[t]=function(e){o({rowData:r,rowIndex:a,rowKey:n,event:e})})})),o){var s=i.onMouseEnter;i.onMouseEnter=function(e){o({hovered:!0,rowData:r,rowIndex:a,rowKey:n,event:e}),s&&s(e)};var l=i.onMouseLeave;i.onMouseLeave=function(e){o({hovered:!1,rowData:r,rowIndex:a,rowKey:n,event:e}),l&&l(e)}}return i},t}(n.a.PureComponent);po.defaultProps={tagName:"div"},po.propTypes={isScrolling:Hn.a.bool,className:Hn.a.string,style:Hn.a.object,columns:Hn.a.arrayOf(Hn.a.object).isRequired,rowData:Hn.a.object.isRequired,rowIndex:Hn.a.number.isRequired,rowKey:Hn.a.oneOfType([Hn.a.string,Hn.a.number]),expandColumnKey:Hn.a.string,depth:Hn.a.number,rowEventHandlers:Hn.a.object,rowRenderer:Hn.a.oneOfType([Hn.a.func,Hn.a.element]),cellRenderer:Hn.a.func,expandIconRenderer:Hn.a.func,onRowHover:Hn.a.func,onRowExpand:Hn.a.func,tagName:Hn.a.elementType};var bo=po,go=function(e){var t=e.className,r=e.column;e.columnIndex;return n.a.createElement("div",{className:t},r.title)};go.propTypes={className:Hn.a.string,column:Hn.a.object,columnIndex:Hn.a.number};var fo=go,_o=function(e){var t=e.className,r=e.cellData;e.column,e.columnIndex,e.rowData,e.rowIndex;return n.a.createElement("div",{className:t},n.a.isValidElement(r)?r:function(e){return"string"==typeof e?e:null==e?"":e.toString?e.toString():""}(r))};_o.propTypes={className:Hn.a.string,cellData:Hn.a.any,column:Hn.a.object,columnIndex:Hn.a.number,rowData:Hn.a.object,rowIndex:Hn.a.number};var yo=_o,Eo={LEFT:"left",CENTER:"center",RIGHT:"right"},Oo={LEFT:"left",RIGHT:"right",DEFAULT:!0,NONE:!1},So=function(e){function t(){return e.apply(this,arguments)||this}return qn()(t,e),t}(n.a.Component);So.propTypes={className:Hn.a.oneOfType([Hn.a.string,Hn.a.func]),headerClassName:Hn.a.oneOfType([Hn.a.string,Hn.a.func]),style:Hn.a.object,title:Hn.a.string,dataKey:Hn.a.string,dataGetter:Hn.a.func,align:Hn.a.oneOf(["left","center","right"]),flexGrow:Hn.a.number,flexShrink:Hn.a.number,width:Hn.a.number.isRequired,maxWidth:Hn.a.number,minWidth:Hn.a.number,frozen:Hn.a.oneOf(["left","right",!0,!1]),hidden:Hn.a.bool,resizable:Hn.a.bool,sortable:Hn.a.bool,cellRenderer:Hn.a.oneOfType([Hn.a.func,Hn.a.element]),headerRenderer:Hn.a.oneOfType([Hn.a.func,Hn.a.element])},So.Alignment=Eo,So.FrozenDirection=Oo;var vo=So,Co={ASC:"asc",DESC:"desc"},wo=function(e){function t(t){var r;return(r=e.call(this,t)||this)._handleClick=r._handleClick.bind(Dn()(r)),r}qn()(t,e);var r=t.prototype;return r.render=function(){var e=this.props,t=e.expandable,r=e.expanded,a=e.indentSize,o=e.depth,i=e.onExpand,s=Rn()(e,["expandable","expanded","indentSize","depth","onExpand"]);if(!t&&0===a)return null;var l=D()("BaseTable__expand-icon",{"BaseTable__expand-icon--expanded":r});return n.a.createElement("div",kn()({},s,{className:l,onClick:t&&i?this._handleClick:null,style:{fontFamily:"initial",cursor:"pointer",userSelect:"none",width:"16px",minWidth:"16px",height:"16px",lineHeight:"16px",fontSize:"16px",textAlign:"center",transition:"transform 0.15s ease-out",transform:"rotate("+(t&&r?90:0)+"deg)",marginLeft:o*a}}),t&&"")},r._handleClick=function(e){e.stopPropagation(),e.preventDefault();var t=this.props;(0,t.onExpand)(!t.expanded)},t}(n.a.PureComponent);wo.defaultProps={depth:0,indentSize:16},wo.propTypes={expandable:Hn.a.bool,expanded:Hn.a.bool,indentSize:Hn.a.number,depth:Hn.a.number,onExpand:Hn.a.func};var Po=wo,No=function(e){var t=e.sortOrder,r=e.className,a=e.style,o=D()("BaseTable__sort-indicator",r,{"BaseTable__sort-indicator--descending":t===Co.DESC});return n.a.createElement("div",{className:o,style:An()({userSelect:"none",width:"16px",height:"16px",lineHeight:"16px",textAlign:"center"},a)},t===Co.DESC?"":"")};No.propTypes={sortOrder:Hn.a.oneOf([Co.ASC,Co.DESC]),className:Hn.a.string,style:Hn.a.object};var xo=No;function jo(e){if(e){var t,r,a=e.getElementById("react-draggable-style-el");a||((a=e.createElement("style")).type="text/css",a.id="react-draggable-style-el",a.innerHTML=".react-draggable-transparent-selection *::-moz-selection {background: transparent;}\n",a.innerHTML+=".react-draggable-transparent-selection *::selection {background: transparent;}\n",e.getElementsByTagName("head")[0].appendChild(a)),e.body&&(t=e.body,r="react-draggable-transparent-selection",t.classList?t.classList.add(r):t.className.match(new RegExp("(?:^|\\s)"+r+"(?!\\S)"))||(t.className+=" "+r))}}function Ro(e){try{e&&e.body&&(t=e.body,r="react-draggable-transparent-selection",t.classList?t.classList.remove(r):t.className=t.className.replace(new RegExp("(?:^|\\s)"+r+"(?!\\S)","g"),"")),e.selection?e.selection.empty():window.getSelection().removeAllRanges()}catch(e){}var t,r}var To=function(e){function t(t){var r;return(r=e.call(this,t)||this).isDragging=!1,r.lastX=null,r.width=0,r._setHandleRef=r._setHandleRef.bind(Dn()(r)),r._handleClick=r._handleClick.bind(Dn()(r)),r._handleMouseDown=r._handleMouseDown.bind(Dn()(r)),r._handleMouseUp=r._handleMouseUp.bind(Dn()(r)),r._handleMouseMove=r._handleMouseMove.bind(Dn()(r)),r}qn()(t,e);var r=t.prototype;return r.componentWillMount=function(){if(this.handleRef){var e=this.handleRef.ownerDocument;e.removeEventListener("mousemove",this._handleMouseMove),e.addEventListener("mouseup",this._handleMouseUp),Ro(e)}},r.render=function(){var e=this.props,t=e.style,r=(e.column,e.onResizeStart,e.onResize,e.onResizeStop,e.minWidth,Rn()(e,["style","column","onResizeStart","onResize","onResizeStop","minWidth"]));return n.a.createElement("div",kn()({},r,{ref:this._setHandleRef,onClick:this._handleClick,onMouseDown:this._handleMouseDown,onMouseUp:this._handleMouseUp,style:An()({userSelect:"none",touchAction:"none",position:"absolute",top:0,bottom:0,right:0,cursor:"col-resize"},t)}))},r._setHandleRef=function(e){this.handleRef=e},r._handleClick=function(e){e.stopPropagation()},r._handleMouseDown=function(e){if("number"!=typeof e.button||0===e.button){this.isDragging=!0,this.lastX=null,this.width=this.props.column.width,this.props.onResizeStart(this.props.column);var t=this.handleRef.ownerDocument;jo(t),t.addEventListener("mousemove",this._handleMouseMove),t.addEventListener("mouseup",this._handleMouseUp)}},r._handleMouseUp=function(e){if(this.isDragging){this.isDragging=!1,this.props.onResizeStop(this.props.column);var t=this.handleRef.ownerDocument;Ro(t),t.removeEventListener("mousemove",this._handleMouseMove),t.addEventListener("mouseup",this._handleMouseUp)}},r._handleMouseMove=function(e){var t=this.handleRef.offsetParent,r=t.getBoundingClientRect(),a=e.clientX+t.scrollLeft-r.left;if(null!==this.lastX){var n=this.props,o=n.column,i=n.minWidth,s=o.width,l=o.maxWidth,c=o.minWidth,u=void 0===c?i:c,d=a-this.lastX;if(d){this.width=this.width+d,this.lastX=a;var h=this.width;l&&h>l?h=l:h<u&&(h=u),h!==s&&this.props.onResize(o,h)}}else this.lastX=a},t}(n.a.PureComponent);To.defaultProps={onResizeStart:uo,onResize:uo,onResizeStop:uo,minWidth:30},To.propTypes={style:Hn.a.object,column:Hn.a.object,onResizeStart:Hn.a.func,onResize:Hn.a.func,onResizeStop:Hn.a.func,minWidth:Hn.a.number};var Ao=To,Io=function(){function e(e,t){this._origColumns=[],this.reset(e,t)}var t=e.prototype;return t._cache=function(e,t){return e in this._cached?this._cached[e]:(this._cached[e]=t(),this._cached[e])},t.reset=function(e,t){var r=this;this._columns=e.map((function(e){var t=e.width;if(e.resizable){var a=r._origColumns.findIndex((function(t){return t.key===e.key}));a>=0&&r._origColumns[a].width===e.width&&(t=r._columns[a].width)}return An()({},e,{width:t})})),this._origColumns=e,this._fixed=t,this._cached={},this._columnStyles=this.recomputeColumnStyles()},t.resetCache=function(){this._cached={}},t.getOriginalColumns=function(){return this._origColumns},t.getColumns=function(){return this._columns},t.getVisibleColumns=function(){var e=this;return this._cache("visibleColumns",(function(){return e._columns.filter((function(e){return!e.hidden}))}))},t.hasFrozenColumns=function(){var e=this;return this._cache("hasFrozenColumns",(function(){return e._fixed&&e.getVisibleColumns().some((function(e){return!!e.frozen}))}))},t.hasLeftFrozenColumns=function(){var e=this;return this._cache("hasLeftFrozenColumns",(function(){return e._fixed&&e.getVisibleColumns().some((function(e){return e.frozen===Oo.LEFT||!0===e.frozen}))}))},t.hasRightFrozenColumns=function(){var e=this;return this._cache("hasRightFrozenColumns",(function(){return e._fixed&&e.getVisibleColumns().some((function(e){return e.frozen===Oo.RIGHT}))}))},t.getMainColumns=function(){var t=this;return this._cache("mainColumns",(function(){var r=t.getVisibleColumns();if(!t.hasFrozenColumns())return r;var a=[];return t.getLeftFrozenColumns().forEach((function(t){var r;a.push(An()({},t,((r={})[e.PlaceholderKey]=!0,r)))})),t.getVisibleColumns().forEach((function(e){e.frozen||a.push(e)})),t.getRightFrozenColumns().forEach((function(t){var r;a.push(An()({},t,((r={})[e.PlaceholderKey]=!0,r)))})),a}))},t.getLeftFrozenColumns=function(){var e=this;return this._cache("leftFrozenColumns",(function(){return e._fixed?e.getVisibleColumns().filter((function(e){return e.frozen===Oo.LEFT||!0===e.frozen})):[]}))},t.getRightFrozenColumns=function(){var e=this;return this._cache("rightFrozenColumns",(function(){return e._fixed?e.getVisibleColumns().filter((function(e){return e.frozen===Oo.RIGHT})):[]}))},t.getColumn=function(e){var t=this._columns.findIndex((function(t){return t.key===e}));return this._columns[t]},t.getColumnsWidth=function(){var e=this;return this._cache("columnsWidth",(function(){return e.recomputeColumnsWidth(e.getVisibleColumns())}))},t.getLeftFrozenColumnsWidth=function(){var e=this;return this._cache("leftFrozenColumnsWidth",(function(){return e.recomputeColumnsWidth(e.getLeftFrozenColumns())}))},t.getRightFrozenColumnsWidth=function(){var e=this;return this._cache("rightFrozenColumnsWidth",(function(){return e.recomputeColumnsWidth(e.getRightFrozenColumns())}))},t.recomputeColumnsWidth=function(e){return e.reduce((function(e,t){return e+t.width}),0)},t.setColumnWidth=function(e,t){var r=this.getColumn(e);r.width=t,this._cached={},this._columnStyles[r.key]=this.recomputeColumnStyle(r)},t.getColumnStyle=function(e){return this._columnStyles[e]},t.getColumnStyles=function(){return this._columnStyles},t.recomputeColumnStyle=function(e){var t=0,r=0;this._fixed||(t="number"==typeof e.flexGrow?e.flexGrow:0,r="number"==typeof e.flexShrink?e.flexShrink:1);var a=t+" "+r+" auto",n=An()({},e.style,{flex:a,msFlex:a,WebkitFlex:a,width:e.width,overflow:"hidden"});return!this._fixed&&e.maxWidth&&(n.maxWidth=e.maxWidth),!this._fixed&&e.minWidth&&(n.minWidth=e.minWidth),n},t.recomputeColumnStyles=function(){var e=this;return this._columns.reduce((function(t,r){return t[r.key]=e.recomputeColumnStyle(r),t}),{})},e}();Io.PlaceholderKey="__placeholder__";var ko=function(e,t,r){return{width:e,maxWidth:t,height:r,overflow:"hidden"}},Fo={TableCell:yo,TableHeaderCell:fo,ExpandIcon:Po,SortIndicator:xo},Do=function(e){function t(t){var r;r=e.call(this,t)||this;var a,n,o,i,s,l=t.columns,c=t.children,u=t.expandedRowKeys,d=t.defaultExpandedRowKeys;return r.state={scrollbarSize:0,hoveredRowKey:null,resizingKey:null,resizingWidth:0,expandedRowKeys:co(void 0!==t.expandedRowKeys?u:d)},r.columnManager=new Io(l||so(c),t.fixed),r._setContainerRef=r._setContainerRef.bind(Dn()(r)),r._setMainTableRef=r._setMainTableRef.bind(Dn()(r)),r._setLeftTableRef=r._setLeftTableRef.bind(Dn()(r)),r._setRightTableRef=r._setRightTableRef.bind(Dn()(r)),r.renderExpandIcon=r.renderExpandIcon.bind(Dn()(r)),r.renderRow=r.renderRow.bind(Dn()(r)),r.renderRowCell=r.renderRowCell.bind(Dn()(r)),r.renderHeader=r.renderHeader.bind(Dn()(r)),r.renderHeaderCell=r.renderHeaderCell.bind(Dn()(r)),r._handleScroll=r._handleScroll.bind(Dn()(r)),r._handleVerticalScroll=r._handleVerticalScroll.bind(Dn()(r)),r._handleRowsRendered=r._handleRowsRendered.bind(Dn()(r)),r._handleRowHover=r._handleRowHover.bind(Dn()(r)),r._handleRowExpand=r._handleRowExpand.bind(Dn()(r)),r._handleColumnResize=(a=r._handleColumnResize.bind(Dn()(r)),n=50,function(){var e=this,t=arguments;o?(clearTimeout(i),i=setTimeout((function(){Date.now()-s>=n&&(a.apply(e,t),s=Date.now())}),Math.max(n-(Date.now()-s),0))):(a.apply(e,t),s=Date.now(),o=!0)}),r._handleColumnResizeStart=r._handleColumnResizeStart.bind(Dn()(r)),r._handleColumnResizeStop=r._handleColumnResizeStop.bind(Dn()(r)),r._handleColumnSort=r._handleColumnSort.bind(Dn()(r)),r._getLeftTableContainerStyle=Object(zn.a)(ko),r._getRightTableContainerStyle=Object(zn.a)(ko),r._flattenOnKeys=Object(zn.a)((function(e,t,a){return r._depthMap={},function(e,t,r,a){if(void 0===r&&(r={}),void 0===a&&(a="id"),!t||!t.length)return e;var n=[],o=new Set;t.forEach((function(e){return o.add(e)}));var i=[].concat(e);i.forEach((function(e){return r[e[a]]=0}));for(var s=function(){var e=i.shift();n.push(e),o.has(e[a])&&Array.isArray(e.children)&&e.children.length>0&&(i=[].concat(e.children,i),e.children.forEach((function(t){return r[t[a]]=r[e[a]]+1})))};i.length>0;)s();return n}(e,t,r._depthMap,a)})),r._scroll={scrollLeft:0,scrollTop:0},r._scrollHeight=0,r._lastScannedRowIndex=-1,r._hasDataChangedSinceEndReached=!0,r._data=t.data,r._depthMap={},r._horizontalScrollbarSize=0,r._verticalScrollbarSize=0,r._scrollbarPresenceChanged=!1,r}qn()(t,e);var r=t.prototype;return r.getDOMNode=function(){return this.tableNode},r.getColumnManager=function(){return this.columnManager},r.getExpandedState=function(){return{expandedData:this._data,expandedRowKeys:this.state.expandedRowKeys,expandedDepthMap:this._depthMap}},r.getTotalRowsHeight=function(){return this._data.length*this.props.rowHeight},r.getTotalColumnsWidth=function(){return this.columnManager.getColumnsWidth()},r.forceUpdateTable=function(){this.table&&this.table.forceUpdateTable(),this.leftTable&&this.leftTable.forceUpdateTable(),this.rightTable&&this.rightTable.forceUpdateTable()},r.scrollToPosition=function(e){this._scroll=e,this.table&&this.table.scrollToPosition(e),this.leftTable&&this.leftTable.scrollToTop(e.scrollTop),this.rightTable&&this.rightTable.scrollToTop(e.scrollTop)},r.scrollToTop=function(e){this._scroll.scrollTop=e,this.table&&this.table.scrollToPosition(this._scroll),this.leftTable&&this.leftTable.scrollToTop(e),this.rightTable&&this.rightTable.scrollToTop(e)},r.scrollToLeft=function(e){this._scroll.scrollLeft=e,this.table&&this.table.scrollToPosition(this._scroll)},r.scrollToRow=function(e,t){void 0===e&&(e=0),void 0===t&&(t="auto"),this.table&&this.table.scrollToRow(e,t),this.leftTable&&this.leftTable.scrollToRow(e,t),this.rightTable&&this.rightTable.scrollToRow(e,t),this.scrollToLeft(0)},r.setExpandedRowKeys=function(e){void 0===this.props.expandedRowKeys&&this.setState({expandedRowKeys:co(e)})},r.renderExpandIcon=function(e){var t=e.rowData,r=e.rowIndex,a=e.depth,o=e.onExpand,i=this.props,s=i.rowKey,l=i.expandColumnKey,c=i.expandIconProps;if(!l)return null;var u,d=r>=0&&(u=t,Array.isArray(u.children)&&u.children.length>0),h=r>=0&&this.state.expandedRowKeys.indexOf(t[s])>=0,m=lo(c,{rowData:t,rowIndex:r,depth:a,expandable:d,expanded:h}),p=this._getComponent("ExpandIcon");return n.a.createElement(p,kn()({depth:a,expandable:d,expanded:h},m,{onExpand:o}))},r.renderRow=function(e){var t,r=e.isScrolling,a=e.columns,o=e.rowData,i=e.rowIndex,s=e.style,l=this.props,c=l.rowClassName,u=l.rowRenderer,d=l.rowEventHandlers,h=l.expandColumnKey,m=lo(c,{columns:a,rowData:o,rowIndex:i}),p=lo(this.props.rowProps,{columns:a,rowData:o,rowIndex:i}),b=o[this.props.rowKey],g=this._depthMap[b]||0,f=D()(this._prefixClass("row"),m,((t={})[this._prefixClass("row--depth-"+g)]=!!h&&i>=0,t[this._prefixClass("row--expanded")]=!!h&&this.state.expandedRowKeys.indexOf(b)>=0,t[this._prefixClass("row--hovered")]=!r&&b===this.state.hoveredRowKey,t[this._prefixClass("row--frozen")]=0===g&&i<0,t[this._prefixClass("row--customized")]=u,t)),_=An()({},p,{role:"row",key:"row-"+b,isScrolling:r,className:f,style:s,columns:a,rowIndex:i,rowData:o,rowKey:b,expandColumnKey:h,depth:g,rowEventHandlers:d,rowRenderer:u,cellRenderer:this.renderRowCell,expandIconRenderer:this.renderExpandIcon,onRowExpand:this._handleRowExpand,onRowHover:this.columnManager.hasFrozenColumns()?this._handleRowHover:null});return n.a.createElement(bo,_)},r.renderRowCell=function(e){var t,r=e.isScrolling,a=e.columns,o=e.column,i=e.columnIndex,s=e.rowData,l=e.rowIndex,c=e.expandIcon;if(o[Io.PlaceholderKey])return n.a.createElement("div",{key:"row-"+s[this.props.rowKey]+"-cell-"+o.key+"-placeholder",className:this._prefixClass("row-cell-placeholder"),style:this.columnManager.getColumnStyle(o.key)});var u=o.className,d=o.dataKey,h=o.dataGetter,m=o.cellRenderer,p=this._getComponent("TableCell"),b=h?h({columns:a,column:o,columnIndex:i,rowData:s,rowIndex:l}):function(e,t,r){if(null===e||"object"!=typeof e||"string"!=typeof t)return r;for(var a=function(e){for(var t=e.split("."),r=[],a=0;a<t.length;a++){for(var n=t[a];"\\"===n[n.length-1]&&void 0!==t[a+1];)n=n.slice(0,-1)+".",n+=t[++a];r.push(n)}return r}(t),n=0;n<a.length;n++){if(!Object.prototype.propertyIsEnumerable.call(e,a[n]))return r;if(null==(e=e[a[n]])){if(n!==a.length-1)return r;break}}return e}(s,d),g={isScrolling:r,cellData:b,columns:a,column:o,columnIndex:i,rowData:s,rowIndex:l,container:this},f=io(m||n.a.createElement(p,{className:this._prefixClass("row-cell-text")}),g),_=lo(u,{cellData:b,columns:a,column:o,columnIndex:i,rowData:s,rowIndex:l}),y=D()(this._prefixClass("row-cell"),_,((t={})[this._prefixClass("row-cell--align-center")]=o.align===Eo.CENTER,t[this._prefixClass("row-cell--align-right")]=o.align===Eo.RIGHT,t)),E=lo(this.props.cellProps,{columns:a,column:o,columnIndex:i,rowData:s,rowIndex:l})||{},O=E.tagName,S=Rn()(E,["tagName"]),v=O||"div";return n.a.createElement(v,kn()({role:"gridcell",key:"row-"+s[this.props.rowKey]+"-cell-"+o.key},S,{className:y,style:this.columnManager.getColumnStyle(o.key)}),c,f)},r.renderHeader=function(e){var t,r=e.columns,a=e.headerIndex,o=e.style,i=this.props,s=i.headerClassName,l=i.headerRenderer,c=lo(s,{columns:r,headerIndex:a}),u=lo(this.props.headerProps,{columns:r,headerIndex:a}),d=D()(this._prefixClass("header-row"),c,((t={})[this._prefixClass("header-row--resizing")]=!!this.state.resizingKey,t[this._prefixClass("header-row--customized")]=l,t)),h=An()({},u,{role:"row",key:"header-"+a,className:d,style:o,columns:r,headerIndex:a,headerRenderer:l,cellRenderer:this.renderHeaderCell,expandColumnKey:this.props.expandColumnKey,expandIcon:this._getComponent("ExpandIcon")});return n.a.createElement(mo,h)},r.renderHeaderCell=function(e){var t,r,a=e.columns,o=e.column,i=e.columnIndex,s=e.headerIndex,l=e.expandIcon;if(o[Io.PlaceholderKey])return n.a.createElement("div",{key:"header-"+s+"-cell-"+o.key+"-placeholder",className:this._prefixClass("header-cell-placeholder"),style:this.columnManager.getColumnStyle(o.key)});var c,u,d=o.headerClassName,h=o.headerRenderer,m=this.props,p=m.sortBy,b=m.sortState,g=m.headerCellProps,f=this._getComponent("TableHeaderCell"),_=this._getComponent("SortIndicator"),y={columns:a,column:o,columnIndex:i,headerIndex:s,container:this},E=io(h||n.a.createElement(f,{className:this._prefixClass("header-cell-text")}),y);if(b){var O=b[o.key];u=(c=O===Co.ASC||O===Co.DESC)?O:Co.ASC}else u=(c=o.key===p.key)?p.order:Co.ASC;var S=lo(d,{columns:a,column:o,columnIndex:i,headerIndex:s}),v=D()(this._prefixClass("header-cell"),S,((t={})[this._prefixClass("header-cell--align-center")]=o.align===Eo.CENTER,t[this._prefixClass("header-cell--align-right")]=o.align===Eo.RIGHT,t[this._prefixClass("header-cell--sortable")]=o.sortable,t[this._prefixClass("header-cell--sorting")]=c,t[this._prefixClass("header-cell--resizing")]=o.key===this.state.resizingKey,t)),C=lo(g,{columns:a,column:o,columnIndex:i,headerIndex:s})||{},w=C.tagName,P=Rn()(C,["tagName"]),N=w||"div";return n.a.createElement(N,kn()({role:"gridcell",key:"header-"+s+"-cell-"+o.key,onClick:o.sortable?this._handleColumnSort:null},P,{className:v,style:this.columnManager.getColumnStyle(o.key),"data-key":o.key}),l,E,o.sortable&&n.a.createElement(_,{sortOrder:u,className:D()(this._prefixClass("sort-indicator"),(r={},r[this._prefixClass("sort-indicator--descending")]=u===Co.DESC,r))}),o.resizable&&n.a.createElement(Ao,{className:this._prefixClass("column-resizer"),column:o,onResizeStart:this._handleColumnResizeStart,onResizeStop:this._handleColumnResizeStop,onResize:this._handleColumnResize}))},r.renderMainTable=function(){var e=this.props,t=e.width,r=e.headerHeight,a=e.rowHeight,o=e.fixed,i=Rn()(e,["width","headerHeight","rowHeight","fixed"]),s=this._getTableHeight(),l=t-this._verticalScrollbarSize;if(o){var c=this.columnManager.getColumnsWidth();l=Math.max(Math.round(c),l)}return n.a.createElement(oo,kn()({},i,this.state,{className:this._prefixClass("table-main"),ref:this._setMainTableRef,data:this._data,columns:this.columnManager.getMainColumns(),width:t,height:s,headerHeight:r,rowHeight:a,headerWidth:l+(o?this._verticalScrollbarSize:0),bodyWidth:l,headerRenderer:this.renderHeader,rowRenderer:this.renderRow,onScroll:this._handleScroll,onRowsRendered:this._handleRowsRendered}))},r.renderLeftTable=function(){if(!this.columnManager.hasLeftFrozenColumns())return null;var e=this.props,t=e.width,r=e.headerHeight,a=e.rowHeight,o=Rn()(e,["width","headerHeight","rowHeight"]),i=this._getFrozenContainerHeight(),s=this._verticalScrollbarSize||20,l=this.columnManager.getLeftFrozenColumnsWidth();return n.a.createElement(oo,kn()({},o,this.state,{containerStyle:this._getLeftTableContainerStyle(l,t,i),className:this._prefixClass("table-frozen-left"),ref:this._setLeftTableRef,data:this._data,columns:this.columnManager.getLeftFrozenColumns(),width:l+s,height:i,headerHeight:r,rowHeight:a,headerWidth:l+s,bodyWidth:l+s,headerRenderer:this.renderHeader,rowRenderer:this.renderRow,onScroll:this._handleVerticalScroll,onRowsRendered:uo}))},r.renderRightTable=function(){if(!this.columnManager.hasRightFrozenColumns())return null;var e=this.props,t=e.width,r=e.headerHeight,a=e.rowHeight,o=Rn()(e,["width","headerHeight","rowHeight"]),i=this._getFrozenContainerHeight(),s=this.columnManager.getRightFrozenColumnsWidth(),l=this._verticalScrollbarSize;return n.a.createElement(oo,kn()({},o,this.state,{containerStyle:this._getLeftTableContainerStyle(s+l,t,i),className:this._prefixClass("table-frozen-right"),ref:this._setRightTableRef,data:this._data,columns:this.columnManager.getRightFrozenColumns(),width:s+l,height:i,headerHeight:r,rowHeight:a,headerWidth:s+l,bodyWidth:s,headerRenderer:this.renderHeader,rowRenderer:this.renderRow,onScroll:this._handleVerticalScroll,onRowsRendered:uo}))},r.renderResizingLine=function(){var e=this.props,t=e.width,r=e.fixed,a=this.state.resizingKey;if(!r||!a)return null;var o=this.columnManager.getMainColumns(),i=o.findIndex((function(e){return e.key===a})),s=o[i],l=s.width,c=s.frozen,u=this.columnManager.recomputeColumnsWidth(o.slice(0,i))+l;if(c){if(c===Oo.RIGHT){var d=this.columnManager.recomputeColumnsWidth(o.slice(i+1));u=d+l>t-this._verticalScrollbarSize?l:t-this._verticalScrollbarSize-d}}else u-=this._scroll.scrollLeft;var h={left:u,height:this._getTableHeight()-this._horizontalScrollbarSize};return n.a.createElement("div",{className:this._prefixClass("resizing-line"),style:h})},r.renderFooter=function(){var e=this.props,t=e.footerHeight,r=e.footerRenderer;return 0===t?null:n.a.createElement("div",{className:this._prefixClass("footer"),style:{height:t}},io(r))},r.renderEmptyLayer=function(){var e=this.props,t=e.data,r=e.footerHeight,a=e.emptyRenderer;if(t&&t.length)return null;var o=this._getHeaderHeight();return n.a.createElement("div",{className:this._prefixClass("empty-layer"),style:{top:o,bottom:r}},io(a))},r.renderOverlay=function(){var e=this.props.overlayRenderer;return n.a.createElement("div",{className:this._prefixClass("overlay")},!!e&&io(e))},r.render=function(){var e,t=this.props,r=t.classPrefix,a=t.width,o=t.fixed,i=t.data,s=t.frozenData,l=t.expandColumnKey,c=t.disabled,u=t.className,d=t.style,h=t.footerHeight;this._data=l?this._flattenOnKeys(i,this.state.expandedRowKeys,this.props.rowKey):i,this._calcScrollbarSizes();var m=An()({},d,{width:a,height:this._getTableHeight()+h,position:"relative"}),p=D()(r,u,((e={})[r+"--fixed"]=o,e[r+"--expandable"]=!!l,e[r+"--empty"]=0===i.length,e[r+"--has-frozen-rows"]=s.length>0,e[r+"--has-frozen-columns"]=this.columnManager.hasFrozenColumns(),e[r+"--disabled"]=c,e));return n.a.createElement("div",{ref:this._setContainerRef,className:p,style:m},this.renderFooter(),this.renderMainTable(),this.renderLeftTable(),this.renderRightTable(),this.renderResizingLine(),this.renderEmptyLayer(),this.renderOverlay())},r.componentWillReceiveProps=function(e){var t=e.columns||so(e.children);(function e(t,r){if(t===r)return!0;if(null===t&&null===r)return!0;if(null===t||null===r)return!1;if("object"!=typeof t||"object"!=typeof r)return!1;var a=Object.keys(t),n=Object.keys(r);if(a.length!==n.length)return!1;for(var o=0;o<a.length;o++){var i=a[o],s=t[i],l=r[i];if(typeof s!=typeof l)return!1;if("function"!=typeof s){if("object"==typeof s){if(e(s,l))continue;return!1}if(s!==l)return!1}}return!0})(t,this.columnManager.getOriginalColumns())&&e.fixed===this.props.fixed||this.columnManager.reset(t,e.fixed),e.data!==this.props.data&&(this._lastScannedRowIndex=-1,this._hasDataChangedSinceEndReached=!0),e.maxHeight===this.props.maxHeight&&e.height===this.props.height||this._maybeCallOnEndReached(),e.expandColumnKey&&void 0!==e.expandedRowKeys&&e.expandedRowKeys!==this.props.expandedRowKeys&&this.setState({expandedRowKeys:co(e.expandedRowKeys)})},r.componentDidMount=function(){var e=this.props.getScrollbarSize();e>0&&this.setState({scrollbarSize:e})},r.componentDidUpdate=function(e,t){this._maybeScrollbarPresenceChange()},r._prefixClass=function(e){return this.props.classPrefix+"__"+e},r._setContainerRef=function(e){this.tableNode=e},r._setMainTableRef=function(e){this.table=e},r._setLeftTableRef=function(e){this.leftTable=e},r._setRightTableRef=function(e){this.rightTable=e},r._getComponent=function(e){return this.props.components&&this.props.components[e]?this.props.components[e]:Fo[e]},r._getHeaderHeight=function(){var e=this.props.headerHeight;return Array.isArray(e)?e.reduce((function(e,t){return e+t}),0):e},r._getFrozenRowsHeight=function(){var e=this.props,t=e.frozenData,r=e.rowHeight;return t.length*r},r._getTableHeight=function(){var e=this.props,t=e.height,r=e.maxHeight,a=e.footerHeight,n=t-a;if(r>0){var o=this._getFrozenRowsHeight(),i=this.getTotalRowsHeight(),s=this._getHeaderHeight()+o+i+this._horizontalScrollbarSize;n=Math.min(s,r-a)}return n},r._getBodyHeight=function(){return this._getTableHeight()-this._getHeaderHeight()-this._getFrozenRowsHeight()},r._getFrozenContainerHeight=function(){var e=this.props.maxHeight,t=this._getTableHeight()-(this._data.length>0?this._horizontalScrollbarSize:0);if(e>0)return t;var r=this.getTotalRowsHeight()+this._getHeaderHeight()+this._getFrozenRowsHeight();return Math.min(t,r)},r._calcScrollbarSizes=function(){var e=this.props,t=e.fixed,r=e.width,a=this.state.scrollbarSize,n=this.getTotalRowsHeight(),o=this.getTotalColumnsWidth(),i=this._horizontalScrollbarSize,s=this._verticalScrollbarSize;0===a?(this._horizontalScrollbarSize=0,this._verticalScrollbarSize=0):!t||o<=r-a?(this._horizontalScrollbarSize=0,this._verticalScrollbarSize=n>this._getBodyHeight()?a:0):o>r?(this._horizontalScrollbarSize=a,this._verticalScrollbarSize=n>this._getBodyHeight()-this._horizontalScrollbarSize?a:0):(this._horizontalScrollbarSize=0,this._verticalScrollbarSize=0,n>this._getBodyHeight()&&(this._horizontalScrollbarSize=a,this._verticalScrollbarSize=a)),i===this._horizontalScrollbarSize&&s===this._verticalScrollbarSize||(this._scrollbarPresenceChanged=!0)},r._maybeScrollbarPresenceChange=function(){if(this._scrollbarPresenceChanged){var e=this.props.onScrollbarPresenceChange;this._scrollbarPresenceChanged=!1,e({size:this.state.scrollbarSize,horizontal:this._horizontalScrollbarSize>0,vertical:this._verticalScrollbarSize>0})}},r._maybeCallOnEndReached=function(){var e=this.props,t=e.onEndReached,r=e.onEndReachedThreshold,a=this._scroll.scrollTop,n=this.getTotalRowsHeight(),o=this._getBodyHeight();if(t&&o&&n){var i=n-a-o+this._horizontalScrollbarSize;this._lastScannedRowIndex>=0&&i<=r&&(this._hasDataChangedSinceEndReached||n!==this._scrollHeight)&&(this._hasDataChangedSinceEndReached=!1,this._scrollHeight=n,t({distanceFromEnd:i}))}},r._handleScroll=function(e){var t=this._scroll.scrollTop;this.scrollToPosition(e),this.props.onScroll(e),e.scrollTop>t&&this._maybeCallOnEndReached()},r._handleVerticalScroll=function(e){var t=e.scrollTop,r=this._scroll.scrollTop;this.scrollToTop(t),t>r&&this._maybeCallOnEndReached()},r._handleRowsRendered=function(e){this.props.onRowsRendered(e),e.overscanStopIndex>this._lastScannedRowIndex&&(this._lastScannedRowIndex=e.overscanStopIndex,this._maybeCallOnEndReached())},r._handleRowHover=function(e){var t=e.hovered,r=e.rowKey;this.setState({hoveredRowKey:t?r:null})},r._handleRowExpand=function(e){var t=e.expanded,r=e.rowData,a=e.rowIndex,n=e.rowKey,o=co(this.state.expandedRowKeys);if(t)!o.indexOf(n)>=0&&o.push(n);else{var i=o.indexOf(n);i>-1&&o.splice(i,1)}void 0===this.props.expandedRowKeys&&this.setState({expandedRowKeys:o}),this.props.onRowExpand({expanded:t,rowData:r,rowIndex:a,rowKey:n}),this.props.onExpandedRowsChange(o)},r._handleColumnResize=function(e,t){var r=e.key;this.columnManager.setColumnWidth(r,t),this.setState({resizingWidth:t});var a=this.columnManager.getColumn(r);this.props.onColumnResize({column:a,width:t})},r._handleColumnResizeStart=function(e){var t=e.key;this.setState({resizingKey:t})},r._handleColumnResizeStop=function(){this.setState({resizingKey:null})},r._handleColumnSort=function(e){var t=e.currentTarget.dataset.key,r=this.props,a=r.sortBy,n=r.sortState,o=r.onColumnSort,i=Co.ASC;n?i=n[t]===Co.ASC?Co.DESC:Co.ASC:t===a.key&&(i=a.order===Co.ASC?Co.DESC:Co.ASC),o({column:this.columnManager.getColumn(t),key:t,order:i})},t}(n.a.PureComponent);Do.Column=vo,Do.PlaceholderKey=Io.PlaceholderKey,Do.defaultProps={classPrefix:"BaseTable",rowKey:"id",data:[],frozenData:[],fixed:!1,headerHeight:50,rowHeight:50,footerHeight:0,defaultExpandedRowKeys:[],sortBy:{},useIsScrolling:!1,overscanRowCount:1,onEndReachedThreshold:500,getScrollbarSize:function(e){if((!no&&0!==no||e)&&"undefined"!=typeof window&&window.document&&window.document.createElement){var t=document.createElement("div");t.style.position="absolute",t.style.top="-9999px",t.style.width="50px",t.style.height="50px",t.style.overflow="scroll",document.body.appendChild(t),no=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return no},onScroll:uo,onRowsRendered:uo,onScrollbarPresenceChange:uo,onRowExpand:uo,onExpandedRowsChange:uo,onColumnSort:uo,onColumnResize:uo},Do.propTypes={classPrefix:Hn.a.string,className:Hn.a.string,style:Hn.a.object,children:Hn.a.node,columns:Hn.a.arrayOf(Hn.a.shape(vo.propTypes)),data:Hn.a.arrayOf(Hn.a.object).isRequired,frozenData:Hn.a.arrayOf(Hn.a.object),rowKey:Hn.a.oneOfType([Hn.a.string,Hn.a.number]).isRequired,width:Hn.a.number.isRequired,height:Hn.a.number,maxHeight:Hn.a.number,rowHeight:Hn.a.number.isRequired,headerHeight:Hn.a.oneOfType([Hn.a.number,Hn.a.arrayOf(Hn.a.number)]).isRequired,footerHeight:Hn.a.number,fixed:Hn.a.bool,disabled:Hn.a.bool,overlayRenderer:Hn.a.oneOfType([Hn.a.func,Hn.a.element]),emptyRenderer:Hn.a.oneOfType([Hn.a.func,Hn.a.element]),footerRenderer:Hn.a.oneOfType([Hn.a.func,Hn.a.element]),headerRenderer:Hn.a.oneOfType([Hn.a.func,Hn.a.element]),rowRenderer:Hn.a.oneOfType([Hn.a.func,Hn.a.element]),headerClassName:Hn.a.oneOfType([Hn.a.string,Hn.a.func]),rowClassName:Hn.a.oneOfType([Hn.a.string,Hn.a.func]),headerProps:Hn.a.oneOfType([Hn.a.object,Hn.a.func]),headerCellProps:Hn.a.oneOfType([Hn.a.object,Hn.a.func]),rowProps:Hn.a.oneOfType([Hn.a.object,Hn.a.func]),cellProps:Hn.a.oneOfType([Hn.a.object,Hn.a.func]),expandIconProps:Hn.a.oneOfType([Hn.a.object,Hn.a.func]),expandColumnKey:Hn.a.string,defaultExpandedRowKeys:Hn.a.arrayOf(Hn.a.oneOfType([Hn.a.string,Hn.a.number])),expandedRowKeys:Hn.a.arrayOf(Hn.a.oneOfType([Hn.a.string,Hn.a.number])),onRowExpand:Hn.a.func,onExpandedRowsChange:Hn.a.func,sortBy:Hn.a.shape({key:Hn.a.string,order:Hn.a.oneOf([Co.ASC,Co.DESC])}),sortState:Hn.a.object,onColumnSort:Hn.a.func,onColumnResize:Hn.a.func,useIsScrolling:Hn.a.bool,overscanRowCount:Hn.a.number,getScrollbarSize:Hn.a.func,onScroll:Hn.a.func,onEndReached:Hn.a.func,onEndReachedThreshold:Hn.a.number,onRowsRendered:Hn.a.func,onScrollbarPresenceChange:Hn.a.func,rowEventHandlers:Hn.a.object,components:Hn.a.shape({TableCell:Hn.a.func,TableHeaderCell:Hn.a.func,ExpandIcon:Hn.a.func,SortIndicator:Hn.a.func})};var Lo=Do;function qo(e){var t;t="undefined"!=typeof window?window:"undefined"!=typeof self?self:global;var r,a,n="undefined"!=typeof document&&document.attachEvent;if(!n){var o=(a=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||function(e){return t.setTimeout(e,20)},function(e){return a(e)}),i=(r=t.cancelAnimationFrame||t.mozCancelAnimationFrame||t.webkitCancelAnimationFrame||t.clearTimeout,function(e){return r(e)}),s=function(e){var t=e.__resizeTriggers__,r=t.firstElementChild,a=t.lastElementChild,n=r.firstElementChild;a.scrollLeft=a.scrollWidth,a.scrollTop=a.scrollHeight,n.style.width=r.offsetWidth+1+"px",n.style.height=r.offsetHeight+1+"px",r.scrollLeft=r.scrollWidth,r.scrollTop=r.scrollHeight},l=function(e){if(!(e.target.className.indexOf("contract-trigger")<0&&e.target.className.indexOf("expand-trigger")<0)){var t=this;s(this),this.__resizeRAF__&&i(this.__resizeRAF__),this.__resizeRAF__=o((function(){(function(e){return e.offsetWidth!=e.__resizeLast__.width||e.offsetHeight!=e.__resizeLast__.height})(t)&&(t.__resizeLast__.width=t.offsetWidth,t.__resizeLast__.height=t.offsetHeight,t.__resizeListeners__.forEach((function(r){r.call(t,e)})))}))}},c=!1,u="",d="animationstart",h="Webkit Moz O ms".split(" "),m="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),p=document.createElement("fakeelement");if(void 0!==p.style.animationName&&(c=!0),!1===c)for(var b=0;b<h.length;b++)if(void 0!==p.style[h[b]+"AnimationName"]){u="-"+h[b].toLowerCase()+"-",d=m[b],c=!0;break}var g="resizeanim",f="@"+u+"keyframes "+g+" { from { opacity: 0; } to { opacity: 0; } } ",_=u+"animation: 1ms "+g+"; "}return{addResizeListener:function(r,a){if(n)r.attachEvent("onresize",a);else{if(!r.__resizeTriggers__){var o=r.ownerDocument,i=t.getComputedStyle(r);i&&"static"==i.position&&(r.style.position="relative"),function(t){if(!t.getElementById("detectElementResize")){var r=(f||"")+".resize-triggers { "+(_||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',a=t.head||t.getElementsByTagName("head")[0],n=t.createElement("style");n.id="detectElementResize",n.type="text/css",null!=e&&n.setAttribute("nonce",e),n.styleSheet?n.styleSheet.cssText=r:n.appendChild(t.createTextNode(r)),a.appendChild(n)}}(o),r.__resizeLast__={},r.__resizeListeners__=[],(r.__resizeTriggers__=o.createElement("div")).className="resize-triggers",r.__resizeTriggers__.innerHTML='<div class="expand-trigger"><div></div></div><div class="contract-trigger"></div>',r.appendChild(r.__resizeTriggers__),s(r),r.addEventListener("scroll",l,!0),d&&(r.__resizeTriggers__.__animationListener__=function(e){e.animationName==g&&s(r)},r.__resizeTriggers__.addEventListener(d,r.__resizeTriggers__.__animationListener__))}r.__resizeListeners__.push(a)}},removeResizeListener:function(e,t){if(n)e.detachEvent("onresize",t);else if(e.__resizeListeners__.splice(e.__resizeListeners__.indexOf(t),1),!e.__resizeListeners__.length){e.removeEventListener("scroll",l,!0),e.__resizeTriggers__.__animationListener__&&(e.__resizeTriggers__.removeEventListener(d,e.__resizeTriggers__.__animationListener__),e.__resizeTriggers__.__animationListener__=null);try{e.__resizeTriggers__=!e.removeChild(e.__resizeTriggers__)}catch(e){}}}}}var Mo=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Ho=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),zo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Uo=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},Vo=function(e){function t(){var e,r,a;Mo(this,t);for(var n=arguments.length,o=Array(n),i=0;i<n;i++)o[i]=arguments[i];return r=a=Uo(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),a.state={height:a.props.defaultHeight||0,width:a.props.defaultWidth||0},a._onResize=function(){var e=a.props,t=e.disableHeight,r=e.disableWidth,n=e.onResize;if(a._parentNode){var o=a._parentNode.offsetHeight||0,i=a._parentNode.offsetWidth||0,s=window.getComputedStyle(a._parentNode)||{},l=parseInt(s.paddingLeft,10)||0,c=parseInt(s.paddingRight,10)||0,u=parseInt(s.paddingTop,10)||0,d=parseInt(s.paddingBottom,10)||0,h=o-u-d,m=i-l-c;(!t&&a.state.height!==h||!r&&a.state.width!==m)&&(a.setState({height:o-u-d,width:i-l-c}),n({height:o,width:i}))}},a._setRef=function(e){a._autoSizer=e},Uo(a,r)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),Ho(t,[{key:"componentDidMount",value:function(){var e=this.props.nonce;this._autoSizer&&this._autoSizer.parentNode&&this._autoSizer.parentNode.ownerDocument&&this._autoSizer.parentNode.ownerDocument.defaultView&&this._autoSizer.parentNode instanceof this._autoSizer.parentNode.ownerDocument.defaultView.HTMLElement&&(this._parentNode=this._autoSizer.parentNode,this._detectElementResize=qo(e),this._detectElementResize.addResizeListener(this._parentNode,this._onResize),this._onResize())}},{key:"componentWillUnmount",value:function(){this._detectElementResize&&this._parentNode&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize)}},{key:"render",value:function(){var e=this.props,t=e.children,r=e.className,n=e.disableHeight,o=e.disableWidth,i=e.style,s=this.state,l=s.height,c=s.width,u={overflow:"visible"},d={},h=!1;return n||(0===l&&(h=!0),u.height=0,d.height=l),o||(0===c&&(h=!0),u.width=0,d.width=c),Object(a.createElement)("div",{className:r,ref:this._setRef,style:zo({},u,i)},!h&&t(d))}}]),t}(a.PureComponent);Vo.defaultProps={onResize:function(){},disableHeight:!1,disableWidth:!1,style:{}};var Bo=Vo,Yo=function(e){var t=e.className,r=e.width,a=e.height,o=e.children,i=e.onResize,s="number"==typeof r,l="number"==typeof a;return s&&l?n.a.createElement("div",{className:t,style:{width:r,height:a,position:"relative"}},o({width:r,height:a})):n.a.createElement(Bo,{className:t,disableWidth:s,disableHeight:l,onResize:i},(function(e){return o({width:s?r:e.width,height:l?a:e.height})}))};Yo.propTypes={className:Hn.a.string,width:Hn.a.number,height:Hn.a.number,children:Hn.a.func.isRequired,onResize:Hn.a.func};var Ko=Yo;function Wo(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Qo extends a.PureComponent{constructor(){super(...arguments),Wo(this,"state",{selectedRowKeys:[],sortedRows:[],sortState:new ne.OrderedMap,sortStateObj:{}}),Wo(this,"onColumnSort",e=>{let{key:t,order:r}=e,{sortState:a}=this.state;const n=a.get(t);a=a.remove(t),n&&r!==Co.DESC||(a=a.set(t,r)),this.setState({sortState:a,sortStateObj:a.toJS(),sortedRows:Xo(this.props.rows,a)},()=>{const{onChangeSort:e}=this.props;e&&e(a)})}),Wo(this,"rowEventHandlers",{onClick:e=>{let{rowData:t}=e;this.setState({selectedRowKeys:[t.id]},()=>{const{onSelectRow:e}=this.props;e&&e(t)})}}),Wo(this,"getRowClassName",e=>{let{rowData:t}=e;return D()({"moderation__author-claim__table__row__is-selected":this.state.selectedRowKeys.includes(t.id)})})}componentWillMount(){this.setState({sortedRows:Xo(this.props.rows,this.state.sortState)})}componentWillReceiveProps(e){ne.is(this.props.rows,e.rows)||this.setState({sortedRows:Xo(e.rows,this.state.sortState)})}render(){const{sortedRows:e,sortStateObj:t,selectedRowKeys:r}=this.state;return a.createElement("div",{className:"moderation__author-claim__table"},a.createElement(Ko,null,n=>{let{width:o,height:i}=n;return a.createElement(Lo,{width:o,height:i,fixed:!0,sortState:t,onColumnSort:this.onColumnSort,rowEventHandlers:this.rowEventHandlers,headerClassName:"moderation__author-claim__table__header",rowClassName:this.getRowClassName,selectedRowKeys:r,data:e},Go({dataKey:"authorName",title:"Author",frozen:!0}),Go({dataKey:"email",title:"Email"}),Go({dataKey:"claimDate",title:"Claim Date"}),Go({dataKey:"lastUpdated",title:"Last Updated"}),Go({dataKey:"flag",title:"Flag"}))}))}}const Go=e=>{let{dataKey:t,title:r,width:n,frozen:o}=e;return a.createElement(vo,{key:t,dataKey:t,title:r,width:n||150,frozen:o?vo.FrozenDirection.LEFT:null,resizable:!0,sortable:!0})};function Xo(e,t){return function(e,t){return t.reduce((e,t)=>{let[r,a]=t;return e.sort((e,t)=>{const n=Jo(e[r]),o=Jo(t[r]);return n===o?0:a===Co.DESC?n<o?1:-1:n>o?1:-1})},e)}(e.toJS(),[...t.entries()]).map(Zo)}function Jo(e){switch(typeof e){case"string":return e.toLowerCase();case"number":return e;case"boolean":return e?1:-1;default:if(null==e)return"";if(e instanceof Date||Pa.a.isMoment(e))return+e}return""}function Zo(e){return Object.keys(e).reduce((t,r)=>(t[r]=function(e,t){if(null==e)return"-";if(e instanceof Date)return Pa()(e).format("MM/DD/YYYY");if(Pa.a.isMoment(e))return e.format("MM/DD/YYYY");return e}(e[r]),t),{})}r(77);var $o=r(96),ei=r.n($o),ti=r(56),ri=r.n(ti);function ai(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function ni(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ai(Object(r),!0).forEach((function(t){oi(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ai(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function oi(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const ii=ei()(ge.b.AUTHOR_CLAIM_MODERATION);class si extends a.Component{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),oi(this,"_debounceFilterChange",null),oi(this,"_lastDragResizeX",null),oi(this,"onChangeFilterQuery",e=>{const t=e.currentTarget.value;this.setState({filterQuery:t},this.onFilterChangeDebounced)}),oi(this,"onDragResizeStart",e=>{e.preventDefault(),this.setState({isDraggingResize:!0}),this._lastDragResizeX=e.clientX,window.addEventListener("mousemove",this.onDragResize,!1)}),oi(this,"onDragResizeEnd",e=>{e.preventDefault(),this.setState({isDraggingResize:!1}),this._lastDragResizeX=null,window.removeEventListener("mousemove",this.onDragResize,!1)}),oi(this,"onDragResize",e=>{const t=this._lastDragResizeX;if(!t)return;const r=e.clientX;this._lastDragResizeX=r;const a=t-r;this.setState(e=>({detailsPaneWidthPx:e.detailsPaneWidthPx+a}))}),oi(this,"onFilterChange",()=>{const{location:e}=this.props,{filterQuery:t,modStatus:r}=this.state,a=this.context.api,n=this.context.history,o=ri.a.parse(e.search,{ignoreQueryPrefix:!0});o.query=t;const i=ni({},e,{search:ri.a.stringify(o)});n.replace(i),a.getAuthorProfileListForClaimModeration({status:r,query:t})}),oi(this,"onFilterChangeDebounced",Object(he.a)(this.onFilterChange,1e3,{leading:!1,trailing:!0})),oi(this,"onSelectRow",e=>{if(!e)return void this.setState({selectedAuthorProfile:null});const t=parseInt(e.id,10),r=this.context.claimModerationStore.getAuthorProfiles().find(e=>e.id===t);if(this.setState({selectedAuthorProfile:r}),r){this.context.api.getAuthorProfileForClaimModeration({authorProfileId:r.id})}}),oi(this,"refreshRows",()=>{const e=this.context.api;e.getAuthorProfileListForClaimModeration({status:this.state.modStatus,query:this.state.filterQuery}),e.fetchModerationStats()}),this.state=ni({detailsPaneWidthPx:306,filterQuery:ui(this.props.location.search),isDraggingResize:!1,modStatus:ci(this.props.location.pathname),selectedAuthorProfile:null},this.getStateFromAuthorClaimModerationStore()),this.context.claimModerationStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorClaimModerationStore())})}componentWillReceiveProps(e){const t={};if(this.props.location.pathname!==e.location.pathname){const r=ci(e.location.pathname);r!==this.state.modStatus&&(t.modStatus=r)}if(this.props.location.search!==e.location.search){const r=ui(e.location.search);r!==this.state.filterQuery&&(t.filterQuery=r)}Object.keys(t).length>0&&this.setState(t,this.onFilterChange)}handleListItemClick(e){this.setState(e)}getStateFromAuthorClaimModerationStore(){const e=this.context.claimModerationStore;return{isLoading:e.isLoading(),rows:e.getAuthorProfiles().map(di)}}render(){const{detailsPaneWidthPx:e,filterQuery:t,rows:r,modStatus:n,selectedAuthorProfile:o}=this.state;return a.createElement("div",{className:"moderation__author-claim"},a.createElement("div",{className:"moderation__author-claim__row"},a.createElement("div",{className:"moderation__author-claim__filter-cell"},a.createElement("label",{className:"moderation__author-claim__field"},a.createElement("div",{className:"moderation__author-claim__label"},"Filter Claims"),a.createElement("input",{className:"legacy__input moderation__author-claim__input",type:"text",placeholder:"Filter by author id, name, email, orcid id, etc.",onChange:this.onChangeFilterQuery,value:t}))),a.createElement("div",{className:"moderation__author-claim__status-cell"},a.createElement("div",{className:"moderation__author-claim__field"},a.createElement("div",{className:"moderation__author-claim__label"},"Claim Status"),a.createElement("div",{className:"moderation__author-claim__button-group"},[vr.b.Pending,vr.b.PendingEmailVerification,vr.b.Approved,vr.b.Denied].map(e=>a.createElement(li,{key:e,buttonModStatus:e,activeModStatus:n,filterQuery:t})))))),a.createElement("div",{className:"moderation__author-claim__row moderation__author-claim__row__fill-screen"},a.createElement("div",{className:"moderation__author-claim__table-cell"},a.createElement(Qo,{rows:r,onSelectRow:this.onSelectRow})),a.createElement("div",{onMouseDown:this.onDragResizeStart,onMouseUp:this.onDragResizeEnd,className:"moderation__author-claim__resize-gutter"},a.createElement(J.a,{icon:"horizontal-resize-handle"})),a.createElement("div",{className:"moderation__author-claim__details-cell",style:{width:e+"px"}},o?a.createElement(Cn,{key:o.id,authorProfile:o,onRefreshRows:this.refreshRows}):a.createElement("div",{className:"moderation__author-claim__details-cell__instructions"},"Select a claim to moderate"))))}}oi(si,"contextTypes",{api:K.a.instanceOf(pe.a).isRequired,claimModerationStore:K.a.instanceOf(_n.a).isRequired,history:K.a.instanceOf(je.a).isRequired});const li=e=>{let{activeModStatus:t,buttonModStatus:r,filterQuery:n}=e;return a.createElement(Be.a,{to:"AUTHOR_CLAIM_MODERATION",params:{status:r.toLowerCase()},query:{query:n},className:D()({"moderation__author-claim__button":!0,"moderation__author-claim__is-active":r===t})},r)};function ci(e){if(!e)return vr.b.Pending;const t=(ii.exec(e)||[])[1];return Object(vr.a)(t)||vr.b.Unsupported}function ui(e){if(!e)return"";return ri.a.parse(_e.a.parse(e).query||"").query||""}function di(e){return{id:e.id,authorName:e.fullName,email:e.email,claimDate:Pa()(e.claimedAtUtc),lastUpdated:null,flag:e.moderationTag}}function hi(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-AuthorClaimModerationPage"),a.createElement(si,e)}function mi(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class pi extends a.Component{static async willRouteTo(e,t){let{api:r,claimModerationStore:a}=e;if(!a.isUninitialized())return;const n=Object(vr.a)(t.params.status)||vr.b.Unsupported,{query:o}=t.query;return r.getAuthorProfileListForClaimModeration({status:n,query:o})}render(){const e=this.context.history;return a.createElement(hi,{location:e.location})}}mi(pi,"getPageTitle",()=>Object(f.b)(e=>e.authorClaimModeration.pageTitle)),mi(pi,"requiresAuthentication",()=>!0),mi(pi,"contextTypes",{history:K.a.instanceOf(je.a).isRequired});var bi=r(970),gi=r(925),fi=r(980);class _i extends a.PureComponent{render(){const{formError:e}=this.props;return a.createElement("div",{className:"author-onboarding__banner"},a.createElement("div",{className:"author-onboarding__banner__columns"},a.createElement("div",{className:"author-onboarding__banner__column"},this.props.leftContent,a.createElement("div",{className:"author-onboarding__banner__form-error"},e)),a.createElement("div",{className:"author-onboarding__banner__column"},this.props.children)))}}function yi(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Ei(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Oi=e=>Object(y.a)(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?yi(Object(r),!0).forEach((function(t){Ei(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yi(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e,{id:"author_onboarding_nav"})),Si=()=>Object(y.a)({id:"author_onboarding_skip_all"}),vi=()=>Object(y.a)({id:"author_onboarding_skip_step"});function Ci(){return(Ci=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function wi(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Pi(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Ni extends a.Component{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),Pi(this,"onClickSubmit",()=>{this.state.hasDraftPapers?this.setState({hasAttemptedSubmit:!0,errorMessage:Object(f.b)(e=>e.authorAddPapers.error.papersInDraft)},()=>{Object(De.a)()&&this.scrollToPaper(this.context.authorCorrectionsStore.getDraftPaperIds().first())}):this.setState({hasAttemptedSubmit:!0},()=>{this.submitCorrections().then(()=>this.emitStepComplete()).catch(e=>this.onApiError(e))})}),Pi(this,"emitStepComplete",()=>{this.props.onStepComplete("AUTHOR_ONBOARDING_ADD_PAPERS")}),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?wi(Object(r),!0).forEach((function(t){Pi(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wi(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({isSending:!1,errorMessage:null,hasAttemptedSubmit:!1},this.getStateFromAuthStore(),{},this.getStateFromAuthorCorrectionsStore()),this.context.authStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthStore())}),this.context.authorCorrectionsStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorCorrectionsStore())})}getStateFromAuthStore(){return{authorId:this.context.authStore.getClaimedAuthorId()}}getStateFromAuthorCorrectionsStore(){const e=this.context.authorCorrectionsStore,t=e.hasDraftPapers();return{isFormDirty:e.hasPendingCorrections()||t,hasDraftPapers:t}}scrollToPaper(e){if(!e)return!1;const t=document.querySelector('.author-add-papers__paper[data-paper-id="'.concat(e,'"]'));return!!t&&(t.scrollIntoView({behavior:"smooth"}),!0)}onApiError(e){w.a.error("Error with API",e),this.setState({errorMessage:Object(f.b)(e=>e.authorRemovePapers.error.apiSubmitFailed),isSending:!1})}async submitCorrections(){const{authorId:e}=this.state,t=this.context.authorCorrectionsStore,r=this.context.api;B()(e,"authorId must be populated to submit corrections");const a=t.getPendingCorrections(),n=t.getPendingIndexRequestUrls();await Object(me.d)(this,{isSending:!0}),a&&await r.submitPaperAuthorCorrections({authorId:e,corrections:a.toJS()}),n&&await r.submitAuthorIndexRequests({urls:n.toJS()}),await Object(me.d)(this,{isSending:!1}),t.clearPendingCorrections(),t.clearPendingIndexRequests()}render(){const{stepNum:e,numSteps:t}=this.props,{authorId:r,errorMessage:n,hasAttemptedSubmit:o,hasDraftPapers:i,isFormDirty:s}=this.state;return a.createElement("div",null,a.createElement("div",{className:"author-onboarding__page__content-block"},a.createElement("div",{className:"author-onboarding__step-num-label"},Object(f.b)(e=>e.authorOnboarding.stepNumLabel,e,t)),a.createElement("h2",{className:"author-onboarding__step-label"},Object(f.b)(e=>e.authorOnboarding.addPapersPage.stepLabel)),a.createElement("div",{className:"author-onboarding__step-description"},a.createElement(p.a,{content:Object(f.b)(e=>e.authorOnboarding.addPapersPage.stepDescription)}))),a.createElement("hr",{className:"author-onboarding__divider"}),r&&a.createElement(Ee,{authorId:r,showDraftAsError:o&&i}),r?a.createElement(Pe,{authorId:r}):null,a.createElement(_i,{formError:n},a.createElement("button",Ci({className:"author-onboarding__banner__link-button"},vi(),{onClick:this.emitStepComplete}),Object(f.b)(e=>e.authorOnboarding.addPapersPage.skipLabel)),a.createElement("span",{className:"author-onboarding__banner__button-spacer"}),a.createElement("button",Ci({className:"author-onboarding__banner__continue-button button button--primary"},Object(y.a)({id:"author_add_paper_submit"}),{onClick:this.onClickSubmit}),Object(f.b)(e=>e.authorOnboarding.banner.submitLabel))),a.createElement(Fe,{when:s,message:Object(f.b)(e=>e.authorOnboarding.dirtyFormMessage)}))}}function xi(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-AuthorOnboardingAddPapersPage"),a.createElement(Ni,e)}function ji(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Pi(Ni,"contextTypes",{api:K.a.instanceOf(pe.a).isRequired,authStore:K.a.instanceOf(Ne.a).isRequired,authorCorrectionsStore:K.a.instanceOf(z.a).isRequired});class Ri extends a.Component{render(){return a.createElement(xi,this.props)}}ji(Ri,"getPageTitle",()=>Object(f.b)(e=>e.authorOnboarding.addPapersPage.pageTitle)),ji(Ri,"getStepLabel",()=>Object(f.b)(e=>e.authorOnboarding.addPapersPage.stepLabel)),ji(Ri,"requiresAuthentication",()=>!0);class Ti extends a.PureComponent{render(){const{authorId:e}=this.props;return a.createElement("div",{className:"corrections-summary"},a.createElement("div",{className:"corrections-summary__section"},a.createElement("div",{className:"correction-summary__blank-state"},a.createElement("div",{className:"correction-summary__blank-state__content"},a.createElement(J.a,{className:"correction-summary__blank-state__icon",icon:"user-with-checkmark",width:"70",height:"87.5"}),a.createElement("div",{className:"correction-summary__blank-state__description"},Object(f.b)(e=>e.correctionSummary.noCorrections.label)),e&&a.createElement("div",{className:"correction-summary__blank-state__author-page-button"},a.createElement(Be.a,{to:"AUTHOR_PROFILE_BY_ID",params:{authorId:e},className:"button button--secondary"},Object(f.b)(e=>e.correctionSummary.noCorrections.authorPageButton)))))))}}function Ai(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Ii(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class ki extends a.Component{constructor(e,t){super(e,t),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ai(Object(r),!0).forEach((function(t){Ii(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ai(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromAuthStore(),{},this.getStateFromCorrectionsStore()),this.context.authStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthStore())}),this.context.correctionsStore.registerComponent(this,()=>{this.setState(this.getStateFromCorrectionsStore())}),this.props.onStepComplete("AUTHOR_ONBOARDING_COMPLETE")}getStateFromAuthStore(){return{claimedAuthorId:this.context.authStore.getClaimedAuthorId()}}getStateFromCorrectionsStore(){return{hasPendingCorrections:this.context.correctionsStore.hasCorrections()}}render(){const{stepNum:e,numSteps:t}=this.props,{hasPendingCorrections:r,claimedAuthorId:n}=this.state;return a.createElement("div",{className:"author-onboarding__page__content-block"},a.createElement("div",{className:"author-onboarding__step-num-label"},Object(f.b)(e=>e.authorOnboarding.stepNumLabel,e,t)),a.createElement("h2",{className:"author-onboarding__step-label"},Object(f.b)(e=>e.authorOnboarding.completePage.stepLabel)),r?a.createElement(Bt,null):a.createElement(Ti,{authorId:n}),a.createElement(o,null,a.createElement(s,null,a.createElement("span",{className:"author-onboarding__banner__button-spacer"}),a.createElement(Be.a,{className:"author-onboarding__page__author-profile-link-button button button--primary",to:"AUTHOR_PROFILE_BY_ID",params:{authorId:n}},Object(f.b)(e=>e.account.page.corrections.authorPageLink)))))}}function Fi(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-AuthorOnboardingCompletePage"),a.createElement(ki,e)}function Di(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Ii(ki,"contextTypes",{authStore:K.a.instanceOf(Ne.a).isRequired,correctionsStore:K.a.instanceOf(At.a).isRequired});class Li extends a.Component{static async willRouteTo(e){let{api:t,authStore:r}=e;const a=r.getClaimedAuthorId();if(a)return Promise.all([t.fetchAuthorCorrectionsForAuthor({authorId:a}),t.fetchPaperAuthorCorrectionsForAuthor({authorId:a,includePaperModel:"PaperLite"})])}render(){return a.createElement(Fi,this.props)}}Di(Li,"getPageTitle",()=>Object(f.b)(e=>e.authorOnboarding.completePage.pageTitle)),Di(Li,"getStepLabel",()=>Object(f.b)(e=>e.authorOnboarding.completePage.stepLabel)),Di(Li,"requiresAuthentication",()=>!0);var qi=e=>{let{name:t,label:r,placeholder:n,error:o,value:i,onChange:s,isRequired:l}=e;return a.createElement("label",{className:D()("author-edit__field",{"author-edit__has-error":o})},a.createElement("div",{className:"author-edit__field__label"},a.createElement("span",{className:"author-edit__field__label-text"},r),!l&&a.createElement("span",{className:"author-edit__field__label-optional"},Object(f.b)(e=>e.authorEdit.form.optional))),a.createElement("div",{className:"author-edit__field__input"},a.createElement("input",{type:"text",name:t,className:"legacy__input author-edit__field__input-text",value:i,onChange:s,placeholder:n}),a.createElement("div",{className:"author-edit__field__error"},o)))};function Mi(){return(Mi=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Hi(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function zi(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Ui extends a.Component{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),zi(this,"onClickSkip",e=>{e.preventDefault(),this.emitStepComplete()}),zi(this,"onClickSubmit",e=>{e.preventDefault(),this.updateAuthorProfile()}),zi(this,"onSubmitForm",e=>{e.preventDefault(),this.updateAuthorProfile()}),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Hi(Object(r),!0).forEach((function(t){zi(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Hi(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({isSending:!1,isFormDirty:!1,formError:null,firstNameError:null,middleNamesError:null,lastNameError:null,affiliationError:null,orcidIdError:null,homepageUrlError:null},this.getStateFromAuthorOrAuthorProfileStore()),this.context.authorStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorOrAuthorProfileStore())}),this.context.authorProfileStore.registerComponent(this,()=>{this.state.isFormDirty||this.setState(this.getStateFromAuthorOrAuthorProfileStore())}),this.onChangeFirstName=this.onChangeText.bind(this,"firstName"),this.onChangeMiddleNames=this.onChangeText.bind(this,"middleNames"),this.onChangeLastName=this.onChangeText.bind(this,"lastName"),this.onChangeAffiliation=this.onChangeText.bind(this,"affiliation"),this.onChangeOrcidId=this.onChangeText.bind(this,"orcidId"),this.onChangeHomepageUrl=this.onChangeText.bind(this,"homepageUrl")}getStateFromAuthorOrAuthorProfileStore(){const e=this.context.authorProfileStore.getAuthorProfile();if(e){const t=e.affiliations.isEmpty?"":e.affiliations.join("; "),r=e.middleNames.isEmpty?"":e.middleNames.join(" ");return{firstNameValue:e.firstName||"",middleNamesValue:r,lastNameValue:e.lastName||"",affiliationValue:t,orcidIdValue:e.orcidId||"",homepageUrlValue:e.homepageUrl||"",fullNameValue:e.fullName||""}}const{author:t}=this.context.authorStore;if(t){const e=t.affiliations.isEmpty?"":t.affiliations.join("; "),r=t.middleNames.isEmpty?"":t.middleNames.join(" ");return{firstNameValue:t.firstName||"",middleNamesValue:r,lastNameValue:t.lastName||"",affiliationValue:e,orcidIdValue:t.orcidId||"",homepageUrlValue:t.homepageUrl||"",fullNameValue:""}}return{firstNameValue:"",middleNamesValue:"",lastNameValue:"",affiliationValue:"",orcidIdValue:"",homepageUrlValue:"",fullNameValue:""}}validateFormState(){const{lastNameValue:e,orcidIdValue:t,homepageUrlValue:r}=this.state;let a=null,n=null,o=null;return e.trim()||(a=Object(f.b)(e=>e.authorEdit.error.lastNameMissing)),t&&(ht.a.test(t)||(n=Object(f.b)(e=>e.authorEdit.error.orcidIdInvalid))),r&&(_e.a.parse(r).host&&dt.a.test(r)||(o=Object(f.b)(e=>e.authorEdit.error.homepageUrlInvalid))),{firstNameError:null,middleNamesError:null,lastNameError:a,affiliationError:null,orcidIdError:n,homepageUrlError:o}}async updateAuthorProfile(){const e=this.validateFormState();if(this.setState(e),!!Object.values(e).find(e=>null!==e))return void w.a.warn("Could not save do to errors",e);const{author:t}=this.context.authorStore,r={authorId:t.id,lastName:this.state.lastNameValue.trim(),middleNames:this.state.middleNamesValue.toString().split(" ").map(e=>e.trim()),firstName:this.state.firstNameValue.trim(),affiliation:this.state.affiliationValue.toString().split(";").map(e=>e.trim()),orcidId:this.state.orcidIdValue.trim(),homepageUrl:this.state.homepageUrlValue.trim()};w.a.info("Saving author profile",r),await Object(me.d)(this,{isSending:!0,formError:null});const a=Object(me.a)(0);try{await this.context.api.updateAuthorProfile(r)}catch(e){return void await Object(me.d)(this,{isSending:!1,formError:Object(f.b)(e=>e.authorEdit.error.apiFailed)})}await a,await Object(me.d)(this,{isSending:!1}),this.emitStepComplete()}emitStepComplete(){this.props.onStepComplete("AUTHOR_ONBOARDING_PROFILE")}onChangeCheckbox(e,t){this.setState({isFormDirty:!0,["".concat(e,"Value")]:!!t.currentTarget.checked})}onChangeText(e,t){this.setState({isFormDirty:!0,["".concat(e,"Error")]:null,["".concat(e,"Value")]:t.currentTarget.value})}getHeaderLabel(e){return e?Object(f.b)(e=>e.authorOnboarding.profilePage.stepLabelWithName,e):Object(f.b)(e=>e.authorOnboarding.profilePage.stepLabelWithoutName)}render(){const{author:e}=this.context.authorStore;if(!e)return null;const{stepNum:t,numSteps:r}=this.props,{formError:n,firstNameError:o,firstNameValue:i,middleNamesError:s,middleNamesValue:l,lastNameError:c,lastNameValue:u,affiliationError:d,affiliationValue:h,orcidIdError:m,orcidIdValue:b,homepageUrlError:g,homepageUrlValue:_,fullNameValue:E,isFormDirty:O}=this.state;return a.createElement("div",{className:"author-edit"},a.createElement("div",{className:"author-onboarding__page__content-block"},a.createElement("div",{className:"author-onboarding__step-num-label"},Object(f.b)(e=>e.authorOnboarding.stepNumLabel,t,r)),a.createElement("h2",{className:"author-onboarding__step-label"},this.getHeaderLabel(E)),a.createElement("div",{className:"author-onboarding__step-description"},a.createElement(p.a,{content:Object(f.b)(e=>e.authorOnboarding.profilePage.stepDescription)}))),a.createElement("hr",{className:"author-edit__divider"}),a.createElement("form",{className:"author-edit__form",onSubmit:this.onSubmitForm},a.createElement("div",{className:"author-onboarding__page__content-block"},a.createElement(qi,{name:"firstName",label:Object(f.b)(e=>e.authorEdit.form.firstNameLabel),placeholder:Object(f.b)(e=>e.authorEdit.form.firstNamePlaceholder),value:i,error:o,onChange:this.onChangeFirstName,isRequired:!1}),a.createElement(qi,{name:"middleNames",label:Object(f.b)(e=>e.authorEdit.form.middleNamesLabel),placeholder:Object(f.b)(e=>e.authorEdit.form.middleNamesPlaceholder),value:l,error:s,onChange:this.onChangeMiddleNames,isRequired:!1}),a.createElement(qi,{name:"lastName",label:Object(f.b)(e=>e.authorEdit.form.lastNameLabel),placeholder:Object(f.b)(e=>e.authorEdit.form.lastNamePlaceholder),value:u,error:c,onChange:this.onChangeLastName,isRequired:!0}),a.createElement("div",{className:"author-onboarding__field__description"},a.createElement("span",{className:"author-onboarding__field__description-text"},Object(f.b)(e=>e.authorEdit.form.applyToPapersDescription)))),a.createElement("hr",{className:"author-edit__divider"}),a.createElement("div",{className:"author-onboarding__page__content-block"},a.createElement(qi,{name:"affiliation",label:Object(f.b)(e=>e.authorEdit.form.affiliationLabel),placeholder:Object(f.b)(e=>e.authorEdit.form.affiliationPlaceholder),value:h,error:d,onChange:this.onChangeAffiliation,isRequired:!1}),a.createElement(qi,{name:"orcidId",label:Object(f.b)(e=>e.authorEdit.form.orcidIdLabel),placeholder:Object(f.b)(e=>e.authorEdit.form.orcidIdPlaceholder),value:b,error:m,onChange:this.onChangeOrcidId,isRequired:!1}),a.createElement(qi,{name:"homepageUrl",label:Object(f.b)(e=>e.authorEdit.form.homepageUrlLabel),placeholder:Object(f.b)(e=>e.authorEdit.form.homepageUrlPlaceholder),value:_,error:g,onChange:this.onChangeHomepageUrl,isRequired:!1})),a.createElement(_i,{formError:n},a.createElement("button",Mi({className:"author-onboarding__banner__link-button"},vi(),{onClick:this.onClickSkip}),Object(f.b)(e=>e.authorOnboarding.profilePage.skipLabel)),a.createElement("span",{className:"author-onboarding__banner__button-spacer"}),a.createElement("button",Mi({className:"author-onboarding__banner__continue-button button button--primary"},Object(y.a)({id:"author_profile_submit"}),{onClick:this.onClickSubmit}),Object(f.b)(e=>e.authorOnboarding.banner.submitLabel)))),a.createElement(Fe,{when:O,message:Object(f.b)(e=>e.authorOnboarding.dirtyFormMessage)}))}}function Vi(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-AuthorOnboardingProfilePage"),a.createElement(Ui,e)}function Bi(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}zi(Ui,"contextTypes",{api:K.a.instanceOf(pe.a).isRequired,authorStore:K.a.instanceOf(H.a).isRequired,authorProfileStore:K.a.instanceOf(U.a).isRequired,authStore:K.a.instanceOf(Ne.a).isRequired,dispatcher:K.a.instanceOf(fa.Dispatcher).isRequired});class Yi extends a.Component{static async willRouteTo(e){let{authStore:t,api:r}=e;const a=t.getClaimedAuthorId();return B()(a,"Claimed author missing"),Promise.all([r.fetchAuthorProfile({authorId:a}),r.fetchAuthorDetail(a,null,!1)])}render(){return a.createElement(Vi,this.props)}}function Ki(){return(Ki=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Wi(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Qi(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Bi(Yi,"getPageTitle",()=>Object(f.b)(e=>e.authorOnboarding.profilePage.pageTitle)),Bi(Yi,"getStepLabel",()=>Object(f.b)(e=>e.authorOnboarding.profilePage.stepLabelWithoutName)),Bi(Yi,"requiresAuthentication",()=>!0);class Gi extends a.Component{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),Qi(this,"onClickSubmit",()=>{this.submitCorrections().then(()=>this.emitStepComplete()).catch(e=>this.onApiError(e))}),Qi(this,"emitStepComplete",()=>{this.props.onStepComplete("AUTHOR_ONBOARDING_REMOVE_PAPERS")}),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Wi(Object(r),!0).forEach((function(t){Qi(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Wi(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({isSending:!1,errorMessage:null},this.getStateFromAuthStore(),{},this.getStateFromAuthorCorrectionsStore()),this.context.authStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthStore())}),this.context.authorCorrectionsStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorCorrectionsStore())})}getStateFromAuthStore(){return{authorId:this.context.authStore.getClaimedAuthorId()}}getStateFromAuthorCorrectionsStore(){const e=this.context.authorCorrectionsStore;return{isFormDirty:e.hasPendingCorrections()||e.hasDraftPapers()}}onApiError(e){w.a.error("Error with API",e),this.setState({errorMessage:Object(f.b)(e=>e.authorRemovePapers.error.apiSubmitFailed),isSending:!1})}async submitCorrections(){const{api:e,authorCorrectionsStore:t}=this.context,{authorId:r}=this.state,a=t.getPendingCorrections();await Object(me.d)(this,{isSending:!0}),await e.submitPaperAuthorCorrections({authorId:r,corrections:a}),await Object(me.d)(this,{isSending:!1}),t.clearPendingCorrections()}render(){const{stepNum:e,numSteps:t}=this.props,{authorId:r,errorMessage:n,isFormDirty:o}=this.state;return a.createElement("div",null,a.createElement("div",{className:"author-onboarding__page__content-block"},a.createElement("div",{className:"author-onboarding__step-num-label"},Object(f.b)(e=>e.authorOnboarding.stepNumLabel,e,t)),a.createElement("h2",{className:"author-onboarding__step-label"},Object(f.b)(e=>e.authorOnboarding.removePapersPage.stepLabel)),a.createElement("div",{className:"author-onboarding__step-description"},a.createElement(p.a,{content:Object(f.b)(e=>e.authorOnboarding.removePapersPage.stepDescription)}))),a.createElement("hr",{className:"author-onboarding__divider"}),r&&a.createElement(Vr,{key:r,authorId:r}),a.createElement(_i,{formError:n,leftContent:a.createElement(Kr,null)},a.createElement("button",Ki({className:"author-onboarding__banner__link-button"},vi(),{onClick:this.emitStepComplete}),Object(f.b)(e=>e.authorOnboarding.removePapersPage.skipLabel)),a.createElement("span",{className:"author-onboarding__banner__button-spacer"}),a.createElement("button",Ki({className:"author-onboarding__banner__continue-button button button--primary"},Object(y.a)({id:"author_remove_paper_submit"}),{onClick:this.onClickSubmit}),Object(f.b)(e=>e.authorOnboarding.banner.submitLabel))),a.createElement(Fe,{when:o,message:Object(f.b)(e=>e.authorOnboarding.dirtyFormMessage)}))}}function Xi(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-AuthorOnboardingRemovePapersPage"),a.createElement(Gi,e)}function Ji(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Qi(Gi,"contextTypes",{api:K.a.instanceOf(pe.a).isRequired,authStore:K.a.instanceOf(Ne.a).isRequired,authorCorrectionsStore:K.a.instanceOf(z.a).isRequired});class Zi extends a.Component{render(){return a.createElement(Xi,this.props)}}Ji(Zi,"getPageTitle",()=>Object(f.b)(e=>e.authorOnboarding.removePapersPage.pageTitle)),Ji(Zi,"getStepLabel",()=>Object(f.b)(e=>e.authorOnboarding.removePapersPage.stepLabel)),Ji(Zi,"requiresAuthentication",()=>!0);var $i=r(849);function es(){return(es=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}class ts extends a.PureComponent{renderStep(e){let{stepNum:t,isActive:r,hasCompleted:n,linkRouteName:o,label:i}=e;const s=a.createElement(a.Fragment,null,a.createElement("div",{className:"author-onboarding-nav__step-num"},n?a.createElement(J.a,{className:"author-onboarding-nav__step-num__check",icon:"check",height:"8",width:"8"}):a.createElement("div",{className:"author-onboarding-nav__step-num__number"},t)),a.createElement("div",{className:"author-onboarding-nav__step-label"},i));return a.createElement("li",{key:t,className:D()({"author-onboarding-nav__step":!0,"author-onboarding-nav__is-active":r,"author-onboarding-nav__has-completed":n})},n?a.createElement(Be.a,es({to:o},Oi({"route-name":o}),{className:"author-onboarding-nav__step-layout"}),s):a.createElement("div",{className:"author-onboarding-nav__step-layout"},s))}render(){const{steps:e}=this.props;return a.createElement("div",{className:"author-onboarding-nav"},a.createElement("div",{className:"author-onboarding-nav__beta-tag"},a.createElement($i.a,{display:"link",openNewTab:!0})),a.createElement("h3",{className:"author-onboarding-nav__headline"},Object(f.b)(e=>e.authorOnboarding.nav.headline)),a.createElement("nav",{className:"author-onboarding-nav__nav"},a.createElement("ol",{className:"author-onboarding-nav__step-list"},e.map(e=>this.renderStep(e)))))}}var rs=r(22);function as(){return(as=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function ns(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class os extends a.Component{constructor(){super(...arguments),ns(this,"state",{completedSteps:ne.Set()}),ns(this,"onStepComplete",e=>{this.completeStep(e).catch(e=>w.a.error(e))}),ns(this,"onClickCancel",()=>{const{onCancel:e}=this.props;e&&e()}),ns(this,"onClickContact",e=>{e.preventDefault(),this.context.dispatcher.dispatch(Object(ga.b)({id:ba.b.FEEDBACK}))})}getSteps(){var e;const t=this.context.history,{route:r}=this.props,a=null!=(e=Object(wr.a)(r.routes,t.location.pathname))&&null!=(e=e[0])&&null!=(e=e.route)?e.path:e;return(r.routes||[]).map((e,t)=>{const r=Object(ge.c)(e.path)||"AUTHOR_ONBOARDING",n=e.component,o="function"==typeof n.getStepLabel?n.getStepLabel():null;return{isActive:e.path===a,hasCompleted:this.state.completedSteps.has(r),label:o||Object(f.b)(e=>e.authorOnboarding.defaultStepLabel,(t+1).toLocaleString()),linkRouteName:r,stepNum:t+1}})}async completeStep(e){const{completedSteps:t}=this.state;t.has(e)||await Object(me.d)(this,{completedSteps:t.add(e)});const r=this.getSteps(),a=r.findIndex(e=>!e.hasCompleted),n=a<0?null:r[a];if(n){this.context.history.push(Object(ge.d)({routeName:n.linkRouteName}))}}render(){const e=this.getSteps(),t=this.context.authStore.getClaimedAuthorId();const r={onStepComplete:this.onStepComplete,stepNum:is(e),numSteps:e.length};return a.createElement(Sr.a,{className:"author-onboarding"},a.createElement("div",{className:"author-onboarding__columns"},a.createElement("div",{className:"author-onboarding__column author-onboarding__column__nav"},a.createElement("div",{className:"author-onboarding__nav"},a.createElement(ts,{steps:e}),a.createElement("div",{className:"author-onboarding__nav__links"},t?a.createElement(Be.a,as({to:"AUTHOR_PROFILE_BY_ID",params:{authorId:t},className:"author-onboarding__nav__link"},Si(),{onClick:this.onClickCancel}),Object(f.b)(e=>e.authorOnboarding.banner.cancelLabel)):a.createElement(Be.a,as({to:"HOME",className:"author-onboarding__nav__link"},Si(),{onClick:this.onClickCancel}),Object(f.b)(e=>e.authorOnboarding.banner.cancelLabel)),a.createElement("a",{className:"author-onboarding__nav__link",onClick:this.onClickContact},Object(f.b)(e=>e.authorOnboarding.banner.contactLabel))))),a.createElement("div",{className:"author-onboarding__column author-onboarding__page"},Object(wr.b)(this.props.route.routes,r))))}}function is(e){const t=e.find(e=>e.isActive);return t?t.stepNum:1}function ss(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-AuthorOnboardingPage"),a.createElement(os,e)}function ls(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}ns(os,"contextTypes",{api:K.a.instanceOf(pe.a).isRequired,authStore:K.a.instanceOf(Ne.a).isRequired,dispatcher:K.a.instanceOf(rs.a).isRequired,history:K.a.instanceOf(je.a).isRequired,weblabStore:K.a.instanceOf(Cr.b).isRequired});class cs extends a.Component{static async willRouteTo(e,t){const{api:r,authStore:a,weblabStore:n}=e,o=a.getClaimedAuthorId();return o&&n.isFeatureEnabled(er.b.AuthorClaim)?t.path===ge.b.AUTHOR_ONBOARDING?new St.a({routeName:"AUTHOR_ONBOARDING_PROFILE",replace:!0,status:302}):void await r.fetchAuthorProfile({authorId:o}):new St.a({routeName:"HOME",replace:!0,status:302})}render(){return a.createElement(ss,this.props)}}ls(cs,"getPageTitle",()=>Object(f.b)(e=>e.authorEdit.pageTitle.withoutName)),ls(cs,"requiresAuthentication",()=>!0);var us=r(157);class ds extends a.PureComponent{render(){return a.createElement(ue.c,{feature:er.b.AuthorClaimAllowNewClaims},a.createElement(ue.b,null,a.createElement("div",{className:"author-claim-ad"},a.createElement("div",{className:"author-claim-ad__content-container"},a.createElement("div",{className:"author-claim-ad__title"},Object(f.b)(e=>e.authorClaim.ad.headline)),a.createElement("div",{className:"author-claim-ad__description"},a.createElement(p.a,{content:Object(f.b)(e=>e.authorClaim.ad.description)}))))))}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(ds,"contextTypes",{iconStore:K.a.instanceOf(us.a).isRequired});var hs=r(988);class ms extends a.PureComponent{render(){return n.a.createElement("div",{className:"container flex-row"},this.props.children)}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(ms,"propTypes",{children:K.a.array.isRequired});var ps=r(736),bs=r(850),gs=r(780),fs=r(794);const _s="citations",ys="coauthor",Es="relevance",Os="baseline",Ss="recent_relevant_popular";function vs(e){switch(e){case"baseline":return Os;case"recent_relevant_popular":return Ss;default:return null}}class Cs extends a.Component{constructor(){super(...arguments),function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(this,"getReasonTip",e=>{const t=this.props.author.name;if(!t)return null;switch(e.reason){case _s:return Object(f.b)(e=>e.author.recommendations.reason.citations,t,e.name);case ys:return Object(f.b)(e=>e.author.recommendations.reason.coauthor,t,e.name);case Es:return Object(f.b)(e=>e.author.recommendations.reason.relevance,t,e.name);default:return null}})}render(){const{recommendations:e,useGlobalExplanation:t,globalExplanationMsg:r,maxResults:n}=this.props,o=n?e.slice(0,n):e;return a.createElement("div",{className:D()("author-recs",{"author-recs__compact":!ws(o)})},a.createElement("div",{className:"author-recs__top-flex"},a.createElement("h2",{className:"author-recs__header"},Object(f.b)(e=>e.author.recommendations.headline)),t&&r&&a.createElement(fs.default,{placement:fs.PLACEMENT.RIGHT,tooltipContent:r},a.createElement("span",{className:"author-recs__global-tip"},Object(f.b)(e=>e.author.recommendations.why)))),o.map(e=>a.createElement(Be.a,{"data-heap-id":"author-recs-link",to:"AUTHOR_DETAILS",params:{slug:e.slug,authorId:e.id}},a.createElement(gs.default,{key:e.id.toString()},a.createElement("div",{className:"author-recs__author-icon"},a.createElement(J.a,{icon:"user",width:"19",height:"19"})),a.createElement("ul",null,a.createElement("li",null,a.createElement("span",{className:"author-recs__author-title"},e.name)),a.createElement("li",{className:"author-recs__metadata"},Object(f.b)(e=>e.author.recommendations.counts.formattedCounts,Object(za.l)(e.numPapers,Object(f.b)(e=>e.author.recommendations.counts.publication)),Object(za.l)(e.numCitations,Object(f.b)(e=>e.author.recommendations.counts.citation)))),e.coauthor&&a.createElement("li",{className:"author-recs__metadata"},Object(f.b)(e=>e.author.recommendations.coAuthorLabel))),!t&&this.getReasonTip(e)&&a.createElement(fs.default,{placement:fs.PLACEMENT.RIGHT,tooltipContent:this.getReasonTip(e)},a.createElement(J.a,{className:"author-recs__info-tip",icon:"information",width:"12",height:"12"}))))))}}const ws=e=>!!e.find(e=>!0===e.coauthor);function Ps(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Ns(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class xs extends a.Component{constructor(e,t){super(e,t),Ns(this,"getStateFromWeblabStore",()=>({modelVariation:vs(this.context.weblabStore.getVariation(ha.b.AuthorRecommendationsData.KEY))})),Ns(this,"extractSkipperData",()=>{const e=this.props.author.skipperExperiments.dataFor(ha.b.AuthorRecommendationsData.KEY),t=e?e.models[this.state.modelVariation]:void 0;let r=[];return t&&t.recommendedAuthors&&(r=t.recommendedAuthors),r}),Ns(this,"getGlobalExplanationText",()=>{switch(this.state.modelVariation){case Os:return Object(f.b)(e=>e.author.recommendations.reason.globalBaseline);case Ss:return Object(f.b)(e=>e.author.recommendations.reason.globalRecentRelevant);default:return null}}),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ps(Object(r),!0).forEach((function(t){Ns(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ps(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromWeblabStore()),this.context.weblabStore.registerComponent(this,()=>{this.setState(this.getStateFromWeblabStore())})}componentDidMount(){this.context.weblabStore.expose(ha.b.AuthorRecommendationsData.KEY)}render(){const{author:e,useGlobalExplanation:t}=this.props,r=this.extractSkipperData(),n=this.getGlobalExplanationText();return a.createElement(Cs,{author:e,recommendations:r,useGlobalExplanation:t,globalExplanationMsg:n,maxResults:4})}}Ns(xs,"contextTypes",{weblabStore:K.a.instanceOf(Cr.b).isRequired});var js=r(821),Rs=r(785),Ts=r(779),As=r(852),Is=r(813),ks=r(853),Fs=r(854);r(49);class Ds extends a.PureComponent{handleChangeSort(e){const t="string"==typeof e?e:e.target.value;this.props.onChangeSort&&this.props.onChangeSort(t);const r=this.context.analyticsLocation;if(r){const e=$t.a.getIn(r,"SORT_BY");Object(nr.a)(Fs.a.create(e,{sort:t}))}else Object(nr.a)(Fs.a.create($t.a.SORT_BY,{sort:t}))}render(){const{className:e}=this.props,t=D()(e,"search-sort flex-row-vcenter filter-bar__sort-selector");return a.createElement("div",{className:t},a.createElement("select",{className:"legacy__select search-sort-select",onChange:this.handleChangeSort.bind(this),value:this.props.sort,"data-selenium-selector":"sort-select"},this.props.options.map(e=>{const t=Qa.a.getString("sort.".concat(e.id,".label"));return a.createElement("option",{value:e.id,key:e.id,"data-selenium-selector":"sort-by-".concat(e.id)},Qa.a.getString("sort.label",t))})),a.createElement(J.a,{icon:"disclosure",height:"12",width:"12",className:"dropdown-arrow-icon"}))}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Ds,"contextTypes",{analyticsLocation:K.a.object});var Ls=r(831);class qs{constructor(e,t){this.id=e,this.displayName=t}}const Ms={AUTHOR:new qs("author","Authors"),COAUTHOR:new qs("coAuthor","Co-Authors"),VENUE:new qs("venue","Venues"),PUBLICATION_TYPE:new qs("publicationType","Publication Types"),EXTERNAL_CONTENT_TYPE:new qs("externalContentType","Supplemental Content")};var Hs=Object(Ls.b)(Ms),zs=r(52),Us=r(84),Vs=(r(70),r(33)),Bs=r(19),Ys=r.n(Bs);class Ks{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{showSortExplanation:!1,showResultCount:!0,sortDisplayType:"select",scrollToTopOfPage:!0,searchResultLayout:{showSortStat:!1},sorts:null};e.sorts||(e.sorts=Vs.a.paperSearch()),Ys()(this,e)}}function Ws(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Qs extends a.PureComponent{constructor(){super(...arguments),Ws(this,"onChangeYearFilter",(e,t)=>{const{queryStore:r,router:a}=this.context;r.routeToYearRange(e,t,a)}),Ws(this,"onChangeSort",e=>{this.context.queryStore.routeToSort(e,this.context.router)}),Ws(this,"toggleHasPdf",()=>{Object(nr.a)(rn.a.create($t.a.FACET_HAS_PDF,{documentCount:this.state.countOfPapersWithViewablePdf,action:this.state.isPdfFilterSelected?"disable":"enable"})),zs.a.changeRouteForQuery(this.context.queryStore.getQuery().set("requireViewablePdf",!this.state.isPdfFilterSelected),this.context.history,this.context.router),this.setState({isPdfFilterSelected:!this.state.isPdfFilterSelected})}),Ws(this,"isFiltered",e=>{const t=this.context.queryStore.getQuery()[e];return"yearFilter"===e?t.min||t.max:!!t&&!!t.size>0}),this.state=this.getStateFromQueryStore(),this.context.queryStore.registerComponent(this,()=>{this.setState(this.getStateFromQueryStore())})}getStateFromQueryStore(){const e=this.context.queryStore.getQueryResponse().stats.get("countOfPapersWithViewablePdf")||0,t=this.context.queryStore.getQueryResponse().stats.get("years").size>1||!1;return{isPdfFilterSelected:this.context.queryStore.getQuery().requireViewablePdf,countOfPapersWithViewablePdf:e,shouldDisplayYearFilter:t,query:this.context.queryStore.getQuery(),response:this.context.queryStore.getQueryResponse(),yearFilter:this.context.queryStore.getQuery().yearFilter}}getButtonLabel(e,t,r){const a=this.context.queryStore.getQuery()[e];return a.isEmpty()?t:1===a.size?Object(za.p)(a.first(),r):"".concat(Object(za.p)(a.first(),r)," +").concat(a.size-1)}renderDates(){const{response:e,query:t}=this.state,{stats:r}=e;return a.createElement(ks.a,{analyticsEvent:$t.a.Serp.YEAR_SLIDER,filterCallback:this.onChangeYearFilter,filters:r,histogramHeight:95,histogramWidth:221,yearFilter:t.yearFilter,showPresetButtons:!0})}renderFilterList(e,t){return t.size>5?a.createElement(As.a,{label:Hs.findById(e).displayName,lessText:"Fewer"},r=>a.createElement(Is.a,{maxLabelLength:30,collapsible:!1,filterType:e,displayDocCount:!0,filters:t.take(r?t.size:5),isFilterBar:!0})):a.createElement(Is.a,{maxLabelLength:30,displayDocCount:!0,collapsible:!1,filterType:e,filters:t,isFilterBar:!0})}render(){const{query:e,response:t,shouldDisplayYearFilter:r,isPdfFilterSelected:n}=this.state,{layoutOptions:o}=this.props,i=t.stats,s=i.get("venues"),l=i.get("coAuthors");return a.createElement("div",{className:"filter-bar"},r&&a.createElement(Ts.a,{content:this.renderDates()},a.createElement("button",{className:{"filter-bar__button":!0,"filter-bar__button-selected":this.isFiltered("yearFilter")}},Object(f.b)(e=>e.filterBar.filterLabels.date),a.createElement(J.a,{icon:"disclosure",width:"12",height:"12",className:"dropdown-arrow-icon"}))),!l.isEmpty()&&a.createElement(Ts.a,{content:this.renderFilterList(Hs.COAUTHOR.id,l)},a.createElement("button",{className:{"filter-bar__button":!0,"filter-bar__button-selected":this.isFiltered("coAuthors")},"data-selenium-selector":"co-author-facet-filter"},this.getButtonLabel("coAuthors",Object(f.b)(e=>e.filterBar.filterLabels.coAuthor),20),a.createElement(J.a,{icon:"disclosure",width:"12",height:"12",className:"dropdown-arrow-icon"}))),!s.isEmpty()&&a.createElement(Ts.a,{content:this.renderFilterList(Hs.VENUE.id,s)},a.createElement("button",{className:{"filter-bar__button":!0,"filter-bar__button-selected":this.isFiltered("venues")}},this.getButtonLabel("venues",Object(f.b)(e=>e.filterBar.filterLabels.venue),25),a.createElement(J.a,{icon:"disclosure",width:"12",height:"12",className:"dropdown-arrow-icon"}))),a.createElement("button",{className:D()({"filter-bar__button":!0,"filter-bar__has-pdf-button":!0,"filter-bar__button-selected":n}),onClick:this.toggleHasPdf},"Has PDF"),a.createElement("div",{className:"filter-bar__sort-selector-container standard-form"},a.createElement(Ds,{onChangeSort:this.onChangeSort,options:o.sorts,sort:e.sort})))}}Ws(Qs,"contextTypes",{history:K.a.instanceOf(je.a).isRequired,queryStore:K.a.instanceOf(Us.a).isRequired,router:K.a.object.isRequired});var Gs=r(969);class Xs extends a.PureComponent{render(){const e=D()("main-column",this.props.className);return n.a.createElement("main",{className:e},this.props.children)}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Xs,"propTypes",{children:K.a.node,className:K.a.string});var Js=r(856),Zs=r(753),$s=r(795),el=r(926),tl=r(1004),rl=r(729);class al extends a.PureComponent{constructor(){super(...arguments),this.state={showMenu:!1}}triggerDropdownMenu(){this.setState({showMenu:!this.state.showMenu})}render(){const e=D()("icon-button dropdown-button dropdown-button--left-anchored",this.props.className);return n.a.createElement("span",{className:e,"data-selenium-selector":this.props.seleniumSelector},n.a.createElement("span",{className:"dropdown-button__content"},this.props.buttonContent),n.a.createElement(Ts.a,{content:this.props.dropdownContent,showMenu:this.state.showMenu},n.a.createElement("span",{className:"icon-wrapper"},n.a.createElement(J.a,{icon:"disclosure",width:"12",height:"12",className:"icon--down"}))))}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(al,"propTypes",{buttonContent:K.a.node.isRequired,className:K.a.string,dropdownContent:K.a.node.isRequired,seleniumSelector:K.a.string.isRequired});var nl=r(726),ol=r(724),il=r(792),sl=r(159);function ll(){return(ll=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function cl(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ul(e){let t;switch(e){case sl.a.ARXIV:case sl.a.S2:case sl.a.EDUCAUSE:t="fa-pdf";break;default:t="fa-link-out"}return{icon:t,width:"15",height:"15"}}class dl extends a.PureComponent{getLinkClickHandler(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const{onLinkClick:a}=this.props;return()=>{a(...t)}}getPropsForLink(e){let{linkType:t,url:r}=e;return{onClick:this.getLinkClickHandler({linkType:t,linkUrl:r}),onContextMenu:this.getLinkClickHandler({linkType:t,linkUrl:r,isRightClick:!0}),target:"_blank",href:r}}getPrimaryExternalLink(){const{paper:e,className:t}=this.props,r=e.links.first(),a=il.f(r.url);return n.a.createElement(nl.b,{heapProps:{id:ol.t,"link-type":r.linkType,"direct-pdf-link":a,"unpaywall-link":!1,"primary-link":!0,"paper-id":e.id}},n.a.createElement(rl.a,ll({tagName:"a",className:D()("paper-link",t),iconProps:ul(r.linkType),seleniumSelector:"paper-link",text:il.e(r)},this.getPropsForLink(r))))}getExternalLink(e){const t=il.e(e);return n.a.createElement("li",{key:e.url},n.a.createElement("a",ll({"data-selenium-selector":"paper-link",className:"flex-row-vcenter paper-link"},this.getPropsForLink(e)),n.a.createElement(J.a,ul(e.linkType)),t))}getExternalLinkList(e){return n.a.createElement("ul",{className:"paper-link-list truncate-line"},e.map(e=>this.getExternalLink(e)))}renderLinks(e,t){return t.isEmpty()?e:n.a.createElement(al,{buttonContent:e,className:D()("paper-link-dropdown",this.props.className),dropdownContent:this.getExternalLinkList(t),seleniumSelector:"paper-links-dropdown"})}render(){const{paper:{links:e}}=this.props;return e.isEmpty()?null:this.renderLinks(this.getPrimaryExternalLink(),e.slice(1))}}cl(dl,"contextTypes",{dispatcher:K.a.instanceOf(rs.a).isRequired}),cl(dl,"propTypes",{className:K.a.string,paper:K.a.instanceOf(be.a),onLinkClick:K.a.func.isRequired});var hl=r(764),ml=r(240);function pl(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function bl(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?pl(Object(r),!0).forEach((function(t){gl(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pl(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function gl(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class fl extends a.PureComponent{constructor(){super(...arguments),gl(this,"getBaseClickContext",()=>{const{paper:e,rowIndex:t}=this.props,r=[this.context.queryStore,{paperSha:e.id,paperIndex:t}];return Object(ml.a)(...r)}),gl(this,"handleCiteClick",()=>{const{trackActionClick:e,paper:t}=this.props;Object(ml.c)(bl({},this.getBaseClickContext())),e("CITE"),this.context.dispatcher.dispatch(Object(ga.b)({id:ba.b.CITE,data:t}))}),gl(this,"handlePaperLinkClick",e=>{var t,r;const{paper:a}=this.props;B()(a.primaryPaperLink&&"object"==typeof a.primaryPaperLink,"handlePaperLinkClick called without primaryPaperLink"),Object(ml.e)(bl({},this.getBaseClickContext(),{linkType:null!=(r=a)&&null!=(r=r.primaryPaperLink)?r.linkType:r,linkUrl:null!=(t=a)&&null!=(t=t.primaryPaperLink)?t.url:t})),this.props.trackActionClick("PAPER_LINK",e)}),gl(this,"handleLibraryClick",()=>{Object(ml.d)(bl({},this.getBaseClickContext()))})}render(){const{trackActionClick:e,paper:t}=this.props;return a.createElement("div",{className:"paper-actions flex-row"},a.createElement(dl,{onLinkClick:this.handlePaperLinkClick,paper:t}),a.createElement(el.a,{paper:t,onClick:this.handleCiteClick}),a.createElement(hl.b,{paper:t,onSaveClick:this.handleLibraryClick,trackLibraryClick:e}),a.createElement(tl.a,{paper:t}))}}gl(fl,"contextTypes",{dispatcher:K.a.instanceOf(rs.a).isRequired,queryStore:K.a.instanceOf(Us.a).isRequired});var _l=r(990),yl=r(796);class El extends a.PureComponent{render(){return n.a.createElement("div",{className:"histogram__explanation",dangerouslySetInnerHTML:{__html:this.props.html}})}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(El,"propTypes",{html:K.a.string.isRequired});class Ol extends a.PureComponent{render(){return n.a.createElement("h4",{className:"histogram__title"},this.props.text)}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Ol,"propTypes",{text:K.a.string.isRequired});var Sl=r(735);class vl extends a.PureComponent{renderExplanation(){const e=Math.round(100*this.props.citationStats.citationAcceleration.value),t=Qa.a.getString("citations.acceleration.text",e,this.props.citationStats.citationVelocity.lastYear,this.props.citationStats.citationVelocity.lastYear-1);return n.a.createElement(El,{html:t})}renderTitle(){if(this.props.hideLegendTitle)return null;{const e=Qa.a.getString("citations.acceleration.label",Sl.e(this.props.citationStats.citationAcceleration.value));return n.a.createElement(Ol,{text:e})}}renderHistogram(){const e=this.props.citationStats.citedByBuckets.findIndex(e=>e.startKey==this.props.citationStats.citationVelocity.lastYear),t=e-1,r=this.props.citationStats.citedByBuckets.slice(t,e+1),a=[{buckets:r,renderer:yl.a.bucketRenderers.selectedBuckets}];return n.a.createElement("div",{className:"histogram__chart"},n.a.createElement(yl.a,{id:this.props.id,bucketRenderers:a,renderPopover:!0,renderAxis:!0,width:this.props.width,height:yl.a.DEFAULT_HEIGHT,paddingLeftPx:yl.a.DefaultPaddingPx.LEFT,paddingRightPx:yl.a.DefaultPaddingPx.RIGHT,paddingTopPx:yl.a.DefaultPaddingPx.TOP,paddingBottomPx:yl.a.DefaultPaddingPx.BOTTOM,enableBarHoverEffect:!1,minDisplayYears:r.size,popoverLabel:Qa.a.getString("citations.histogram.popoverLabel")}),n.a.createElement("div",{className:"histogram__axis-label"},Qa.a.getString("citations.totalByYear.label")))}render(){const e=D()("box citation-histogram",{"histogram--horizontal":"horizontal"===this.props.layout});return"horizontal"===this.props.layout?n.a.createElement("div",{className:e},this.renderHistogram(),n.a.createElement("div",{className:"histogram__text"},this.renderTitle(),this.renderExplanation())):n.a.createElement("div",{className:e},this.renderTitle(),this.renderHistogram(),this.renderExplanation())}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(vl,"propTypes",{id:K.a.string.isRequired,entityId:K.a.string.isRequired,citationStats:K.a.object.isRequired,width:K.a.number.isRequired,searchResultIndex:K.a.number,hideLegendTitle:K.a.bool,layout:K.a.string});class Cl extends a.PureComponent{renderExplanation(){const e=Math.round(this.props.citationStats.citationVelocity.value),t=Qa.a.getString("citations.average",e,this.props.citationStats.citationVelocity.firstYear,this.props.citationStats.citationVelocity.lastYear);return n.a.createElement(El,{html:t})}renderTitle(){if(this.props.hideLegendTitle)return null;{const e=Qa.a.getString("citations.velocity.label",Sl.f(this.props.citationStats.citationVelocity));return n.a.createElement(Ol,{text:e})}}renderHistogram(){const e=this.props.citationStats.citedByBuckets.findIndex(e=>e.startKey==this.props.citationStats.citationVelocity.firstYear),t=e+this.props.citationStats.citationVelocity.lastYear-this.props.citationStats.citationVelocity.firstYear,r=this.props.citationStats.citedByBuckets.slice(e,t+1),a=[{buckets:r,renderer:yl.a.bucketRenderers.selectedBuckets}];return n.a.createElement("div",{className:"histogram__chart"},n.a.createElement(yl.a,{id:this.props.id,bucketRenderers:a,renderPopover:!0,renderAxis:!0,width:this.props.width,height:yl.a.DEFAULT_HEIGHT,paddingLeftPx:yl.a.DefaultPaddingPx.LEFT,paddingRightPx:yl.a.DefaultPaddingPx.RIGHT,paddingTopPx:yl.a.DefaultPaddingPx.TOP,paddingBottomPx:yl.a.DefaultPaddingPx.BOTTOM,enableBarHoverEffect:!1,minDisplayYears:r.size,popoverLabel:Qa.a.getString("citations.histogram.popoverLabel")}),n.a.createElement("div",{className:"histogram__axis-label"},Qa.a.getString("citations.totalByYear.label")))}render(){const e=D()("box citation-histogram",{"histogram--horizontal":"horizontal"===this.props.layout});return"horizontal"===this.props.layout?n.a.createElement("div",{className:e},this.renderHistogram(),n.a.createElement("div",{className:"histogram__text"},this.renderTitle(),this.renderExplanation())):n.a.createElement("div",{className:e},this.renderTitle(),this.renderHistogram(),this.renderExplanation())}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Cl,"propTypes",{id:K.a.string.isRequired,entityId:K.a.string.isRequired,citationStats:K.a.object.isRequired,width:K.a.number.isRequired,searchResultIndex:K.a.number,hideLegendTitle:K.a.bool,layout:K.a.string});class wl extends a.PureComponent{renderTitle(){const e=Sl.g(Math.round(this.props.citationStats.numCitations.value)),t=this.props.hideLegendTitle?null:"".concat(e," ").concat(Qa.a.getString("citations.estimatedTotal.label"));return t?n.a.createElement(Ol,{text:t}):null}renderExplanation(){let e;if(this.props.citationStats.numCitations.shouldDisplay()){e=Qa.a.getString("citations.estimatedTotal.text",this.props.type||"publication","<strong>".concat(za.e(Math.round(this.props.citationStats.numCitations.value)),"</strong>"))}else e=Qa.a.getString("citations.estimatedTotal.insufficientData");return n.a.createElement(El,{html:e})}renderHistogramContent(){const e=[{buckets:this.props.citationStats.citedByBuckets,renderer:yl.a.bucketRenderers.selectedBuckets}],t=(new Date).getFullYear();return n.a.createElement("div",{className:"histogram__chart"},n.a.createElement(yl.a,{id:this.props.id,bucketRenderers:e,renderPopover:!0,renderAxis:!0,width:this.props.width,height:yl.a.DEFAULT_HEIGHT,paddingLeftPx:"number"==typeof this.props.paddingLeftPx?this.props.paddingLeftPx:yl.a.DefaultPaddingPx.LEFT,paddingRightPx:"number"==typeof this.props.paddingRightPx?this.props.paddingRightPx:yl.a.DefaultPaddingPx.RIGHT,paddingTopPx:"number"==typeof this.props.paddingTopPx?this.props.paddingTopPx:yl.a.DefaultPaddingPx.TOP,paddingBottomPx:"number"==typeof this.props.paddingBottomPx?this.props.paddingBottomPx:yl.a.DefaultPaddingPx.BOTTOM,highlightRecentYears:!1,enableBarHoverEffect:!1,minMaxYear:t,popoverLabel:Qa.a.getString("citations.histogram.popoverLabel")}),n.a.createElement("div",{className:"histogram__axis-label"},Qa.a.getString("citations.totalByYear.label")))}render(){const e=D()("box citation-histogram",{"histogram--horizontal":"horizontal"===this.props.layout});return"horizontal"===this.props.layout?n.a.createElement("div",{className:e},this.props.citationStats.numCitations.shouldDisplay()?this.renderHistogramContent():null,n.a.createElement("div",{className:"histogram__text"},this.renderTitle(),this.renderExplanation())):n.a.createElement("div",{className:e},this.renderTitle(),this.props.citationStats.numCitations.shouldDisplay()?this.renderHistogramContent():null,this.renderExplanation())}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(wl,"propTypes",{id:K.a.string.isRequired,entityId:K.a.string.isRequired,citationStats:K.a.object.isRequired,type:K.a.string,width:K.a.number.isRequired,searchResultIndex:K.a.number,hideLegendTitle:K.a.bool,layout:K.a.string,paddingLeftPx:K.a.number,paddingRightPx:K.a.number,paddingTopPx:K.a.number,paddingBottomPx:K.a.number});var Pl=r(744),Nl=r(166),xl=r(236),jl=r(791);function Rl(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Tl extends a.PureComponent{constructor(){super(...arguments),this.trackStatHoverEvent=this.trackStatHoverEvent.bind(this)}trackStatHoverEvent(e){const t=this.context.analyticsLocation;if(t){const{id:r,index:a}=this.props,n=$t.a.getIn(t,"STAT");Object(nr.a)(jl.a.create(n,{statName:e,id:r,index:a}))}else w.a.warn("You need to add analyticsLocation to context so that we know where this action event happened.")}hasStats(){return this.props.citationStats.citationVelocity.shouldDisplay()||this.props.citationStats.hasKeyCitations()||this.props.externalContentStats.length>0}statCssClass(e){let t="search-result__stat";return this.props.showSortStat&&(t=D()("search-result__stat",{"is-active":this.context.queryStore.getQuery().sort===e})),t}renderCitationVelocity(){if(this.props.citationStats.citationVelocity.shouldDisplay()){const e=n.a.createElement(Cl,{width:350,id:this.props.id+"Popover",citationStats:this.props.citationStats,entityId:this.props.id,searchResultIndex:this.props.index});return n.a.createElement("li",{className:this.statCssClass(Vs.a.CITATION_VELOCITY.id),"data-selenium-selector":"search-result-citation-velocity"},n.a.createElement(Pl.a,{tooltipClassName:"tooltip--default-size",tooltipContent:e,tooltipPosition:"bottom-left",onShow:()=>{this.trackStatHoverEvent("Citation Velocity")}},n.a.createElement(J.a,{width:"15",height:"15",icon:"chart",className:"fill--orange"}),Sl.f(this.props.citationStats.citationVelocity)))}return null}renderInfluentialCitations(){if(this.props.citationStats.hasKeyCitations()){const e=this.props.citationStats.numKeyCitations,t=Qa.a.getString("citations.influential.text"),r=za.l(e,Qa.a.getString("citations.influential.label")),a=n.a.createElement(n.a.Fragment,null,n.a.createElement("h4",null,r),n.a.createElement(p.a,{content:t}));return n.a.createElement("li",{className:this.statCssClass(Vs.a.INFLUENTIAL_CITATIONS.id),"data-selenium-selector":"search-result-influential-citations"},n.a.createElement(Pl.a,{tooltipClassName:"tooltip--default-size",className:"flex-row-vcenter",tooltipContent:a,tooltipPosition:"bottom-left",onShow:()=>{this.trackStatHoverEvent("Highly Influential Citation")}},n.a.createElement(J.a,{icon:"theorems",width:"12",height:"12",className:"fill--orange"}),za.e(this.props.citationStats.numKeyCitations)))}return null}renderCitationAcceleration(){if(this.props.citationStats.citationAcceleration.shouldDisplay()){const e=this.props.citationStats.citationAcceleration.value,t=n.a.createElement(vl,{width:350,id:this.props.id+"Popover",citationStats:this.props.citationStats,entityId:this.props.id,searchResultIndex:this.props.index});let r="trending-neutral";return e>0&&(r="trending-up"),e<0&&(r="trending-down"),n.a.createElement("li",{className:this.statCssClass(Vs.a.CITATION_ACCELERATION.id),"data-selenium-selector":"search-result-citation-acceleration"},n.a.createElement(Pl.a,{tooltipClassName:"tooltip--default-size",tooltipContent:t,tooltipPosition:"bottom-left",onShow:()=>{this.trackStatHoverEvent("Citation Acceleration")}},n.a.createElement(J.a,{icon:r,width:"15",height:"15",className:"fill--orange"}),Sl.e(e)))}return null}renderTotalCitations(){if(this.props.citationStats.numCitations.shouldDisplay()){const e=n.a.createElement(wl,{width:350,id:this.props.id+"Popover",citationStats:this.props.citationStats,entityId:this.props.id,searchResultIndex:this.props.index});return n.a.createElement("li",{className:this.statCssClass(Vs.a.TOTAL_CITATIONS.id),"data-selenium-selector":"search-result-total-citations"},n.a.createElement(Pl.a,{tooltipClassName:"tooltip--default-size",className:"flex-row-vcenter",tooltipContent:e,tooltipPosition:"bottom-left"},n.a.createElement(J.a,{icon:"cited-by",width:"15",height:"15",className:"fill--orange"}),Sl.g(this.props.citationStats.numCitations.value)))}return null}renderExternalContentStats(){const e=this.props.externalContentStats.find(e=>e.contentType===Nl.a.VIDEO),t=void 0!==e?e.count:0,r=Qa.a.getString("externalContent.video.videoStatText"),a=za.l(t,Qa.a.getString("externalContent.video.videoStatHeader")),o=n.a.createElement(n.a.Fragment,null,n.a.createElement("h4",null,n.a.createElement(p.a,{content:a})),r);if(this.props.externalContentStats)return void 0!==e?n.a.createElement("li",{className:this.statCssClass(Vs.a.VIDEO_CONTENT),"data-selenium-selector":"search-result-video"},n.a.createElement(Pl.a,{tooltipClassName:"tooltip--default-size",className:"flex-row-center",tooltipContent:o,tooltipPosition:"bottom-left",onShow:()=>{this.trackStatHoverEvent("Video Content")}},n.a.createElement(J.a,{icon:"video-filled",width:"15",height:"15",className:"fill--orange"}),t)):null}renderSortStat(){if(!this.props.showSortStat)return null;switch(this.context.queryStore.getQuery().sort){case Vs.a.TOTAL_CITATIONS.id:return this.renderTotalCitations();case Vs.a.CITATION_ACCELERATION.id:return this.renderCitationAcceleration();default:return null}}render(){return this.hasStats()?n.a.createElement("div",{className:"search-result__stats flex-row"},this.renderInfluentialCitations(),this.renderCitationVelocity(),this.renderSortStat(),this.renderExternalContentStats()):null}}function Al(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Il(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Rl(Tl,"propTypes",{citationStats:K.a.object.isRequired,id:K.a.string.isRequired,index:K.a.number.isRequired,showSortStat:K.a.bool,externalContentStats:K.a.objectOf(xl.a)}),Rl(Tl,"contextTypes",{queryStore:K.a.instanceOf(Us.a).isRequired,analyticsLocation:K.a.object});class kl extends a.PureComponent{constructor(){super(...arguments),Il(this,"trackActionClick",(e,t)=>{this.handleAnalyticsEvent("Action",e,t)})}handleAnalyticsEvent(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=this.context.analyticsLocation,{index:n,result:o}=this.props,i=o.id;if(a){const o=$t.a.getIn(a,e,t),s=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Al(Object(r),!0).forEach((function(t){Il(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Al(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},r,{index:n,paperId:i});Object(nr.a)(rn.a.create(o,s))}else w.a.warn("You need to add analyticsLocation to context so that we know where this action event happened.")}render(){const{className:e,index:t,onTitleClick:r,children:n,result:o,layout:i}=this.props,s=a.createElement(a.Fragment,null,a.createElement(Tl,{citationStats:o.citationStats,externalContentStats:o.externalContentStats,id:o.id,index:t,showSortStat:i.showSortStat}),a.createElement(fl,{paper:o,rowIndex:t,trackActionClick:this.trackActionClick}));return a.createElement(_l.a,{paper:o,index:t,onTitleClick:r,className:e,children:n,paperActions:s})}}Il(kl,"contextTypes",{analyticsLocation:K.a.object}),Il(kl,"propTypes",{result:K.a.object.isRequired,index:K.a.number.isRequired,layout:K.a.object.isRequired,onTitleClick:K.a.func,className:K.a.string});class Fl extends a.PureComponent{render(){const{side:e,className:t,children:r}=this.props;return n.a.createElement("section",{className:"sidebar sidebar-".concat(e)},n.a.createElement("div",{className:D()("column-wrapper",t)},r))}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Fl,"propTypes",{className:K.a.string,side:K.a.string.isRequired,children:K.a.node});var Dl=r(51),Ll=r(53),ql=r(228),Ml=r.n(ql);function Hl(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function zl(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Ul extends a.PureComponent{constructor(e,t){super(e,t),zl(this,"onClickShowPublications",()=>{this.setState({showPublications:!0,showInfluenceGraph:!1})}),zl(this,"onClickShowInfluenceGraph",()=>{this.setState({showPublications:!1,showInfluenceGraph:!0})}),zl(this,"loadPage",e=>{if(e!==this.state.query.page){let t=Ml.a.findDOMNode(this),r=null;t instanceof HTMLElement&&(r=Dl.a.offsetFromBody(t)),Dl.a.scrollTop(this.props.layoutOptions.scrollToTopOfPage?0:r),this.context.queryStore.routeToPage(e,this.context.router)}}),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Hl(Object(r),!0).forEach((function(t){zl(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Hl(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({showPublications:!0,showInfluenceGraph:!1},this.stateFromQueryStore()),t.queryStore.registerComponent(this,()=>{this.setState(this.stateFromQueryStore())})}stateFromQueryStore(){const e=this.context.queryStore._state;return{queryStoreState:e,query:this.context.queryStore._query,response:this.context.queryStore._response,isFiltering:e===Ll.a.FILTERING}}componentDidUpdate(e,t){if(!oe.a.is(t.response,this.state.response)&&!this.state.response.results.isEmpty()){const e=Dl.a.scrollTop(),t=this.refs["search-result-".concat(this.state.response.results.size-1)];if(t){const r=Dl.a.offsetFromBody(t);r<e&&Dl.a.scrollTop(r-20)}}}renderResults(){const{layoutOptions:{searchResultLayout:e}}=this.props,{query:t,response:{results:r}}=this.state;return r.map((r,n)=>a.createElement(kl,{result:r,key:r.id,index:(t.page-1)*t.pageSize+n,ref:"search-result-".concat(n),layout:e}))}renderNoResults(){const{querySuggestions:e}=this.state.response,t=!(e&&!e.isEmpty())?void 0:e.first().text;return a.createElement(bs.a,{query:this.state.query.queryString,hasFacets:this.state.response.hasFacets(),suggestedQuery:t})}renderAuthor(){const{isFiltering:e,response:t,query:r,showPublications:n,showInfluenceGraph:o}=this.state,{layoutOptions:i,author:s,claimedAuthorId:l}=this.props,{results:c,matchedAuthors:u}=t;return a.createElement(ms,null,a.createElement(Fl,{className:"filter",side:"left"},a.createElement(hs.a,null),a.createElement(js.a,{feature:e=>e.AuthorRecommendations},a.createElement(Rs.a,null,a.createElement($s.a,{experiment:ha.b.AuthorRecommendationsUX,eligibilityTest:()=>s.skipperExperiments.memberOf(ha.b.AuthorRecommendationsData.KEY)},a.createElement(ps.b,null,null),a.createElement(ps.c,{variation:"local_hint"},()=>a.createElement(xs,{author:s})),a.createElement(ps.c,{variation:"global_hint"},()=>a.createElement(xs,{author:s,useGlobalExplanation:!0})))))),a.createElement(Xs,{className:"results"},a.createElement("div",{className:"author-page-content-tabs"},a.createElement("ul",{className:"author-page-content-tabs__list"},a.createElement("li",{key:"publications",onClick:this.onClickShowPublications,className:D()({"is-active":n})},a.createElement(J.a,{icon:"tab-papers",width:"9",height:"12"}),Object(f.b)(e=>e.author.tabs.papers)),a.createElement("li",{key:"influence",onClick:this.onClickShowInfluenceGraph,className:D()({"is-active":o})},a.createElement(J.a,{icon:"tab-influence",width:"21",height:"21"}),a.createElement("span",{className:"author-page-content-tab__influence-label"},Object(f.b)(e=>e.author.tabs.influence))))),u.isEmpty()?null:a.createElement(Js.a,{queryString:r.queryString,authors:u}),n&&a.createElement(a.Fragment,null,a.createElement(Qs,{layoutOptions:i}),a.createElement("hr",{className:"author-page-divider"}),a.createElement("div",{className:"author-page-content__claim-ad"},!l&&!s.isClaimedByAuthor&&a.createElement(ds,null)),a.createElement("div",{className:D()("result-page",{"is-filtering":e})},c.isEmpty()?this.renderNoResults():this.renderResults()),a.createElement("div",{className:"flex-row"},t.totalPages>1&&a.createElement(Zs.a,{className:"flex-right",loadPage:this.loadPage,pageNumber:r.page,totalPages:t.totalPages}))),o&&a.createElement(Gs.a,{author:s})))}render(){const{queryStoreState:e}=this.state;return e===Ll.a.LOADING?a.createElement("section",{className:"content",role:"main",id:"main-content"},a.createElement("div",{className:"container loading-controls flex-row-vcenter"},a.createElement(Ce.a,{seleniumSelector:"icon-loading-serp"})," Loading results")):a.createElement("section",{className:"content"},this.renderAuthor())}}zl(Ul,"contextTypes",{queryStore:K.a.instanceOf(Us.a).isRequired,router:K.a.object.isRequired});var Vl=r(858);class Bl extends a.PureComponent{render(){const{author:e,claimedAuthorId:t}=this.props,r=new Ks({showSortExplanation:!0,filtersExpandedByDefault:!0,showResultCount:!1,sortDisplayType:"tabs",scrollToTopOfPage:!1,searchResultLayout:{showSortStat:!0},sorts:Vs.a.authorPaperSearch()});return a.createElement("div",{className:"author-page-content-section"},a.createElement("div",{className:"author-publications-list"},a.createElement(Ul,{layoutOptions:r,author:e,claimedAuthorId:t})))}}var Yl=Object(Vl.a)($t.a.AuthorHomePage.Publications)(Bl);class Kl extends a.PureComponent{constructor(e){super(e)}render(){const{author:e,claimedAuthorId:t}=this.props;return a.createElement(a.Fragment,null,e.isClaimedBySignedInUser&&e.hasPendingCorrections&&a.createElement("div",{className:"author-page__corrections-pending"},a.createElement(J.a,{icon:"status-waiting"}),a.createElement("div",{className:"author-page__corrections-pending__label"},Object(f.b)(e=>e.author.correctionPending.label))),a.createElement("div",{className:"container author-page-content",role:"main"},a.createElement(Yl,{author:e,claimedAuthorId:t,ref:"author-search-results"})))}}var Wl=r(29);function Ql(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Gl(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ql(Object(r),!0).forEach((function(t){Xl(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ql(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Xl(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Jl extends a.Component{constructor(){super(...arguments);const{authStore:e,authorStore:t,queryStore:r}=this.context;this.state=Gl({},this.getStateFromAuthorStore(),{},this.getStateFromAuthStore()),t.registerComponent(this,()=>{this.setState(this.getStateFromAuthorStore)}),r.registerComponent(this,()=>{this.setState({loading:t.isLoading()||r.isLoading()})}),e.registerComponent(this,()=>{this.setState(this.getStateFromAuthStore())})}getStateFromAuthorStore(){const e=this.context.authorStore,t=this.context.queryStore;return{loading:e.isLoading()||t.isLoading(),author:e.author}}getStateFromAuthStore(){return{claimedAuthorId:this.context.authStore.getClaimedAuthorId()}}renderLoading(){return a.createElement("div",{className:"flex-row-vcenter loading container",role:"main",id:"main-content"},a.createElement(Ce.a,{seleniumSelector:"icon-loading-ahp"}),"Loading author")}scrollToSearchResults(){const{history:e}=this.context,t=Object(Wl.l)(e.location.search);if(t.scrollToResults&&!this.state.loading){const r=Ml.a.findDOMNode(this.refs["author-search-results"]);r instanceof HTMLElement&&Dl.a.smoothScrollTo(r,()=>{e.replace({pathname:e.location.pathname,search:Object(Wl.a)(Gl({},t))})})}}componentDidUpdate(){this.scrollToSearchResults()}componentDidMount(){this.scrollToSearchResults()}render(){const{author:e,claimedAuthorId:t,loading:r}=this.state;return a.createElement(Sr.a,{footer:!r,className:"author-page"},r?this.renderLoading():a.createElement("div",{className:"author-page-layout"},a.createElement("div",{className:"content"},e&&a.createElement(Kl,{author:e,claimedAuthorId:t}))),Object(wr.b)(this.props.route.routes))}}function Zl(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-AuthorPage"),a.createElement(Jl,e)}Xl(Jl,"contextTypes",{api:K.a.instanceOf(pe.a).isRequired,authStore:K.a.instanceOf(Ne.a).isRequired,authorStore:K.a.instanceOf(H.a).isRequired,history:K.a.instanceOf(je.a).isRequired,queryStore:K.a.instanceOf(Us.a).isRequired});var $l=r(1);class ec extends a.Component{static getPageTitle(e){let{authorStore:t}=e;const{author:r}=t;return r&&r.name?Object(f.b)(e=>e.author.pageTitleWithAuthor,r.name):Object(f.b)(e=>e.author.pageTitleWithoutAuthor)}static getPageMetaDescription(e){let{authorStore:t}=e;if(t.author)return t.author.authorPageMetaDescription()}static getCanonicalUrl(e){if(e.params.slug){const{authorId:t,slug:r}=e.params;return Object(ge.d)({routeName:"AUTHOR_PROFILE",params:{authorId:t,slug:r}})}}static async willRouteTo(e,t){const{authorStore:r,authStore:a,api:n,dispatcher:o}=e,{authorId:i,slug:s}=t.params;r.isNewOrCanonicalAuthor(i,s)&&o.dispatch({actionType:$l.a.actions.QUERY_UPDATED,query:{}});const l=[Us.a.executeAHPQuery(e,t)];return a.hasAuthenticatedUser()&&i&&l.push(n.findAlertByQueryTypeAndValue(Ha.b.AUTHOR_PAPER,i),n.findAlertByQueryTypeAndValue(Ha.b.AUTHOR_CITATION,i)),Promise.all(l)}render(){return a.createElement(Zl,this.props)}}var tc=r(178);function rc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function ac(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class nc extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),this.onChangeInput=this.onChangeInput.bind(this),this.onClickApprove=this.onClickApprove.bind(this),this.onClickDeny=this.onClickDeny.bind(this),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?rc(Object(r),!0).forEach((function(t){ac(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rc(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromAuthStore(),{approveDisabled:!1,denyDisabled:!1,newModerationStatus:null,moderatorNotes:null,errorMessage:null}),this.context.authStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthStore())})}getStateFromAuthStore(){return{moderatorEmail:this.context.authStore.getEmail()}}onClickApprove(){this.setState({denyDisabled:!1,approveDisabled:!0,newModerationStatus:vr.b.Approved},()=>this.handleClickEvent())}onClickDeny(){this.setState({denyDisabled:!0,approveDisabled:!1,newModerationStatus:vr.b.Denied},()=>this.handleClickEvent())}onChangeInput(e){this.setState({moderatorNotes:e.currentTarget.value})}handleClickEvent(){this.handleModeration()}_missingParamError(e){throw new Error("Operation failed, missing param: ".concat(e))}async handleModeration(){const e=this.state.moderatorNotes?this.state.moderatorNotes.trim():null,t=this.state.newModerationStatus?this.state.newModerationStatus.toString():this._missingParamError("moderationStatus"),r={paperAuthorCorrectionId:this.props.paperAuthorCorrection.id,moderationStatus:t,moderatorNotes:e,moderator:this.state.moderatorEmail.trim()};await Object(me.d)(this,{errorMessage:null});try{await this.context.api.updateModerationStatusForPaperAuthorCorrection(r)}catch(e){await Object(me.d)(this,{errorMessage:Object(f.b)(e=>e.authorClaimModeration.error.apiFailed)})}}renderTop(){const{paperAuthorCorrection:e}=this.props;return a.createElement("tr",{className:"authorship-moderation__table__details-row"},a.createElement("td",null,e.createdAtUnix&&Pa()(1e3*e.createdAtUnix).format("LLL")),a.createElement("td",null,e.correctionType),a.createElement("td",null,a.createElement(Be.a,{to:"AUTHOR_PROFILE_BY_ID",params:{authorId:e.authorId}},a.createElement("em",null,e.authorId))),a.createElement("td",null,a.createElement(Be.a,{to:"PAPER_DETAIL_BY_ID",params:{paperId:e.paperHash}},a.createElement("em",null,e.paperHash&&e.paperHash.slice(-6)))),a.createElement("td",{className:"authorship-moderation__button-row"},a.createElement(rl.a,{onClick:this.onClickApprove,disabled:this.state.approveDisabled,className:"authorship-moderation__button__approve button button--primary",text:Object(f.b)(e=>e.authorClaimModeration.buttons.approveLabel),iconProps:{icon:"thumbs-up",width:"16",height:"16"},"data-selenium-selector":"save-moderation-status-button"}),a.createElement(rl.a,{onClick:this.onClickDeny,disabled:this.state.denyDisabled,className:"authorship-moderation__button__deny button button--primary",text:Object(f.b)(e=>e.authorClaimModeration.buttons.denyLabel),iconProps:{icon:"thumbs-down",width:"16",height:"16"},"data-selenium-selector":"save-moderation-status-button"})),a.createElement("td",{rowSpan:"2"},a.createElement("textarea",{typs:"textarea",name:"moderatorNotes",className:"legacy__textarea authorship-moderation__field__moderator-notes__input-text",onChange:this.onChangeInput})))}renderBottom(){return a.createElement("tr",null,a.createElement("td",{colSpan:"100",className:"authorship-moderation__table__correction-td"},"[ THIS IS WHERE WE WILL RENDER THE CORRECTION TO BE APPLIED ]"))}render(){return a.createElement(a.Fragment,null,this.renderTop(),this.renderBottom())}}function oc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function ic(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}ac(nc,"propTypes",{paperAuthorCorrection:K.a.object.isRequired}),ac(nc,"contextTypes",{api:K.a.instanceOf(pe.a).isRequired,authStore:K.a.instanceOf(Ne.a).isRequired});class sc extends a.Component{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?oc(Object(r),!0).forEach((function(t){ic(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oc(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromAuthorshipModerationStore()),this.context.authorshipModerationStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorshipModerationStore())})}getStateFromAuthorshipModerationStore(){return{pendingCorrections:this.context.authorshipModerationStore.getPendingPaperAuthorCorrectionRecords()}}render(){const e=this.state.pendingCorrections;return a.createElement("div",{className:"authorship-moderation"},a.createElement("div",{className:"authorship-moderation__columns"},a.createElement("main",{className:"authorship-moderation__column authorship-moderation__main"},a.createElement("h1",{className:"authorship-moderation__headline"},"Authorship Correction Moderation"),e.size>0?a.createElement("table",{className:"authorship-moderation__table"},a.createElement("thead",{className:"authorship-moderation__table-header"},a.createElement("tr",null,a.createElement("th",null,"CREATED"),a.createElement("th",null,"TYPE"),a.createElement("th",null,"AUTHOR"),a.createElement("th",null,"PAPER"),a.createElement("th",null,"ACTION"),a.createElement("th",null,"NOTES"))),a.createElement("tbody",null,e.map(e=>a.createElement(nc,{paperAuthorCorrection:e,key:e.id})))):a.createElement("h2",null,"Cool, no pending authorship corrections!"))))}}function lc(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-AuthorshipModerationPage"),a.createElement(sc,e)}function cc(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}ic(sc,"contextTypes",{api:K.a.instanceOf(pe.a).isRequired,authorshipModerationStore:K.a.instanceOf(tc.a).isRequired});class uc extends a.Component{render(){return a.createElement(lc,null)}}cc(uc,"getPageTitle",()=>Object(f.b)(e=>e.authorshipModeration.pageTitle)),cc(uc,"requiresAuthentication",()=>!0);var dc=r(976),hc=r(977),mc=r(973),pc=r(981),bc=r(931);function gc(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-CrawlerPage"),a.createElement(bc.b,e)}function fc(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class _c extends a.Component{render(){return a.createElement(gc,null)}}fc(_c,"getPageMetaDescription",()=>Object(f.b)(e=>e.metaDescription.crawlerPage.content)),fc(_c,"getPageTitle",()=>[Object(f.b)(e=>e.metaDescription.crawlerPage.title),Object(f.b)(e=>e.general.appName)].join(" | "));var yc=r(898);function Ec(){return a.createElement(yc.a,null)}function Oc(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-CreateAlertPage"),a.createElement(Ec,e)}class Sc extends a.Component{static getPageTitle(e){let{alertsStore:t}=e;const{newAlert:r}=t;B()(r,"There must be a newAlert in the alertsStore to render the CreateAlertsPage");const{queryType:a}=r,n=Object(f.b)(e=>e.alerts.create[a].title),o=Object(f.b)(e=>e.general.appName);return"".concat(n," | ").concat(o)}static async willRouteTo(e){let{alertsStore:t}=e;if(!t.isCreatingAlert())return new St.a({path:ge.b.HOME,replace:!0})}render(){return a.createElement(Oc,null)}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Sc,"requiresAuthentication",()=>!0);var vc=r(932),Cc=r(933),wc=r(714);function Pc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Nc(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Pc(Object(r),!0).forEach((function(t){xc(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pc(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function xc(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class jc extends a.Component{constructor(){super(...arguments),xc(this,"state",{activeName:null,activeExampleConfig:null,examplePropValues:{},selectedExampleIndex:0}),xc(this,"_previewRef",null),xc(this,"onChangeExample",e=>{const{value:t}=e.currentTarget,r=this.state.activeExampleConfig;if(!r)return;const a=parseInt(t,10),n=Object(vc.b)(r,a);this.setState({selectedExampleIndex:a,examplePropValues:n},()=>{this.replaceQueryString()})}),xc(this,"onChangeField",(e,t)=>{const{examplePropValues:r}=this.state;t in r&&this.setState({examplePropValues:Nc({},r,{[t]:e})},()=>{this.sendPropsToPreview(this.state.examplePropValues).catch(e=>{w.a.error("Failed to send props to preview",e)})})}),xc(this,"setPreviewRef",e=>{this._previewRef=e})}componentDidMount(){this.checkAndLoadComponent(this.props,this.state)}componentDidUpdate(){this.checkAndLoadComponent(this.props,this.state)}checkAndLoadComponent(e,t){const r=e.componentName;r!==t.activeName&&(r?this.loadComponent(r):this.setState({activeName:null,activeExampleConfig:null,examplePropValues:{},selectedExampleIndex:0}))}async loadComponent(e){await Object(me.d)(this,{activeName:e});const t=Cc.a[e]||null;if(!t)return;const r=await t();if(this.state.activeName!==e)return;const a=function(e){const t=e.location.search.replace(/^\?/,""),{example:r}=ri.a.parse(t),a=parseInt(r,10);return isNaN(a)?0:a}(this.context.history),n=r.exampleConfig||null;this.setState({activeExampleConfig:n,examplePropValues:Object(vc.b)(n,a),selectedExampleIndex:a})}async sendPropsToPreview(e){var t;const r=(null!=(t=this._previewRef)&&null!=(t=t.contentWindow)?t.updateExampleComponentProps:t)||null;B()(r,"Preview page is not ready to receive props"),await r(Nc({},e))}replaceQueryString(){const{selectedExampleIndex:e}=this.state,t=this.context.history;t.replace({pathname:t.location.pathname,search:ri.a.stringify({example:e||0})})}renderMenu(e){return a.createElement(Ic,null,Object.keys(e).map(t=>a.createElement(kc,{key:t},a.createElement(Ac,null,t),(e=>Array.isArray(e)?a.createElement(Ic,null,e.map(e=>a.createElement(kc,{key:e},a.createElement(Be.a,{to:"DEBUG_COMPONENT_LIBRARY_COMPONENT",params:{component:e}},e)))):this.renderMenu(e))(e[t]))))}render(){var e,t;const{activeName:r,activeExampleConfig:n,examplePropValues:o,selectedExampleIndex:i}=this.state,s=(null!=(t=n)?t.fields:t)||[],l=(null!=(e=n)?e.examples:e)||[],c=l[i]||null,u=r?Object(wc.a)(ge.b.DEBUG_COMPONENT_LIBRARY_PREVIEW,{component:r,exampleIndex:i||0}):null;return a.createElement(Rc,null,a.createElement(Tc,null,this.renderMenu(Cc.b)),a.createElement(Fc,null,a.createElement("h2",null,r||"Choose Component"),a.createElement(Dc,{key:u,src:u,ref:this.setPreviewRef}),a.createElement(Lc,null,a.createElement("a",{href:u},"Example: "),a.createElement(qc,{onChange:this.onChangeExample,value:i||0},l.map((e,t)=>a.createElement(Mc,{key:"".concat(e.title,"|").concat(t),value:t},e.title)))),a.createElement(Hc,null,c&&a.createElement(a.Fragment,null,a.createElement(zc,null,c.desc),s.map(e=>a.createElement(Uc,{key:"".concat(c.title,"|").concat(e.name)},a.createElement(Vc,null,a.createElement(Bc,null,e.name),a.createElement(Yc,null,e.desc)),a.createElement(Kc,null,Object(vc.d)(e,o[e.name],this.onChangeField))))))))}}xc(jc,"contextTypes",{history:K.a.instanceOf(je.a).isRequired});const Rc=Na.b.div.withConfig({displayName:"DebugComponentLibraryPage__Layout",componentId:"sc-1cto3i1-0"})(["display:flex;height:100%;"]),Tc=Na.b.nav.withConfig({displayName:"DebugComponentLibraryPage__Menu",componentId:"sc-1cto3i1-1"})(["flex:0 0 auto;padding:32px 16px;margin-right:16px;height:100%;overflow-y:scroll;"]),Ac=Na.b.div.withConfig({displayName:"DebugComponentLibraryPage__MenuTitle",componentId:"sc-1cto3i1-2"})(["font-weight:bold;"]),Ic=Na.b.ul.withConfig({displayName:"DebugComponentLibraryPage__MenuList",componentId:"sc-1cto3i1-3"})(["margin-left:16px;margin-bottom:8px;"]),kc=Na.b.li.withConfig({displayName:"DebugComponentLibraryPage__MenuItem",componentId:"sc-1cto3i1-4"})([""]),Fc=Na.b.div.withConfig({displayName:"DebugComponentLibraryPage__Preview",componentId:"sc-1cto3i1-5"})(["flex:1 1 auto;display:flex;flex-direction:column;"]),Dc=Na.b.iframe.withConfig({displayName:"DebugComponentLibraryPage__PreviewCanvas",componentId:"sc-1cto3i1-6"})(["flex:1 1 auto;"]),Lc=Na.b.div.withConfig({displayName:"DebugComponentLibraryPage__PreviewExample",componentId:"sc-1cto3i1-7"})([""]),qc=Na.b.select.withConfig({displayName:"DebugComponentLibraryPage__ExamplesDropdown",componentId:"sc-1cto3i1-8"})([""]),Mc=Na.b.option.withConfig({displayName:"DebugComponentLibraryPage__ExampleChoice",componentId:"sc-1cto3i1-9"})([""]),Hc=Na.b.div.withConfig({displayName:"DebugComponentLibraryPage__PreviewForm",componentId:"sc-1cto3i1-10"})(["flex:1 1 auto;margin-top:1em;"]),zc=Na.b.div.withConfig({displayName:"DebugComponentLibraryPage__PreviewDesc",componentId:"sc-1cto3i1-11"})([""]),Uc=Na.b.div.withConfig({displayName:"DebugComponentLibraryPage__PreviewField",componentId:"sc-1cto3i1-12"})(["margin-top:6px;"]),Vc=Na.b.div.withConfig({displayName:"DebugComponentLibraryPage__PreviewFieldMeta",componentId:"sc-1cto3i1-13"})(["display:flex;"]),Bc=Na.b.div.withConfig({displayName:"DebugComponentLibraryPage__PreviewFieldName",componentId:"sc-1cto3i1-14"})(["flex:0 0 auto;margin-right:16px;font-weight:700;font-family:monospace;"]),Yc=Na.b.div.withConfig({displayName:"DebugComponentLibraryPage__PreviewFieldDesc",componentId:"sc-1cto3i1-15"})(["flex:1 1 auto;"]),Kc=Na.b.div.withConfig({displayName:"DebugComponentLibraryPage__PreviewFieldInput",componentId:"sc-1cto3i1-16"})(["margin-left:16px;"]);function Wc(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("library-DebugComponentLibraryPage"),a.createElement(jc,e)}class Qc extends a.Component{render(){var e;const t=(null!=(e=this.props)&&null!=(e=e.match)&&null!=(e=e.params)?e.component:e)||null;return a.createElement(Wc,{componentName:t})}}var Gc=r(982),Xc=r(875);class Jc extends a.Component{render(){const e=Xc.b.keySeq().sort();return a.createElement("div",{style:{margin:"20px"}},a.createElement("h2",null,"Displaying ",Xc.b.size," Sprites"),a.createElement("div",{style:{display:"flex",flexWrap:"wrap"}},e.map(e=>a.createElement("div",{key:e,style:{border:"3px solid",margin:"10px",padding:"20px"}},a.createElement(J.a,{icon:e,width:"40",height:"40"}),a.createElement("span",{style:{marginLeft:"10px"}},e)))))}}function Zc(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("shared-DebugSpritesPage"),a.createElement(Jc,e)}class $c extends a.Component{render(){return a.createElement(Zc,null)}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}($c,"pageTitle",()=>Object(f.b)(e=>e.general.appName));var eu=r(983),tu=r(934),ru=r(967),au=r(154),nu=r(935),ou=r(1e3);class iu extends a.PureComponent{constructor(){super(...arguments),this.state={top:0,bottom:0},this.onScroll=this.onScroll.bind(this)}onScroll(){this.setOffsets(this.getIsActive)}getIsActive(){const e=document.documentElement.scrollHeight-window.innerHeight,t=Dl.a.scrollTop(),r=this.props.verticalOffsetPx?t+this.props.verticalOffsetPx:t,{top:a,bottom:n}=this.state;(r>=a&&r<=n||r>=e)&&this.props.onActive&&this.props.onActive()}setOffsets(e){const t=Dl.a.offsetFromBody(this.refs.container);this.setState({top:t,bottom:t+this.refs.container.scrollHeight},e)}componentDidMount(){this.setOffsets(this.getIsActive),Dl.a.listenForScroll(this.onScroll)}componentWillUnmount(){Dl.a.stopListeningForScroll(this.onScroll)}render(){return n.a.createElement("div",{ref:"container"},this.props.children)}}function su(){return(su=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(iu,"propTypes",{onActive:K.a.func,verticalOffsetPx:K.a.number,children:Object(za.n)(K.a.element,K.a.arrayOf(K.a.element))});class lu extends a.PureComponent{constructor(){super(...arguments),this.state={stuck:!1},this.onScroll=this.onScroll.bind(this)}onScroll(){this.setState({stuck:Dl.a.scrollTop()>this._breakpoint})}componentDidMount(){this._breakpoint=Dl.a.offsetFromBody(this.refs.container)-this.props.offset,Dl.a.listenForScroll(this.onScroll)}componentWillUnmount(){Dl.a.stopListeningForScroll(this.onScroll)}render(){let e=this.props.className||"";this.state.stuck&&(e+=" is-stuck");const t=this.state.stuck?{position:"fixed",top:this.props.offset||0}:null;return n.a.createElement("div",su({},this.props,{className:e,ref:"container",style:t}),this.props.children)}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(lu,"propTypes",{offset:K.a.number,className:K.a.string,children:K.a.any});class cu extends a.PureComponent{static propTypes(){return{name:K.a.string.isRequired,href:n.a.Proptypes.string.isRequired,isActive:K.a.bool}}constructor(){super(...arguments),this.trackNavClick=this.trackNavClick.bind(this)}trackNavClick(){Object(nr.a)(rn.a.create($t.a.STICKY_NAV,{section:this.props.name}))}render(){const e="#".concat(this.props.href),t=D()("sticky-nav__item",{"is-active":this.props.isActive});return n.a.createElement("li",{className:t},n.a.createElement("a",{className:"sticky-nav__item__link flex-row-vcenter",href:e,onClick:this.trackNavClick},this.props.name))}}r(139);class uu extends a.PureComponent{render(){const e=D()("sticky-nav",this.props.className),t=this.props.navSections&&this.props.navSections.map((e,t)=>a.createElement(cu,{key:"sticky-nav-".concat(t),name:e.get("name"),href:e.get("id"),isActive:e.get("id")===this.props.activeNavId}));return a.createElement(lu,{offset:70},a.createElement("nav",{className:e},a.createElement("ul",{"data-selenium-selector":"sticky-nav-items"},t)))}}var du=r(936);r(24);function hu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function mu(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class pu extends a.Component{constructor(e,t){super(e,t),mu(this,"onChangeActiveNav",e=>{this.state.activeNavId!==e&&(this.state.viewedSections.has(e)?this.setState({activeNavId:e}):(this.setState({activeNavId:e,viewedSections:this.state.viewedSections.add(e)}),Object(nr.a)(du.a.create($t.a.STICKY_NAV,{section:e}))))}),mu(this,"onActiveNavClick",e=>{this.setState({activeNavId:e})}),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?hu(Object(r),!0).forEach((function(t){mu(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hu(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({activeNavId:"about",viewedSections:oe.a.Set().add("about")},this.getStateFromContentfulStore()),this.onActiveNavClick=this.onActiveNavClick.bind(this),this.onChangeActiveNav=this.onChangeActiveNav.bind(this),this.context.contentfulStore.registerComponent(this,()=>{this.setState(this.getStateFromContentfulStore())})}getStateFromContentfulStore(){const e=this.context.contentfulStore;return{faq:e.getFAQ(),isLoading:e.isLoading()}}componentDidMount(){this.context.contentfulStore.fetchFAQ()}render(){const{faq:e,isLoading:t}=this.state,r=e&&e.map(e=>{const t=e.get("name");return a.createElement(iu,{key:t,onActive:()=>{this.onChangeActiveNav(e.get("id"))},verticalOffsetPx:80},a.createElement(ou.a,{title:t,id:e.get("id"),questions:e.get("questions"),verticalOffsetPx:80}))});return a.createElement(Sr.a,{className:"faq-page"},t?a.createElement("div",{className:"faq__loading"},a.createElement(Ce.a,null),a.createElement("span",{className:"faq__loading__label"},Object(f.b)(e=>e.faq.loadingLabel))):a.createElement("section",{className:"content faq__outer",role:"main",id:"main-content"},a.createElement("div",{className:"container faq__inner"},a.createElement(nu.a,{title:Object(f.b)(e=>e.faq.title)}),a.createElement(ms,null,a.createElement(Fl,{side:"left"},a.createElement(uu,{activeNavId:this.state.activeNavId,navSections:e,className:"sticky-nav--left",onClick:this.onActiveNavClick})),a.createElement(Xs,{className:"faq-content"},r)))))}}function bu(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-FAQPage"),a.createElement(pu,e)}function gu(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}mu(pu,"contextTypes",{contentfulStore:K.a.instanceOf(au.a).isRequired});class fu extends a.Component{render(){return a.createElement(bu,null)}}gu(fu,"getPageMetaDescription",()=>Object(f.b)(e=>e.metaDescription.faqPage.content)),gu(fu,"getPageTitle",()=>[Object(f.b)(e=>e.faq.title),Object(f.b)(e=>e.general.appName)].join(" | "));var _u=r(978),yu=r(812),Eu=r(971),Ou=r(974),Su=r(968),vu=r(943),Cu=r(766),wu=r(944),Pu=r(763),Nu=r(945),xu=r(946),ju=r(1002),Ru=r(947),Tu=r(972),Au=r(958),Iu=r(108),ku=r(869),Fu=r(216);function Du(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Lu(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class qu extends a.Component{constructor(){super(...arguments),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Du(Object(r),!0).forEach((function(t){Lu(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Du(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromSampleQueriesStore()),this.context.sampleQueriesStore.registerComponent(this,()=>{this.setState(this.getStateFromSampleQueriesStore())}),this.context.weblabStore.registerComponent(this,()=>{this.setState(this.getStateFromSampleQueriesStore())})}componentDidMount(){const e=this.context.history;Object(Wl.l)(e.location.search).signIn&&!this.context.authStore.hasAuthenticatedUser()&&this.context.dispatcher.dispatch(Object(ga.b)({id:ba.b.SIGNUP,location:Iu.f.navBar}))}getStateFromSampleQueriesStore(){return{sampleQueries:this.context.sampleQueriesStore.sampleQueries}}render(){const{sampleQueries:e}=this.state;return a.createElement(Pu.a,{heapProps:{"page-type":ku.a,"relevance-bucket":"featured"}},a.createElement(ps.a,{experiment:ha.b.HomePageSearchEmphasisExtension},a.createElement(ps.b,null,a.createElement(Sr.a,{className:"home-page",header:!1},a.createElement(Ru.a,{sampleQueries:e}),a.createElement(Tu.a,null),a.createElement(wu.a,null),a.createElement(Nu.a,null),a.createElement(xu.a,null),a.createElement(Au.a,null),a.createElement(ju.a,null))),a.createElement(ps.c,{variation:ha.b.HomePageSearchEmphasisExtension.Variation.REFRESHED},a.createElement(Sr.a,{className:"home-page__search_emphasis",header:!1,footer:a.createElement(Cu.a,{showFootnoteLinks:!1,reverse:!0,showUsingSources:!1})},a.createElement(Ru.a,{sampleQueries:e}),a.createElement(ju.a,null),a.createElement(vu.a,null)))))}}function Mu(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-HomePage"),a.createElement(qu,e)}function Hu(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Lu(qu,"contextTypes",{api:K.a.instanceOf(pe.a).isRequired,authStore:K.a.instanceOf(Ne.a).isRequired,dispatcher:K.a.instanceOf(rs.a).isRequired,history:K.a.instanceOf(je.a).isRequired,sampleQueriesStore:K.a.instanceOf(Fu.a).isRequired,weblabStore:K.a.instanceOf(Cr.b).isRequired});class zu extends a.Component{static async willRouteTo(e){if(e.queryStore.reset(),e.sampleQueriesStore.sampleQueries.isEmpty())return e.api.fetchSampleQueries()}render(){return a.createElement(Mu,null)}}Hu(zu,"getPageTitle",()=>Object(f.b)(e=>e.home.pageTitle)),Hu(zu,"getPageMetaDescription",()=>Object(f.b)(e=>e.home.metaDescription)),Hu(zu,"getCanonicalUrl",()=>"/");var Uu=r(984),Vu=r(728),Bu=r(742),Yu=r(751);function Ku(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Wu extends a.PureComponent{renderPaperLink(){const{linkOpenInNewTab:e,paper:t}=this.props,{id:r,slug:a,title:o}=t;if(e){const e=Object(ge.d)({routeName:"PAPER_DETAIL",params:{paperId:r,slug:a}});return n.a.createElement(gn.a,{href:e},n.a.createElement("span",{className:"paper-lite__metadata-title"},o))}return n.a.createElement(Be.a,{"data-selenium-selector":"title-link",to:"PAPER_DETAIL",params:{paperId:r,slug:a}},n.a.createElement("span",{className:"paper-lite__metadata-title"},o))}render(){const{displayAbstract:e,paper:t}=this.props,{authors:r,paperAbstract:a,venue:o,year:i}=t;return n.a.createElement("div",null,this.renderPaperLink(),n.a.createElement("div",{className:"paper-lite__metadata"},n.a.createElement(Bu.a,{authors:r}),o?n.a.createElement("span",{className:"paper-lite__metadata-item"},"  ",o):null,i?n.a.createElement("span",{className:"paper-lite__metadata-item"},"  ",i):null,e?n.a.createElement(Yu.a,{className:"text--preline abstract",text:a.text,limit:250,truncateByDefault:!0}):null))}}Ku(Wu,"propTypes",{paper:K.a.instanceOf(we.a).isRequired,displayAbstract:K.a.bool,linkOpenInNewTab:K.a.bool}),Ku(Wu,"defaultProps",{displayAbstract:!1,linkOpenInNewTab:!1});r(241);var Qu=r(448),Gu=r(153);function Xu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Ju(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Zu extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r);const{tagStore:n}=this.context;this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Xu(Object(r),!0).forEach((function(t){Ju(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xu(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromTagStore()),n.registerComponent(this,()=>{this.setState(this.getStateFromTagStore())}),this.handleEdit=this.handleEdit.bind(this)}getStateFromTagStore(){const{tagStore:e}=this.context;return{tags:e.getTags()}}handleEdit(){const{entry:e}=this.props;this.context.dispatcher.dispatch(Object(ga.b)({id:ba.b.EDIT_TAGS,data:{entryIds:oe.a.List([e.id])}}))}render(){const{onDelete:e,onChange:t,entry:r,isSelected:a}=this.props,{tags:o}=this.state,i=r.tagIds.map(e=>o.get(e)).sortBy(e=>e.name);return n.a.createElement("li",{className:"library-entry__container"},n.a.createElement(Vu.a,{layout:"row"},n.a.createElement("div",{className:"library-entry__select"},n.a.createElement("input",{type:"checkbox",className:"legacy__input",onChange:()=>{t(r.id)},checked:a,"aria-label":r.paper.title})),n.a.createElement(Vu.a,{layout:"column"},n.a.createElement(Wu,{paper:r.paper,displayAbstract:!0}),n.a.createElement(ue.c,{feature:er.b.LibraryTags},n.a.createElement(ue.b,null,n.a.createElement(Vu.a,{layout:"row",wrap:!0},i.map(e=>n.a.createElement(Be.a,{className:"library-entry__tag",key:e.id,to:"LIBRARY_TAG",params:{tagName:encodeURIComponent(e.name)}},e.name)),n.a.createElement("a",{className:"library-entry__tag tag__outlined add-edit-tag",onClick:this.handleEdit},r.tagIds.isEmpty()?Qa.a.getString("library.addTags"):Qa.a.getString("library.editTags")))))),n.a.createElement(J.a,{className:"remove-icon",icon:"library-entry-remove",width:"14",height:"14",onClick:()=>{e(r.id)}})))}}Ju(Zu,"contextTypes",{dispatcher:K.a.instanceOf(fa.Dispatcher).isRequired,tagStore:K.a.instanceOf(Gu.a).isRequired});var $u=r(781),ed=r(902),td=r(158);function rd(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class ad extends a.Component{constructor(){super(...arguments),this.handleOptionClick=this.handleOptionClick.bind(this)}handleOptionClick(){const{onClick:e,selectType:t}=this.props;e(t)}render(){const{selectType:e}=this.props;return n.a.createElement("li",{className:"library-entries-page__select-option",onClick:this.handleOptionClick},td.d.toDisplayText(e))}}rd(ad,"propTypes",{onClick:K.a.func.isRequired,selectType:K.a.string.isRequired});class nd extends a.PureComponent{constructor(){super(...arguments),this.state={expanded:!1},this.toggleExpandState=this.toggleExpandState.bind(this),this.handleOptionClick=this.handleOptionClick.bind(this)}toggleExpandState(){this.setState(e=>{let{expanded:t}=e;return{expanded:!t}})}handleOptionClick(e){this.props.onSelect(e),this.toggleExpandState()}render(){const{expanded:e}=this.state,{indeterminate:t,onCheckboxClick:r,checked:a}=this.props,o=e?$u.a.Direction.UP:$u.a.Direction.DOWN;return n.a.createElement("div",{className:"library-entries-page__select-container"},n.a.createElement("div",{className:"flex-row-centered"},n.a.createElement(ed.a,{ariaLabel:"library-entry-select",checked:a,onChange:r,indeterminate:t}),n.a.createElement($u.a,{className:"flex-static",onClick:this.toggleExpandState,direction:o,width:"14",height:"14"}),e?n.a.createElement("ul",{className:"library-entries-page__select-options"},td.d.displayable().map(e=>n.a.createElement(ad,{key:e,onClick:this.handleOptionClick,selectType:e}))):null))}}function od(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function id(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}rd(nd,"propTypes",{indeterminate:K.a.bool.isRequired,onCheckboxClick:K.a.func.isRequired,onSelect:K.a.func.isRequired,checked:K.a.bool.isRequired});const sd={checkboxChecked:!1,selectedEntryIds:oe.a.Set()};class ld extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r);const{currentQuery:n}=this.props;this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?od(Object(r),!0).forEach((function(t){id(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):od(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({queryValue:n.q,selectedSort:td.e.RECENCY},sd),this.handleCheckboxClick=this.handleCheckboxClick.bind(this),this.handleClearSearch=this.handleClearSearch.bind(this),this.handleDeleteEntry=this.handleDeleteEntry.bind(this),this.handleDeleteSelectedEntries=this.handleDeleteSelectedEntries.bind(this),this.handleEntryCheckboxClick=this.handleEntryCheckboxClick.bind(this),this.handleFilterSubmit=this.handleFilterSubmit.bind(this),this.handleFilterTextChange=this.handleFilterTextChange.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleSelectClick=this.handleSelectClick.bind(this),this.handleSortChange=this.handleSortChange.bind(this),this.openEditTagsModal=this.openEditTagsModal.bind(this)}openEditTagsModal(){const{entries:e}=this.props,{selectedEntryIds:t}=this.state;this.context.dispatcher.dispatch(Object(ga.b)({id:ba.b.EDIT_TAGS,data:{entryIds:e.filter(e=>t.includes(e.id)).map(e=>e.id)}}))}someEntriesSelected(){const{entries:e}=this.props,{selectedEntryIds:t}=this.state;return!t.isEmpty()&&t.size<e.size}handleKeyDown(e){13===e.keyCode&&this.handleFilterSubmit()}handleFilterSubmit(){const{fetchEntriesForQuery:e,tag:t}=this.props,{queryValue:r,selectedSort:a}=this.state;e(Object(td.b)({q:r,sort:a,tag:t?t.id:null}),!1,()=>this.setState(sd))}handleFilterTextChange(e){this.setState({queryValue:e.target.value})}handleSortChange(e){this.setState({selectedSort:e.target.value},this.handleFilterSubmit)}handleClearSearch(){this.setState({queryValue:""},this.handleFilterSubmit)}handleCheckboxClick(){const{entries:e}=this.props;this.setState(t=>{let{checkboxChecked:r}=t;return{checkboxChecked:!r,selectedEntryIds:r?oe.a.Set():oe.a.Set(e.map(e=>{let{id:t}=e;return t}))}})}handleSelectClick(e){const{entries:t}=this.props;switch(e){case td.d.ALL:this.setState({selectedEntryIds:oe.a.Set(t.map(e=>{let{id:t}=e;return t})),checkboxChecked:!0});break;case td.d.NONE:this.setState({selectedEntryIds:oe.a.Set(),checkboxChecked:!1});break;default:w.a.error("Selected a select type that does not exist in LibrarySelect. This is likely a programming error.")}}handleEntryCheckboxClick(e){this.setState(t=>{let{selectedEntryIds:r}=t;return{selectedEntryIds:r.has(e)?r.delete(e):r.add(e)}})}handleDeleteEntry(e){this.props.deleteEntries(oe.a.Set.of(e))}handleDeleteSelectedEntries(){this.props.deleteEntries(this.state.selectedEntryIds)}renderEntries(){const{currentQuery:e,totalPages:t,entries:r}=this.props,{selectedEntryIds:a}=this.state;return n.a.createElement("div",{className:"library-entry-list__container"},n.a.createElement("ul",{className:"library-entry-list__entries"},r.map(e=>n.a.createElement(Zu,{key:e.id,entry:e,onDelete:()=>this.handleDeleteEntry(e.id),onChange:this.handleEntryCheckboxClick,isSelected:a.has(e.id)}))),t>1?n.a.createElement(Zs.a,{loadPage:this.props.loadPage,pageNumber:e.page,totalPages:t}):null)}renderLoading(){return n.a.createElement("div",{className:"loading-controls"},n.a.createElement(Ce.a,null)," ",Object(f.b)(e=>e.library.loadingIndicator))}render(){const{isLoading:e,totalHits:t,tag:r,currentQuery:o,entries:i}=this.props,{checkboxChecked:s,queryValue:l,selectedEntryIds:c,selectedSort:u}=this.state,{page:d,pageSize:h}=o||{page:null,pageSize:null},m=n.a.createElement("span",null,Object(f.b)(e=>e.library.noResultMessage,o.q),n.a.createElement(Be.a,zs.a.routeForQuery(o.q),'"',o.q,'"'),"?"),p=i.isEmpty()?m:null!==d&&null!==h&&null!==t?Object(f.b)(e=>e.library.count,Object(za.f)({page:d,pageSize:h,totalHits:t}),t):"";return n.a.createElement(a.Fragment,null,n.a.createElement(ue.c,{feature:er.b.LibraryTags},n.a.createElement(ue.b,null,n.a.createElement("div",{className:"library-entries-page__header"},r?'Papers tagged with "'.concat(decodeURIComponent(r.name),'"'):"All Papers"))),n.a.createElement("div",{className:"flex-row-centered library-entries-page__filter-container"},n.a.createElement("div",{className:"flex-row-centered library-entries-page__filter"},n.a.createElement("input",{className:"legacy__input library-entries-page__filter-input",type:"text",placeholder:"Filter Papers",value:l,onKeyDown:this.handleKeyDown,onChange:this.handleFilterTextChange}),l?n.a.createElement("div",{className:"clear-icon",onClick:this.handleClearSearch},n.a.createElement(J.a,{width:"16",height:"16",icon:"clear-input"})):null,n.a.createElement("div",{className:"flex-row-centered library-entries-page__filter-icon",onClick:this.handleFilterSubmit},n.a.createElement(J.a,{icon:"filter",width:"30",height:"30"}))),n.a.createElement("div",{className:"library-entries-page__sort flex-row-centered"},n.a.createElement("span",{className:"library-entries-page__sort-text"},Object(f.b)(e=>e.library.sortByLabel)),n.a.createElement("div",{className:"select--no-styles library-entries-page__sort-options"},n.a.createElement("select",{className:"legacy__select",value:u,onChange:this.handleSortChange},td.e.all().map(e=>n.a.createElement("option",{key:e,value:e},td.e.toDisplayText(e))))))),n.a.createElement("div",{className:"flex-row-vcenter library-entries-page__actions-container"},n.a.createElement(nd,{onSelect:this.handleSelectClick,onCheckboxClick:this.handleCheckboxClick,checked:s,indeterminate:this.someEntriesSelected()}),n.a.createElement("div",{className:"library-entries-page__actions-buttons"},n.a.createElement(ue.c,{feature:er.b.LibraryTags},n.a.createElement(ue.b,null,n.a.createElement(rl.a,{className:"library-entries-page__edit-tags",disabled:c.isEmpty(),iconProps:{icon:"tag",width:"10",height:"10"},text:Object(f.b)(e=>e.library.editTags),onClick:this.openEditTagsModal}))),n.a.createElement(rl.a,{className:"library-entries-page__delete-entries",disabled:c.isEmpty(),iconProps:{icon:"library-entry-remove",width:"10",height:"10"},text:Object(f.b)(e=>e.library.delete),onClick:this.handleDeleteSelectedEntries}))),n.a.createElement("p",{className:"library-entries-page__result-count"},p),e?this.renderLoading():this.renderEntries())}}id(ld,"contextTypes",{dispatcher:K.a.instanceOf(fa.Dispatcher).isRequired});var cd=r(878),ud=r(161),dd=r(86),hd=r.n(dd),md=r(133),pd=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e};function bd(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gd(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var fd=function(e){function t(){return bd(this,t),gd(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.isStatic=function(){return this.context.router&&this.context.router.staticContext},t.prototype.componentWillMount=function(){B()(this.context.router,"You should not use <Redirect> outside a <Router>"),this.isStatic()&&this.perform()},t.prototype.componentDidMount=function(){this.isStatic()||this.perform()},t.prototype.componentDidUpdate=function(e){var t=Object(md.b)(e.to),r=Object(md.b)(this.props.to);Object(md.e)(t,r)?hd()(!1,"You tried to redirect to the same route you're currently on: \""+r.pathname+r.search+'"'):this.perform()},t.prototype.computeTo=function(e){var t=e.computedMatch,r=e.to;return t?"string"==typeof r?Object(wc.a)(r,t.params):pd({},r,{pathname:Object(wc.a)(r.pathname,t.params)}):r},t.prototype.perform=function(){var e=this.context.router.history,t=this.props.push,r=this.computeTo(this.props);t?e.push(r):e.replace(r)},t.prototype.render=function(){return null},t}(n.a.Component);fd.propTypes={computedMatch:Te.a.object,push:Te.a.bool,from:Te.a.string,to:Te.a.oneOfType([Te.a.string,Te.a.object]).isRequired},fd.defaultProps={push:!1},fd.contextTypes={router:Te.a.shape({history:Te.a.shape({push:Te.a.func.isRequired,replace:Te.a.func.isRequired}).isRequired,staticContext:Te.a.object}).isRequired};var _d=fd;function yd(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Ed(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?yd(Object(r),!0).forEach((function(t){Od(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yd(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Od(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Sd=Object.freeze({error:null});class vd extends a.PureComponent{constructor(){super(...arguments),this.state=Ed({currentQuery:Object(td.b)(),currentTag:null,selectedSort:td.e.RECENCY},this.getStateFromStores(),{},Sd,{isLoading:!0});const{entryStore:e,tagStore:t}=this.context;e.registerComponent(this,()=>{this.setState(this.getStateFromStores())}),t.registerComponent(this,()=>{if(!t.isLoading()){const e=t.getTagFromName(t.currentTagName),r=e?e.id:null,a=r!==(this.state.currentQuery?this.state.currentQuery.tag:null),n={currentTag:t.getTagFromName(t.currentTagName),isLoading:!!a||this.state.isLoading};this.setState(n,()=>{setTimeout(()=>{this.fetchEntriesForQuery(Object(td.b)({tag:r}))},0)})}}),this.fetchEntriesForQuery=this.fetchEntriesForQuery.bind(this),this.deleteEntries=this.deleteEntries.bind(this),this.loadPage=this.loadPage.bind(this)}getStateFromStores(){const{entryStore:e,tagStore:t}=this.context;return{entries:e.getEntries().valueSeq().toList(),isInitialLoading:e.isUninitialized()||t.isUninitialized(),isLoading:e.isLoading()||t.isLoading(),totalHits:e.getTotalHits(),totalPages:e.getTotalPages()}}fetchEntriesForQuery(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};e.equals(this.state.currentQuery)&&!t||(this.setState(Ed({currentQuery:e},Sd),()=>{this.context.api.getLibraryEntries(e).catch(e=>{this.setState({error:e})})}),r())}loadPage(e){const{currentQuery:t}=this.state;e!==t.page&&(Dl.a.scrollTop(0),this.fetchEntriesForQuery(t.update("page",()=>e)))}deleteEntries(e){e.isEmpty()||this.context.api.deleteLibraryEntries(e).then(()=>{const{currentQuery:e,entries:t}=this.state,r=e.update("page",e=>0===t.size&&e>1?e-1:e);this.fetchEntriesForQuery(r,!0)}).catch(()=>{const e=Qa.a.getString("library.message.delete_error.header"),t=Qa.a.getString("library.message.delete_error.body"),r=n.a.createElement(Be.a,{to:"LIBRARY",className:"library-link button button--secondary",onClick:()=>{this.context.messageStore.clearMessages()}},"View Your Library");this.context.messageStore.addError(t,e,r)})}renderEmptyListInstructions(){return n.a.createElement("div",{className:"library-entries-page__empty-library"},n.a.createElement("div",{className:"library-entries-page__header"},"Welcome to Your Semantic Scholar Library"),n.a.createElement("p",null,"Save and organize papers of interest to you. To get started, save a paper via the bookmark icon on a paper or search results page. Then, you can organize your library via tags."),n.a.createElement("img",{src:"/img/empty_library.png",srcSet:"/img/empty_library_2x.png 2x",alt:"empty library graphic"}))}renderEmptyTagInstructions(){const{currentTag:e}=this.state;return n.a.createElement("div",{className:"library-entries-page__empty-library"},n.a.createElement("div",{className:"library-entries-page__header"},'No Papers Tagged with "',e.name,'" Yet'),n.a.createElement("p",null,"To get started, add this tag to papers via the",n.a.createElement(cd.a,{exact:!0,to:"LIBRARY"},"All Papers"),"page."),n.a.createElement("img",{src:"/img/empty_tag.png",srcSet:"/img/empty_tag_2x.png 2x",alt:"no tagged entries graphic"}))}renderLoading(){return n.a.createElement("div",{className:"loading-controls"},n.a.createElement(Ce.a,null)," Loading")}render(){const{currentQuery:e,currentTag:t,entries:r,isInitialLoading:a,isLoading:o,totalHits:i,totalPages:s}=this.state,{tagStore:l}=this.context,c=r.isEmpty()&&!t,u=r.isEmpty()&&t;return l.isLoading()||!l.currentTagName||l.getTagFromName(l.currentTagName)?a||o?n.a.createElement("div",{className:"library-entries-page",role:"main",id:"main-content"},this.renderLoading()):c&&""===e.q?n.a.createElement("div",{className:"library-entries-page",role:"main",id:"main-content"},this.renderEmptyListInstructions()):u?n.a.createElement("div",{className:"library-entries-page",role:"main",id:"main-content"},this.renderEmptyTagInstructions()):n.a.createElement("div",{className:"library-entries-page",role:"main",id:"main-content"},n.a.createElement(ld,{currentQuery:e,deleteEntries:this.deleteEntries,entries:r,fetchEntriesForQuery:this.fetchEntriesForQuery,isLoading:o,loadPage:this.loadPage,tag:t,totalHits:i,totalPages:s})):n.a.createElement(_d,{to:"/me/library"})}}function Cd(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-LibraryEntriesPage"),a.createElement(vd,e)}Od(vd,"contextTypes",{api:K.a.instanceOf(pe.a).isRequired,entryStore:K.a.instanceOf(ud.a).isRequired,messageStore:K.a.instanceOf(Ga.a).isRequired,tagStore:K.a.instanceOf(Gu.a).isRequired});class wd extends a.Component{static async willRouteTo(e,t){let{tagStore:r}=e,{params:a}=t;const{tagName:n}=a;r.setCurrentTagName(n)}render(){return a.createElement(Cd,null)}}var Pd=r(727),Nd=r(806);function xd(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function jd(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Rd extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r);const{tagStore:n}=this.context;this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?xd(Object(r),!0).forEach((function(t){jd(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xd(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromTagStore()),n.registerComponent(this,()=>{this.setState(this.getStateFromTagStore())})}getStateFromTagStore(){const{tagStore:e}=this.context;return{isLoading:e.isLoading(),tags:e.getTags().sortBy(e=>e.name.toLowerCase())}}render(){const e=n.a.createElement(a.Fragment,null,this.state.tags.toList().map(e=>n.a.createElement(Be.a,{className:"tag__item",key:e.id,to:"LIBRARY_TAG",params:{tagName:encodeURIComponent(e.name)}},e.name)),n.a.createElement(Be.a,{className:"tag__manage",to:"LIBRARY_TAG_MANAGEMENT"},Object(f.b)(e=>e.library.tags.manage))),t=n.a.createElement("span",{className:"tag__label flex-justify-start flex-row-vcenter"},n.a.createElement(J.a,{icon:"tag-stack",width:"20",height:"20"}),n.a.createElement("span",null,Object(f.b)(e=>e.library.tags.tagButtonLabel))),r=this.props.location.pathname,o=new RegExp(ge.b.LIBRARY_TAG.replace(/:\w+/,"*")),i=r.includes(ge.b.LIBRARY_TAG_MANAGEMENT)||r.match(o);return n.a.createElement("div",{className:"library-sidebar__container"},n.a.createElement(cd.a,{activeClassName:"is-active",className:"tag__section",exact:!0,to:"LIBRARY"},n.a.createElement("span",{className:"tag__label flex-justify-start flex-row-vcenter"},n.a.createElement(J.a,{icon:"fa-bookmark",width:"20",height:"20"}),n.a.createElement("span",null,Object(f.b)(e=>e.library.tags.libraryLink)))),n.a.createElement(Nd.a,{className:"tag__section ".concat(i?"is-active":""),collapsibleContent:e,ignoreHash:!0,initialCollapseState:!i,label:t,showToggleIcon:!0}))}}jd(Rd,"contextTypes",{tagStore:K.a.instanceOf(Gu.a).isRequired});const Td={match:K.a.shape({params:K.a.object.isRequired,isExact:K.a.bool.isRequired,path:K.a.string.isRequired,url:K.a.string.isRequired}),location:K.a.shape({pathname:K.a.string.isRequired,search:K.a.string.isRequired,hash:K.a.string.isRequired,state:K.a.object}),history:K.a.shape({length:K.a.number.isRequired,action:K.a.string.isRequired,location:K.a.object.isRequired,search:K.a.string,hash:K.a.string,state:K.a.object,push:K.a.func.isRequired,replace:K.a.func.isRequired,go:K.a.func.isRequired,goBack:K.a.func.isRequired,goForward:K.a.func.isRequired,block:K.a.func.isRequired}),route:K.a.shape({component:K.a.func.isRequired,routes:K.a.arrayOf(K.a.object)})};function Ad(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Id extends a.Component{render(){const e=this.context.history;return a.createElement(Sr.a,{className:"library-page"},a.createElement("div",{className:"library-page__header bg-light-gray"},a.createElement("h1",{className:"centered-max-width-content"},Object(f.b)(e=>e.library.headline))),a.createElement(Vu.a,{className:"library-page__container centered-max-width-content",layout:"row",position:"relative"},a.createElement(ue.c,{feature:er.b.LibraryTags},a.createElement(ue.b,null,a.createElement(Rd,{location:e.location}))),a.createElement(Pd.a,null,Object(wr.b)(this.props.route.routes))))}}function kd(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-LibraryPage"),a.createElement(Id,e)}function Fd(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Ad(Id,"contextTypes",{api:K.a.instanceOf(pe.a).isRequired,history:K.a.instanceOf(je.a).isRequired}),Ad(Id,"propTypes",Td);class Dd extends a.Component{static async willRouteTo(e){let{tagStore:t,api:r}=e;if(t.isUninitialized())return r.getLibraryTags()}render(){return a.createElement(kd,this.props)}}Fd(Dd,"requiresAuthentication",()=>!0),Fd(Dd,"getPageTitle",()=>Object(f.b)(e=>e.library.pageTitle));var Ld=r(900);function qd(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Md(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Hd extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r);const{tagStore:n}=this.context;this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?qd(Object(r),!0).forEach((function(t){Md(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qd(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({renameRequest:!1,renameTag:null},this.getStateFromTagStore()),n.registerComponent(this,()=>{this.setState(this.getStateFromTagStore())}),this.deleteLibraryTag=this.deleteLibraryTag.bind(this),this.focus=this.focus.bind(this),this.handleRenameBegin=this.handleRenameBegin.bind(this),this.handleRenameChange=this.handleRenameChange.bind(this),this.handleRenameKeyDown=this.handleRenameKeyDown.bind(this),this.handleRenameSubmit=this.handleRenameSubmit.bind(this),this.openDeleteModal=this.openDeleteModal.bind(this)}getStateFromTagStore(){const{tagStore:e}=this.context,{tag:t}=this.props;return{paperCount:e.getPaperCount(t.id)}}focus(){this.renameInput&&this.renameInput.focus()}deleteLibraryTag(e){const{api:t,messageStore:r}=this.context,{renameTag:a}=this.state,{DELETE_SUCCESS:n,DELETE_FAILURE:o}=$t.a.Library.Tags;t.deleteLibraryTag(e).then(()=>{Object(nr.a)(rr.a.create(n,{tagId:e})),a&&a.id===e&&this.setState({renameTag:null})}).catch(()=>{Object(nr.a)(rr.a.create(o,{tagId:e}));const t=Object(f.b)(e=>e.library.message.errorDeleteTag.header),a=Object(f.b)(e=>e.library.message.errorDeleteTag.body);r.addError(a,t)})}updateLibraryTag(e){const{api:t,messageStore:r,tagStore:a}=this.context,{RENAME_SUCCESS:n,RENAME_FAILURE:o}=$t.a.Library.Tags;if(a.hasTagByName(e.name)){const t=Object(f.b)(e=>e.library.message.duplicateTag.header),a=Object(f.b)(e=>e.library.message.duplicateTag.body,e.name);r.addWarning(a,t)}else this.setState({renameRequest:!0},()=>{t.updateLibraryTag({id:e.id,newName:e.name}).then(()=>{Object(nr.a)(rr.a.create(n,{tagId:e.id,tagName:e.name})),this.setState({renameRequest:!1,renameTag:null})}).catch(()=>{Object(nr.a)(rr.a.create(o,{tagId:e.id,tagName:e.name})),this.setState({renameRequest:!1});const t=Object(f.b)(e=>e.library.message.errorRenameTag.header),a=Object(f.b)(e=>e.library.message.errorRenameTag.body);r.addError(a,t)})})}openDeleteModal(e){this.context.dispatcher.dispatch(Object(ga.b)({id:ba.b.DELETE_TAG,data:{deleteLibraryTag:this.deleteLibraryTag,tag:e}}))}handleRenameBegin(e){this.setState({renameTag:e}),this.focus()}handleRenameChange(e){const{renameTag:t}=this.state,r=Object(Qu.a)(t);this.setState({renameTag:r.set("name",e.currentTarget.value)})}handleRenameKeyDown(e){13===e.keyCode?this.handleRenameSubmit():27===e.keyCode&&this.setState({renameTag:null})}handleRenameSubmit(){const{renameTag:e,renameRequest:t}=this.state;if(!e)return;const{tags:r}=this.props,a=r.get(e.id),n=e.name.replace(/\s+/g," ").trim();a.name===n?this.setState({renameTag:null}):""===n||t||this.updateLibraryTag(e)}renderRename(e){return n.a.createElement("div",{className:"flex-row-centered library-tags-page__rename"},n.a.createElement("input",{className:"legacy__input library-tags-page__rename-input",type:"text",ref:e=>this.renameInput=e,placeholder:"Rename Tag",value:e.name,onKeyDown:this.handleRenameKeyDown,onChange:this.handleRenameChange}),n.a.createElement("div",{className:"flex-row-centered library-tags-page__rename-update",onClick:this.handleRenameSubmit},Object(f.b)(e=>e.library.tags.updateNameButton)))}render(){const{tag:e}=this.props,{paperCount:t,renameTag:r}=this.state,o=r&&r.id===e.id;return n.a.createElement(Vu.a,{className:"library-tags-page__tag-row",layout:"row"},o?null:n.a.createElement("span",{className:"library-tags-page__tag"},e.name),n.a.createElement(Vu.a,{className:"flex-row-vcenter library-tags-page__tag-controls",layout:"row"},o?this.renderRename(r):n.a.createElement(a.Fragment,null,n.a.createElement("span",{className:"paper-count"},"".concat(t||"","\n                    ").concat(t&&1!==t?Object(f.b)(e=>e.library.tags.paperCountPlural):t?Object(f.b)(e=>e.library.tags.paperCountSingle):"")),n.a.createElement("div",{className:"rename-tag",onClick:()=>this.handleRenameBegin(e)},n.a.createElement(J.a,{icon:"pencil",width:"12",height:"12"}),n.a.createElement("span",null,Object(f.b)(e=>e.library.tags.renameButtonLabel)))),n.a.createElement("div",{className:"remove-tag",onClick:()=>this.openDeleteModal(e)},n.a.createElement(J.a,{icon:"small-x",width:"10",height:"10"}),n.a.createElement("span",null,Object(f.b)(e=>e.library.tags.removeButtonLabel)))))}}Md(Hd,"contextTypes",{api:K.a.instanceOf(pe.a).isRequired,dispatcher:K.a.instanceOf(fa.Dispatcher).isRequired,messageStore:K.a.instanceOf(Ga.a).isRequired,tagStore:K.a.instanceOf(Gu.a).isRequired});var zd=_d;function Ud(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Vd(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Bd extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r);const{tagStore:n}=this.context;this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ud(Object(r),!0).forEach((function(t){Vd(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ud(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromTagStore()),n.registerComponent(this,()=>{this.setState(this.getStateFromTagStore())})}getStateFromTagStore(){const{tagStore:e}=this.context;return{isLoading:e.isLoading(),tags:e.getTags()}}renderEmptyTagList(){return n.a.createElement("div",{className:"library-entries-page__empty-tag-list"},n.a.createElement("div",{className:"library-entries-page__header"},"You Haven't Created Any Tags Yet"),n.a.createElement("p",null,"Tags help you organize the papers youve saved to your library. Once created, you can add multiple tags to a single paper, and filter by those tags."))}renderLoading(){return n.a.createElement("div",{className:"loading-controls"},n.a.createElement(Ce.a,null)," Loading")}render(){const{isLoading:e,tags:t}=this.state;return n.a.createElement(ue.c,{feature:er.b.LibraryTags},n.a.createElement(ue.b,null,n.a.createElement("div",{className:"library-tags-page"},e?this.renderLoading():n.a.createElement(a.Fragment,null,t.isEmpty()?this.renderEmptyTagList():n.a.createElement("div",{className:"library-tags-page__header"},"Manage Tags"),n.a.createElement(Ld.a,null),t.toList().map(e=>n.a.createElement(Hd,{tag:e,tags:t,key:e.id}))))),n.a.createElement(ue.a,null,n.a.createElement(zd,{to:ge.b.LIBRARY})))}}function Yd(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-LibraryTagManagementPage"),a.createElement(Bd,e)}Vd(Bd,"contextTypes",{api:K.a.instanceOf(pe.a).isRequired,messageStore:K.a.instanceOf(Ga.a).isRequired,tagStore:K.a.instanceOf(Gu.a).isRequired});class Kd extends a.Component{static async willRouteTo(e){let{api:t}=e;return t.getLibraryTagPaperCounts()}render(){return a.createElement(Yd,null)}}class Wd extends a.PureComponent{render(){const{navItems:e,activeRouteName:t}=this.props;return a.createElement("nav",{className:"moderation-nav"},a.createElement("ul",{className:"moderation-nav__list"},e.map((e,r)=>{let{routeName:n,params:o,label:i,itemCount:s}=e;const l=n===t;return a.createElement("li",{key:r,className:D()({"moderation-nav__item":!0,"moderation-nav__is-active":l})},a.createElement(Be.a,{to:n,params:o||{}},i),"number"==typeof s&&a.createElement("div",{className:"moderation-nav__item__count"},s))})))}}function Qd(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Gd(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Qd(Object(r),!0).forEach((function(t){Xd(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qd(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Xd(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Jd extends a.Component{constructor(e,t){super(e,t),this.state=Gd({},this.getStateFromAuthorshipModerationStore(),{},this.getStateFromAuthorClaimModerationStore()),this.context.authorshipModerationStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorClaimModerationStore())}),this.context.claimModerationStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorClaimModerationStore())})}componentDidMount(){const e=this.context.history;if("MODERATION"===Object(ge.c)(e.location.pathname)){const t=new St.a(Gd({},this.pickRedirectRoute(),{replace:!0,status:302}));Object(Ot.a)({redirect:t,history:e})}}getStateFromAuthorshipModerationStore(){return{numPendingAuthorshipCorrections:this.context.authorshipModerationStore.getPendingPaperAuthorCorrectionsCount()}}getStateFromAuthorClaimModerationStore(){return{numPendingAuthorClaims:this.context.claimModerationStore.getPendingAuthorClaimCount()}}getActiveRouteName(){var e;const t=this.context.history,{route:r}=this.props,a=null!=(e=Object(wr.a)(r.routes,t.location.pathname))&&null!=(e=e[0])&&null!=(e=e.route)?e.path:e;return Object(ge.c)(a)||"MODERATION"}pickRedirectRoute(){return{routeName:"AUTHOR_CLAIM_MODERATION",params:{status:"pending"}}}getNavItems(){const{numPendingAuthorshipCorrections:e,numPendingAuthorClaims:t}=this.state;return[{routeName:"AUTHOR_CLAIM_MODERATION",params:{status:"pending"},label:Object(f.b)(e=>e.moderation.nav.authorClaimLabel),itemCount:t},{routeName:"AUTHOR_AUTHORSHIP_MODERATION",params:{status:"pending"},label:Object(f.b)(e=>e.moderation.nav.authorshipLabel),itemCount:e},{routeName:"AUTHOR_CORRECTIONS_TOOL",label:Object(f.b)(e=>e.moderation.nav.correctionsToolLabel),itemCount:null}]}render(){const{route:e}=this.props,t=this.getNavItems(),r=this.getActiveRouteName();return a.createElement(Sr.a,{header:a.createElement(ea.a,{isAdminPage:!0}),footer:!1},a.createElement("div",{className:"moderation",role:"main"},a.createElement("h2",{className:"moderation__header"},Object(f.b)(e=>e.moderation.headerLabel)),a.createElement(Wd,{navItems:t,activeRouteName:r}),a.createElement("div",{className:"moderation__sub-page"},Object(wr.b)(e.routes))))}}function Zd(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-ModerationPage"),a.createElement(Jd,e)}function $d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Xd(Jd,"contextTypes",{authorshipModerationStore:K.a.instanceOf(tc.a).isRequired,claimModerationStore:K.a.instanceOf(_n.a).isRequired,history:K.a.instanceOf(je.a).isRequired});class eh extends a.Component{static async willRouteTo(e){let{api:t}=e;return t.fetchModerationStats()}render(){return a.createElement(Zd,this.props)}}function th(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function rh(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}$d(eh,"getPageTitle",()=>Object(f.b)(e=>e.moderation.pageTitle)),$d(eh,"requiresAuthentication",()=>!0);class ah extends a.Component{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),rh(this,"onSubmitForm",()=>{this.setState({isSending:!0}),this.verifyAuthorId().then(()=>{const e=this.context.authorCorrectionsStore,t=this.state.authorId;if(!this.state.errorMessage){t&&e.setModeratorCorrectionsAuthorId(t),e.setIsModeratorCorrecting(!0),this.setState({isSending:!1}),this.context.history.push(Object(ge.d)({routeName:"AUTHOR_CORRECTIONS_TOOL_CONTACT"}))}})}),rh(this,"onChangeInput",e=>{this.setState({authorId:parseInt(e,10)})}),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?th(Object(r),!0).forEach((function(t){rh(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):th(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({isSending:!1,errorMessage:null,successMessage:null,hasAttemptedSubmit:!1},this.getStateFromAuthorCorrectionsStore()),this.context.authorCorrectionsStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorCorrectionsStore())})}getStateFromAuthorCorrectionsStore(){return{authorId:this.context.authorCorrectionsStore.getModeratorCorrectionsAuthorId()}}async verifyAuthorId(){const e=this.context.api,t=this.state.authorId;if(t)try{await e.fetchAuthorDetail(t,null,!1),this.setState({errorMessage:""})}catch(e){this.setState({errorMessage:"The author id is not valid"})}}renderMessage(){const{errorMessage:e}=this.state;return e?a.createElement("div",{className:"account__error-msg"},e):null}render(){const{authorId:e,isSending:t}=this.state;return a.createElement("div",{className:"moderator-corrections__author-id"},a.createElement(Jt.a,{name:"authorId",label:Object(f.b)(e=>e.moderatorCorrections.input.label),className:"standard-form",isRequired:!0,value:e?e.toString():"",onChange:this.onChangeInput,placeholder:"This author id will be used to make corrections"}),a.createElement(o,null,a.createElement(l,null,this.renderMessage()),a.createElement(s,null,t&&a.createElement(J.a,{className:"account__loading",icon:"gear"}),a.createElement("button",{className:"account-author-contact__submit-button button button--primary",onClick:this.onSubmitForm},Object(f.b)(e=>e.account.button.submit)))))}}function nh(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-ModeratorAuthorCorrectionsInputPage"),a.createElement(ah,e)}rh(ah,"contextTypes",{api:K.a.instanceOf(pe.a).isRequired,authStore:K.a.instanceOf(Ne.a).isRequired,authorCorrectionsStore:K.a.instanceOf(z.a).isRequired,history:K.a.instanceOf(je.a).isRequired});class oh extends a.Component{render(){return a.createElement(nh,null)}}function ih(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function sh(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(oh,"getPageTitle",()=>Object(f.b)(e=>e.moderatorCorrections.input.pageTitle));class lh extends a.Component{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ih(Object(r),!0).forEach((function(t){sh(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ih(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromAuthorCorrectionsStore()),this.context.authorCorrectionsStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorCorrectionsStore())})}getStateFromAuthorCorrectionsStore(){const{authorCorrectionsStore:e}=this.context;return{moderatorCorrectionsAuthorId:e.getModeratorCorrectionsAuthorId()||null}}componentWillUnmount(){const{authorCorrectionsStore:e}=this.context;e.resetModeratorCorrections()}getNavSections(){const{moderatorCorrectionsAuthorId:e}=this.state,t=[],r={label:Object(f.b)(e=>e.moderatorCorrections.authorCorrectionsTool.sectionLabel),links:[{routeName:"AUTHOR_CORRECTIONS_TOOL_AUTHOR_INPUT",label:Object(f.b)(e=>e.moderatorCorrections.authorCorrectionsTool.navLabel)}]},a=[{routeName:"AUTHOR_CORRECTIONS_TOOL_CONTACT",label:Object(f.b)(e=>e.account.page.authorContact.navLabel)},{routeName:"AUTHOR_CORRECTIONS_TOOL_REMOVE_PAPERS",label:Object(f.b)(e=>e.account.page.removePapers.navLabel)},{routeName:"AUTHOR_CORRECTIONS_TOOL_ADD_PAPERS",label:Object(f.b)(e=>e.account.page.addPapers.navLabel)},{routeName:"AUTHOR_CORRECTIONS_TOOL_STATUS",label:Object(f.b)(e=>e.account.page.corrections.navLabel)}];return e&&a.map(e=>r.links.push(e)),t.push(r),t}getActiveRouteName(){var e;const t=this.context.history,{route:r}=this.props,a=null!=(e=Object(wr.a)(r.routes,t.location.pathname))&&null!=(e=e[0])&&null!=(e=e.route)?e.path:e;return Object(ge.c)(a)||"AUTHOR_CORRECTIONS_TOOL"}render(){return a.createElement("div",{className:"author-corrections-tool"},a.createElement("div",{className:"account__columns"},a.createElement("div",{className:"account__column nav-bar__container"},a.createElement(Er,{activeRouteName:this.getActiveRouteName(),navSections:this.getNavSections()})),a.createElement("div",{className:"account__column account__page"},Object(wr.b)(this.props.route.routes))))}}function ch(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-ModeratorAuthorCorrectionsToolPage"),a.createElement(lh,e)}sh(lh,"contextTypes",{api:K.a.instanceOf(pe.a).isRequired,authorCorrectionsStore:K.a.instanceOf(z.a).isRequired,history:K.a.instanceOf(je.a).isRequired});class uh extends a.Component{render(){return a.createElement(ch,this.props)}}var dh=r(992),hh=r(975),mh=r(993),ph=r(965),bh=r(960),gh=r(961);function fh(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class _h extends a.PureComponent{trackShareEvent(e){const t=rn.a.create($t.a.SHARE,{socialType:e.id});Object(nr.a)(t)}onClickShareLink(e){this.trackShareEvent(e);const t=encodeURIComponent("".concat(window.location.href,"?utm_source=").concat(e.id)),r=encodeURIComponent(this.props.title),a=this.props.message?"".concat(encodeURIComponent(this.props.message),": ").concat(t):t;let n;switch(e){case gh.a.EMAIL:n="mailto:?subject=".concat(r,"&body=").concat(a);break;case gh.a.FACEBOOK:n=Object(bh.a)(t);break;case gh.a.REDDIT:n=Object(bh.getRedditShareUrl)(t,r);break;case gh.a.TWITTER:n=Object(bh.c)(t,r)}e!==gh.a.EMAIL?window.open(n,"_blank","left=100,top=100,width=800,height=500,toolbar=1,resizable=0"):window.location.href=n}render(){const e=gh.a.shareOptions().map((e,t)=>{const r=D()("".concat(e.id," share-option flex-row-vcenter"),this.props.linkClassName);return n.a.createElement("li",{className:r,onClick:this.onClickShareLink.bind(this,e),key:t},n.a.createElement(J.a,{icon:e.id,width:"25",height:"25"}),e.name)});return n.a.createElement("ul",null,e)}}function yh(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}fh(_h,"propTypes",{className:K.a.string,linkClassName:K.a.string,message:K.a.string}),fh(_h,"contextTypes",{dispatcher:K.a.instanceOf(rs.a).isRequired});class Eh extends a.PureComponent{render(){const e=D()("share-button button",this.props.className);return n.a.createElement(Pl.a,{tooltipContent:n.a.createElement(_h,{message:this.props.message,title:this.props.title}),tooltipPosition:this.props.tooltipPosition,className:"share flex-row-vcenter",tooltipClassName:"share-tooltip"},n.a.createElement(rl.a,{className:e,text:"Share",iconProps:{icon:"share",width:"15",height:"15"}}))}}yh(Eh,"propTypes",{title:K.a.string.isRequired,message:K.a.string,className:K.a.string,tooltipPosition:K.a.string}),yh(Eh,"defaultProps",{tooltipPosition:"bottom-left"});var Oh=r(156),Sh=r(952),vh=r.n(Sh);class Ch extends n.a.Component{constructor(){super(...arguments),this.onClickBackground=this.onClickBackground.bind(this),this.onClickClose=this.onClickClose.bind(this),this.onStartVideo=this.onStartVideo.bind(this)}onClickBackground(e){e.stopPropagation();const{target:t}=e;t instanceof HTMLElement&&t.className.split(" ").find(e=>"pdp-video"===e)&&this.closeModal()}onClickClose(e){e.stopPropagation(),this.closeModal()}onStartVideo(){const e=this.getVideo();if(!e)return;const{uniqueId:t,url:r}=e;Object(nr.a)(rn.a.create($t.a.PaperDetail.VIDEO_START,{uniqueId:t,url:r}))}closeModal(){const e=this.context.history,t=this.context.paperStore,{slug:r,id:a}=t.getPaperDetail().paper,n=Object(ge.d)({routeName:"PAPER_DETAIL",params:{slug:r,paperId:a}});e.replace(n)}getVideo(){const e=this.context.paperStore,{featuredContent:t}=e.getPaperDetail(),{uniqueId:r}=this.props;return r&&t.find(e=>e.uniqueId===r)||null}render(){const e=this.getVideo();if(!e)return null;const{title:t,url:r,summary:a,channel:o,datePosted:i}=e,s=Object(f.b)(e=>e.paperDetail.featured.video.shareTitle,t);return n.a.createElement("div",{className:"pdp-video",onClick:this.onClickBackground},n.a.createElement("a",{className:"close-modal-link flex-row-vcenter",onClick:this.onClickClose},n.a.createElement("span",null,Object(f.b)(e=>e.paperDetail.featured.video.closeButtonLabel)),n.a.createElement(J.a,{icon:"x",className:"flex-right",width:"30",height:"30"})),n.a.createElement("div",{className:"pdp-video__modal"},n.a.createElement(Vu.a,null,n.a.createElement(Pd.a,null,n.a.createElement("h4",{className:"pdp-video__title text--lg"},t),n.a.createElement("div",{className:"flex-row flex-center flex-space-between pdp-video__publish-info"},n.a.createElement("ul",null,o&&n.a.createElement("li",{className:"pdp-video__publish-info-item"},o),i&&n.a.createElement("li",{className:"pdp-video__publish-info-item"},i.format("MMM Do, YYYY"))),n.a.createElement(Eh,{title:s,className:"button--primary flex-right",tooltipPosition:"bottom-right"})))),n.a.createElement("div",{className:"pdp-video__video"},n.a.createElement(vh.a,{controls:!0,url:r,height:480,width:800,onStart:this.onStartVideo})),n.a.createElement("div",{className:"pdp-video__summary"},a)))}}function wh(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-PaperDetailVideoPage"),a.createElement(Ch,e)}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Ch,"contextTypes",{history:K.a.instanceOf(je.a).isRequired,paperStore:K.a.instanceOf(Oh.a).isRequired});class Ph extends a.Component{static getCanonicalUrl(e){if(e.params.slug){const{paperId:t,slug:r,uniqueId:a}=e.params;return Object(ge.d)({routeName:"PAPER_DETAIL_VIDEO",params:{paperId:t,slug:r,uniqueId:a}})}}render(){var e;const t=(null!=(e=this.props)&&null!=(e=e.match)&&null!=(e=e.params)?e.uniqueId:e)||null;return a.createElement(wh,{uniqueId:t})}}var Nh=r(985),xh=r(880),jh=r(811);function Rh(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Th extends a.PureComponent{constructor(){super(...arguments),this.state=this.getStateFromQueryStore(),this.handleToggleClick=this.handleToggleClick.bind(this),this.context.queryStore.registerComponent(this,()=>{this.setState(this.getStateFromQueryStore())})}getStateFromQueryStore(){const e=this.context.queryStore.getCurrentYearRange(),t=(new Date).getUTCFullYear(),r=t-5;return{isSelected:this.getIsSelected(e,r,t),isDisabled:this.getIsDisabled(r,t),currentYear:t,fiveYearsAgo:r}}getIsSelected(e,t,r){return e.min===t&&e.max===r}getIsDisabled(e,t){const{years:r,filteredYears:a}=this.props;return 0===(a.isEmpty()?r:a).filter(r=>r.year>=e&&r.year<=t).reduce((e,t)=>e+t.count,0)}handleToggleClick(){const{queryStore:e,router:t}=this.context,{currentYear:r,fiveYearsAgo:a,isSelected:n}=this.state;n?e.routeToYearRange(null,null,t):e.routeToYearRange(a,r,t)}render(){const{isSelected:e,isDisabled:t}=this.state;return n.a.createElement(jh.a,{isSelected:e,isDisabled:t,text:Object(f.b)(e=>e.serp.toggle.year.title),seleniumSelector:"last-five-years",onToggle:this.handleToggleClick})}}Rh(Th,"contextTypes",{router:K.a.object.isRequired,queryStore:K.a.instanceOf(Us.a).isRequired}),Rh(Th,"propTypes",{filteredYears:K.a.instanceOf(oe.a.List).isRequired,years:K.a.instanceOf(oe.a.List).isRequired});var Ah=r(872);function Ih(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const kh=Hs.PUBLICATION_TYPE.id;class Fh extends a.PureComponent{constructor(){super(...arguments),this.state=this.getStateFromQueryStore(),this.handleToggleClick=this.handleToggleClick.bind(this),this.context.queryStore.registerComponent(this,()=>{this.setState(this.getStateFromQueryStore())})}getDisabledStatus(){const e=this.props.publicationTypes.find(e=>"Reviews"===e.value);return!this.state.isSelected&&(!e||0===e.documentCount)}getStateFromQueryStore(){return{isSelected:this.context.queryStore.isFilterActive(kh,"Reviews")}}handleToggleClick(){const{queryStore:e,router:t}=this.context;e.routeToToggleFilter(kh,"Reviews",t)}render(){return n.a.createElement(jh.a,{isSelected:this.state.isSelected,isDisabled:this.getDisabledStatus(),text:Object(f.b)(e=>e.serp.toggle.review.title),seleniumSelector:"reviews",onToggle:this.handleToggleClick})}}Ih(Fh,"contextTypes",{router:K.a.object.isRequired,queryStore:K.a.instanceOf(Us.a).isRequired}),Ih(Fh,"propTypes",{publicationTypes:K.a.instanceOf(oe.a.OrderedSet).isRequired});var Dh=r(26);function Lh(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class qh extends a.PureComponent{constructor(e,t){super(e,t),Lh(this,"toggleSerpDensity",()=>{const{queryStore:e,router:t}=this.context,r=!this.state.isCompact;this.setState({isCompact:r}),e.routeToToggleSerpDensity(r,t)}),this.state=this.getStateFromQueryStore(),this.context.queryStore.registerComponent(this,()=>{this.setState(this.getStateFromQueryStore)})}getStateFromQueryStore(){return{isCompact:this.context.queryStore.isDisplayCompactActive()}}render(){const{isCompact:e}=this.state;return n.a.createElement(Pd.a,{className:"fresh-filters__density-toggle"},n.a.createElement(rl.a,{iconProps:{icon:"display-compact",width:"12",height:"12"},tagName:"button","data-selenium-selector":"density-toggle-compact",onClick:this.toggleSerpDensity,className:"button button--secondary",text:Object(f.b)(e=>e.serp.toggle.compact.title),disabled:e}),n.a.createElement(rl.a,{iconProps:{icon:"display-comfortable",width:"12",height:"12"},tagName:"button","data-selenium-selector":"density-toggle-comfortable",onClick:this.toggleSerpDensity,className:"button button--secondary",text:Object(f.b)(e=>e.serp.toggle.comfortable.title),disabled:!e}))}}function Mh(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Lh(qh,"contextTypes",{router:K.a.object.isRequired,queryStore:K.a.instanceOf(Us.a).isRequired,cookieJar:K.a.instanceOf(Dh.b).isRequired});const Hh=Hs.EXTERNAL_CONTENT_TYPE.id;class zh extends a.PureComponent{constructor(){super(...arguments),this.state=this.getStateFromQueryStore(),this.handleToggleClick=this.handleToggleClick.bind(this),this.context.queryStore.registerComponent(this,()=>{this.setState(this.getStateFromQueryStore())})}getDisabledStatus(){const e=this.props.externalContentTypes.find(e=>"video"===e.value);return!this.state.isSelected&&(!e||0===e.documentCount)}getStateFromQueryStore(){return{isSelected:this.context.queryStore.isFilterActive(Hh,"video")}}handleToggleClick(){const{queryStore:e,router:t}=this.context;e.routeToToggleFilter(Hh,"video",t)}render(){return n.a.createElement(jh.a,{isSelected:this.state.isSelected,isDisabled:this.getDisabledStatus(),text:Object(f.b)(e=>e.serp.toggle.video.title),seleniumSelector:"has-video-toggle",onToggle:this.handleToggleClick})}}function Uh(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Mh(zh,"contextTypes",{router:K.a.object.isRequired,queryStore:K.a.instanceOf(Us.a).isRequired}),Mh(zh,"propTypes",{externalContentTypes:K.a.instanceOf(oe.a.OrderedSet).isRequired});function Vh(e,t){return t.size>5?n.a.createElement(As.a,{label:Hs.findById(e).displayName,lessText:"Fewer"},r=>n.a.createElement(Is.a,{maxLabelLength:30,collapsible:!1,filterType:e,displayDocCount:!0,filters:t.take(r?t.size:5)})):n.a.createElement(Is.a,{maxLabelLength:30,displayDocCount:!0,collapsible:!1,filterType:e,filters:t})}class Bh extends a.PureComponent{constructor(){super(...arguments),this.setYearRange=this.setYearRange.bind(this)}setYearRange(e,t){const{queryStore:r,router:a}=this.context;r.routeToYearRange(e,t,a)}render(){const{availableFilters:e}=this.props,t=e.get("publicationTypes"),r=e.get("authors"),a=e.get("venues"),o=e.get("externalContentTypes");return n.a.createElement(Vu.a,{className:"flex-row"},n.a.createElement(Pd.a,{className:"fresh-filters__filter_container",width:"25"},t?Vh(Hs.PUBLICATION_TYPE.id,t):null),n.a.createElement(Pd.a,{className:"fresh-filters__filter_container",width:"25"},o.isEmpty()?null:Vh(Hs.EXTERNAL_CONTENT_TYPE.id,o)),n.a.createElement(Pd.a,{className:"fresh-filters__filter_container",width:"25"},r.isEmpty()?null:Vh(Hs.AUTHOR.id,r)),n.a.createElement(Pd.a,{className:"fresh-filters__filter_container",width:"25"},a.isEmpty()?null:Vh(Hs.VENUE.id,a)))}}Uh(Bh,"propTypes",{availableFilters:K.a.object.isRequired}),Uh(Bh,"contextTypes",{queryStore:K.a.instanceOf(Us.a).isRequired,router:K.a.object.isRequired});var Yh=r(871);function Kh(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Wh extends a.PureComponent{constructor(){super(...arguments),this.state={showDensityToggle:this.shouldShowDensityToggle(),filtersAreExpanded:!1},this.toggleFilters=this.toggleFilters.bind(this)}toggleFilters(){this.setState(e=>({filtersAreExpanded:!e.filtersAreExpanded}))}shouldShowDensityToggle(){return this.context.weblabStore.getVariation(ha.b.SerpDensity.KEY)!==ha.b.SerpDensity.Variation.CONTROL}render(){const{response:e,layoutOptions:t,query:r}=this.props,{filtersAreExpanded:a,showDensityToggle:o}=this.state,i=e.stats.get("publicationTypes")||oe.a.OrderedSet(),s=e.stats.get("externalContentTypes")||oe.a.OrderedSet();return n.a.createElement("div",{className:"fresh-filters"},n.a.createElement("div",{className:"fresh-filters__controls"},n.a.createElement("div",{className:"centered-max-width-content"},n.a.createElement(Vu.a,{className:"flex-row-vcenter fresh-filters__flex-container"},n.a.createElement(Pd.a,{className:"fresh-filters__filter_container fresh-filters__filter_container--has-right-border"},n.a.createElement(Ah.a,{response:e})),n.a.createElement(Th,{years:e.stats.get("years"),filteredYears:e.stats.get("filteredYears")||new oe.a.List}),n.a.createElement(Fh,{publicationTypes:i}),n.a.createElement(xh.a,{isToggle:!0}),n.a.createElement(zh,{externalContentTypes:s}),n.a.createElement(Pd.a,null,n.a.createElement("button",{"data-selenium-selector":"more-search-filters",onClick:this.toggleFilters,className:"link-button fresh-filters__filters_button button"},n.a.createElement("span",null,a?"Fewer":"More"," Filters"))),n.a.createElement("div",{className:"fresh-filters__display-controls"},o&&n.a.createElement(qh,null),n.a.createElement(Pd.a,{className:"fresh-filters__sort-control"},n.a.createElement(Yh.a,{className:"select--no-styles",labelText:"Sort By",onChangeSort:this.props.onChangeSort,options:t.sorts,displayType:t.sortDisplayType,sort:r.sort})))))),a?n.a.createElement("div",{className:"fresh-filters__drawer","data-selenium-selector":"fresh-filters"},n.a.createElement("div",{className:"centered-max-width-content fresh-filters__drawer-pointer-container"},n.a.createElement("span",{className:"fresh-filters__drawer-pointer tooltip-pointer"},n.a.createElement("span",{className:"tooltip-pointer-arrow"})),n.a.createElement(Bh,{availableFilters:e.stats}))):null)}}Kh(Wh,"propTypes",{isFiltering:K.a.bool.isRequired,layoutOptions:K.a.object.isRequired,response:K.a.object.isRequired,query:K.a.object.isRequired,onChangeSort:K.a.func.isRequired}),Kh(Wh,"contextTypes",{queryStore:K.a.instanceOf(Us.a).isRequired,weblabStore:K.a.instanceOf(Cr.b).isRequired});var Qh=r(807),Gh=r(962),Xh=r(989);function Jh(e){let{title:t,authors:r,published:a,url:o}=e;return n.a.createElement("li",{className:"slide-item truncate-line"},n.a.createElement(gn.a,{className:"slide-title",href:o},t),n.a.createElement("p",{className:"slide-info"},function(e){return e.size>1?"".concat(e.first()," + ").concat(e.size-1," ").concat(""," "):1===e.size?"".concat(e.first()," ").concat(""," "):""}(r),Pa.a.unix(a).utc().format("MMM DD, YYYY")))}Jh.propTypes={title:K.a.string.isRequired,authors:K.a.instanceOf(oe.a.List).isRequired,published:K.a.number.isRequired,url:K.a.string.isRequired};var Zh=Jh;class $h extends a.PureComponent{constructor(e,t){super(e,t),this.state={collapsed:!0,canToggle:e.slides.size>2},this.toggle=this.toggle.bind(this)}toggle(){this.setState(e=>{let{collapsed:t}=e;return{collapsed:!t}})}render(){const{slides:e}=this.props,{canToggle:t,collapsed:r}=this.state,a=e.take(r?3:e.size);return n.a.createElement("ul",{className:"slide-list"},a.map(e=>{let{id:t,title:r,authors:a,published:o,url:i}=e;return n.a.createElement(Zh,{key:t,title:r,authors:a,published:o,url:i})}),t?n.a.createElement("li",{className:"mod-clickable link-button",onClick:this.toggle},"Show ",r?"More":"Fewer"):null)}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}($h,"propTypes",{slides:K.a.instanceOf(oe.a.List).isRequired});class em extends a.PureComponent{componentDidMount(){Object(nr.a)(tr.a.create($t.a.Serp.MATCHED_SLIDES))}render(){const{queryString:e,slides:t}=this.props;return n.a.createElement(Qh.a,{title:"Slides related to ".concat(e),icon:"slides-list"},n.a.createElement($h,{slides:t}))}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(em,"propTypes",{queryString:K.a.string.isRequired,slides:K.a.instanceOf(oe.a.List).isRequired});var tm=r(963),rm=r(870);class am extends a.PureComponent{render(){const e=this.props.sorts.map((e,t)=>n.a.createElement("div",{className:"sort-explanation-description",key:t},n.a.createElement("h4",{className:"flex-row-vcenter"},n.a.createElement(J.a,{icon:e.icon,width:"15",height:"15",className:"sort-explanation-icon"}),n.a.createElement("span",null,Qa.a.getString("sort.".concat(e.id,".title")))),n.a.createElement("span",{className:"sort-explanation-text",dangerouslySetInnerHTML:{__html:Qa.a.getString("sort.".concat(e.id,".description"))}}))),t=n.a.createElement("div",{className:"sort-explanation-tooltip-content"},e);return n.a.createElement(Pl.a,{tooltipPosition:"bottom-right",className:"flex-right sort-explanation-tooltip",tooltipContent:t},n.a.createElement("div",{className:"flex-row-vcenter"},n.a.createElement("span",{className:"sort-explanation-text-label"},"Learn More"),n.a.createElement(rm.a,null)))}}function nm(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(am,"propTypes",{sorts:K.a.instanceOf(oe.a.List).isRequired});class om extends a.PureComponent{constructor(){super(),this.onChangeSort=this.onChangeSort.bind(this)}onChangeSort(e){this.context.queryStore.routeToSort(e,this.context.router)}render(){return n.a.createElement("div",{className:"controls"},this.props.showResultCount?this.props.isFiltering?n.a.createElement("div",{className:"flex-row-vcenter"},n.a.createElement(Ce.a,{seleniumSelector:"icon-loading-serp"})," Updating results"):n.a.createElement(Ah.a,{response:this.props.response}):null,n.a.createElement("div",{className:"controls-right flex-row"},n.a.createElement(Yh.a,{onChangeSort:this.onChangeSort,options:this.props.sorts,displayType:this.props.sortDisplayType,sort:this.props.query.sort})),this.props.showSortExplanation?n.a.createElement(am,{sorts:this.props.sorts}):null)}}nm(om,"contextTypes",{queryStore:K.a.instanceOf(Us.a).isRequired,router:K.a.object.isRequired}),nm(om,"propTypes",{isFiltering:K.a.bool,query:K.a.object.isRequired,response:K.a.object.isRequired,showResultCount:K.a.bool,sortDisplayType:K.a.string,showSortExplanation:K.a.bool,sorts:K.a.instanceOf(oe.a.List)});var im=r(877);function sm(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class lm extends a.PureComponent{constructor(e,t){super(e,t),this.state=this.stateFromQueryStore(),this.context.queryStore.registerComponent(this,()=>{this.setState(this.stateFromQueryStore())}),this.histogramCallback=this.histogramCallback.bind(this)}histogramCallback(e,t){const{queryStore:r,router:a}=this.context;r.routeToYearRange(e,t,a)}stateFromQueryStore(){return{yearFilter:this.context.queryStore.getQuery().yearFilter}}render(){const{availableFilters:e,isAuthorHomePage:t}=this.props,r=e.get("authors"),a=e.get("coAuthors"),o=e.get("venues"),i=e.get("publicationTypes"),s=e.get("externalContentTypes");return n.a.createElement("div",{className:"filters-wrapper"},n.a.createElement("h4",{className:"filter-header"},"Filter Results:"),n.a.createElement(xh.a,null),t&&n.a.createElement(im.a,{analyticsEvent:$t.a.Serp.YEAR_SLIDER,years:e.get("years"),filteredYears:e.get("filteredYears")||new ne.List,isMobile:!1,filterCallback:this.histogramCallback,histogramWidth:200,histogramHeight:50,yearFilter:this.state.yearFilter}),s.isEmpty()?null:n.a.createElement(Is.a,{filterType:"externalContentType",filters:s}),i.isEmpty()?null:n.a.createElement(Is.a,{filterType:"publicationType",filters:i}),r.isEmpty()?null:n.a.createElement(Is.a,{filterType:"author",filters:r}),a.isEmpty()?null:n.a.createElement(Is.a,{filterType:"coAuthor",filters:a}),o.isEmpty()?null:n.a.createElement(Is.a,{maxLabelLength:$l.a.data.MAX_VENUE_LENGTH,filterType:"venue",filters:o}))}}sm(lm,"contextTypes",{queryStore:K.a.instanceOf(Us.a).isRequired,router:K.a.object.isRequired}),sm(lm,"propTypes",{availableFilters:K.a.object.isRequired,isAuthorHomePage:K.a.bool});class cm extends a.PureComponent{constructor(){super(...arguments)}render(){return a.createElement(ue.c,{feature:er.b.RecommenderSerpAd},a.createElement(ue.b,null,a.createElement("a",{href:"https://s2-sanity.apps.allenai.org",target:"_blank","data-heap-id":"recommender-ad-call-to-action",className:"recommender-ad","data-selenium-selector":"recommender-ad"},a.createElement("div",{className:"recommender-ad__content-container"},a.createElement("div",{className:"recommender-ad__title"},"Start Your Personalized Research Feed"),a.createElement("div",{className:"recommender-ad__description"},"Want to stay up-to-date and spend less time searching for the latest Computer Science research? Get exclusive access to Semantic Sanity: a personalized adaptive arXiv feed created by Semantic Scholar."),a.createElement("span",{className:"recommender-ad__call-to-action button button--primary"},"TRY THE BETA")))))}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(cm,"contextTypes",{iconStore:K.a.instanceOf(us.a).isRequired});var um=r(67);function dm(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const hm=a.createContext({isFirstFeedLink:!1});class mm extends a.PureComponent{constructor(){super(...arguments),dm(this,"loadPage",e=>{e!==this.props.query.page&&(Dl.a.scrollTop(this.props.layoutOptions.scrollToTopOfPage?0:Dl.a.offsetFromBody(Ml.a.findDOMNode(this))),this.context.queryStore.routeToPage(e,this.context.router))}),dm(this,"onChangeSort",e=>{const{queryStore:t,router:r}=this.context;t.routeToSort(e,r)}),dm(this,"onChangeYearFilter",(e,t)=>{const{queryStore:r,router:a}=this.context;r.routeToYearRange(e,t,a)});const e=this.props.response.results.size;this.state={swapIndex:Math.floor(Math.random()*Math.min(6,e))}}componentWillReceiveProps(e){const t=this.props.response.results,r=e.response.results;if(!t.equals(r)){const t=e.response.results.size;this.setState({swapIndex:Math.floor(Math.random()*Math.min(6,t))})}}componentDidUpdate(e){if(!oe.a.is(e.response,this.props.response)&&!this.props.response.results.isEmpty()){const e=Dl.a.scrollTop(),t=this.refs["search-result-".concat(this.props.response.results.size-1)];if(t){const r=Dl.a.offsetFromBody(t);r<e&&Dl.a.scrollTop(r-20)}}}buildResultNodes(e){const{query:t,layoutOptions:{searchResultLayout:r}}=this.props;return e.map((e,n)=>a.createElement(hm.Provider,{key:e.id,value:{isFirstFeedLink:0===n}},a.createElement(kl,{result:e,key:e.id,index:(t.page-1)*t.pageSize+n,ref:"search-result-".concat(n),layout:r})))}renderResults(){const{response:{results:e},skipperSerpData:t}=this.props,r=t.isMember?t.results:new oe.a.List,n=r.size>=(e.size<=10?e.size:10),o=n?this.buildResultNodes(r):this.buildResultNodes(e);return a.createElement($s.a,{experiment:ha.b.SerpReranking2,eligibilityTest:()=>t.isMember&&n},a.createElement(ps.b,null,this.buildResultNodes(e)),a.createElement(ps.c,{variation:"with_reranker"},o))}renderNoResults(){const{querySuggestions:e}=this.props.response,t=!(e&&!e.isEmpty())?void 0:e.first().text;return a.createElement(bs.a,{query:this.props.query.queryString,hasFacets:this.props.response.hasFacets(),suggestedQuery:t})}renderAHPSerp(){const{response:e,isFiltering:t,layoutOptions:r,query:n,isAuthorHomePage:o}=this.props,{results:i,stats:s,matchedAuthors:l}=e;return a.createElement("section",{className:"content"},a.createElement(ms,null,a.createElement(Fl,{className:"filter",side:"left"},a.createElement("div",{ref:"filters"},e.hasFacets()?a.createElement(lm,{availableFilters:s,isAuthorHomePage:o}):null)),a.createElement(Xs,{className:"results"},l.isEmpty()?null:a.createElement(Js.a,{queryString:n.queryString,authors:l}),i.isEmpty()?null:a.createElement(om,{query:n,response:e,isFiltering:t,showResultCount:r.showResultCount,sortDisplayType:r.sortDisplayType,showSortExplanation:r.showSortExplanation,sorts:r.sorts}),a.createElement("div",{className:D()("result-page",{"is-filtering":t})},i.isEmpty()?this.renderNoResults():this.renderResults()),a.createElement("div",{className:"flex-row"},a.createElement(Zs.a,{className:"flex-right",loadPage:this.loadPage,pageNumber:n.page,totalPages:e.totalPages})))))}renderFreshSerpContent(){const{response:e,isFiltering:t,layoutOptions:r,isCompact:n,query:o}=this.props,{matchedAuthors:i,totalPages:s,stats:l,matchedEntity:c,modifiedQueryString:u,matchedPresentations:d}=e;return a.createElement("div",{className:D()("fresh-serp",{"fresh-serp--compact":n})},a.createElement(Wh,{isFiltering:t,layoutOptions:r,onChangeSort:this.onChangeSort,query:o,response:e}),a.createElement(Vu.a,{layoutMed:"column-reverse",className:"centered-max-width-content",role:"main",id:"main-content"},a.createElement(Pd.a,{width:"66",className:"flex-item__left-column",seleniumSelector:"results"},i.isEmpty()?null:a.createElement(ps.a,{experiment:ha.b.SerpAuthorShoveler,isolated:!0,exposeOnRender:!0},a.createElement(ps.c,{variation:ha.b.SerpAuthorShoveler.Variation.SHOVELER},a.createElement(Gh.a,{queryString:o.queryString,authors:i}))),u?a.createElement(tm.a,{originalQuery:e.query.queryString,modifiedQuery:u}):null,a.createElement("div",{className:D()("result-page",{"is-filtering":t})},this.renderResults()),a.createElement(Zs.a,{className:"flex-right",loadPage:this.loadPage,pageNumber:o.page,totalPages:s})),a.createElement(Pd.a,{width:"33",className:"flex-item__right-column"},a.createElement(cm,null),l.get("years").size>1?a.createElement(Qh.a,{title:Qa.a.getString("serp.histogram.title"),icon:"bar-chart",className:"histogram"},a.createElement(ks.a,{analyticsEvent:$t.a.Serp.YEAR_SLIDER,filterCallback:this.onChangeYearFilter,filters:l,yearFilter:o.yearFilter,yearBuckets:null,showPresetButtons:!0})):null,c?a.createElement(Xh.a,{entity:c}):null,i.isEmpty()?null:a.createElement(ps.a,{experiment:ha.b.SerpAuthorShoveler,isolated:!0,exposeOnRender:!0},a.createElement(ps.b,null,a.createElement(Js.a,{displayAsInfoBox:!0,queryString:o.queryString,authors:i}))),!d.isEmpty()&&i.isEmpty()?a.createElement(em,{queryString:o.queryString,slides:d}):null)))}renderFreshSerpNoResults(){const{isFiltering:e}=this.props;return a.createElement("div",{className:"fresh-serp"},a.createElement(Vu.a,{className:"centered-max-width-content",role:"main",id:"main-content"},a.createElement(Pd.a,{width:"66",className:"flex-item__left-column"},a.createElement("div",{className:D()("result-page",{"is-filtering":e})},this.renderNoResults()))))}renderSerp(){return this.props.response.results.isEmpty()?this.renderFreshSerpNoResults():this.renderFreshSerpContent()}render(){return this.props.isAuthorHomePage?this.renderAHPSerp():this.renderSerp()}}dm(mm,"contextTypes",{queryStore:K.a.instanceOf(Us.a).isRequired,router:K.a.object.isRequired,userPrefsStore:K.a.instanceOf(um.b).isRequired,weblabStore:K.a.instanceOf(Cr.b).isRequired}),dm(mm,"propTypes",{isAuthorHomePage:K.a.bool,isFiltering:K.a.bool,isCompact:K.a.bool.isRequired,query:K.a.object.isRequired,response:K.a.object.isRequired,layoutOptions:K.a.object.isRequired,skipperSerpData:K.a.object.isRequired});var pm=r(170);function bm(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function gm(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class fm extends a.PureComponent{constructor(){super(...arguments),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?bm(Object(r),!0).forEach((function(t){gm(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bm(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.stateFromQueryStore(),{},this.stateFromSerpRerankingStore()),this.context.queryStore.registerComponent(this,()=>{this.setState(this.stateFromQueryStore())}),this.context.serpRerankingStore.registerComponent(this,()=>{this.setState(this.stateFromSerpRerankingStore())})}stateFromQueryStore(){const e=this.context.weblabStore.getVariation(ha.b.SerpDensityNoToggle.KEY)===ha.b.SerpDensityNoToggle.Variation.COMPACT;return{queryStoreState:this.context.queryStore._state,query:this.context.queryStore._query,response:this.context.queryStore._response,isCompact:e}}stateFromSerpRerankingStore(){return{isSkipperLoading:this.context.serpRerankingStore.isLoading(),skipperSerpData:this.context.serpRerankingStore.getResults()}}render(){const{queryStoreState:e,query:t,response:r,isCompact:n,skipperSerpData:o}=this.state;return e===Ll.a.LOADING||e===Ll.a.INITIALIZED?a.createElement("section",{className:"content",role:"main",id:"main-content"},a.createElement("div",{className:"container loading-controls flex-row-vcenter"},a.createElement(Ce.a,{seleniumSelector:"icon-loading-serp"})," Loading results")):a.createElement(mm,{isAuthorHomePage:this.props.isAuthorHomePage,isCompact:n,query:t,response:r,skipperSerpData:o,layoutOptions:this.props.layoutOptions,isFiltering:e===Ll.a.FILTERING})}}gm(fm,"contextTypes",{queryStore:K.a.instanceOf(Us.a).isRequired,serpRerankingStore:K.a.instanceOf(pm.a).isRequired,weblabStore:K.a.instanceOf(Cr.b).isRequired}),gm(fm,"propTypes",{isAuthorHomePage:K.a.bool,layoutOptions:K.a.object.isRequired});var _m=r(18),ym=r(4);function Em(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Om(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Sm=Object(Vl.a)($t.a.Serp)(ea.a),vm=Object(Vl.a)($t.a.Serp)(fm);class Cm extends a.Component{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Em(Object(r),!0).forEach((function(t){Om(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Em(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.stateFromQueryStore()),this.context.queryStore.registerComponent(this,()=>{this.setState(this.stateFromQueryStore())})}stateFromQueryStore(){return{isLoading:this.context.queryStore._state===Ll.a.LOADING||this.context.serpRerankingStore._state===ym.a.LOADING}}render(){const{isLoading:e}=this.state,t=new Ks;return a.createElement(Sr.a,{className:"search",header:a.createElement(Sm,{showSearchBar:!0,submitSearchOnFieldOfStudyChange:!0}),footer:!e},a.createElement(vm,{layoutOptions:t}))}}function wm(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-SearchResultsPage"),a.createElement(Cm,e)}Om(Cm,"contextTypes",{alertsStore:K.a.instanceOf(sn.a).isRequired,api:K.a.instanceOf(pe.a).isRequired,authStore:K.a.instanceOf(Ne.a).isRequired,feedApi:K.a.instanceOf(_m.a).isRequired,queryStore:K.a.instanceOf(Us.a).isRequired,serpRerankingStore:K.a.instanceOf(pm.a).isRequired});class Pm extends a.Component{static getPageTitle(e){let{queryStore:t}=e;const r=t.getQueryString();return r?Object(f.b)(e=>e.serp.pageTitleWithQuery,r):Object(f.b)(e=>e.serp.pageTitleWithoutQuery)}static async willRouteTo(e,t){const{api:r,authStore:a,feedApi:n}=e;if(!Object(De.a)())return Us.a.setQueryAndLoadingState(e,t);const o=a.hasAuthenticatedUser()?n.getFeeds():Promise.resolve(),i=Us.a.executeSearchQuery(e,t),s=pm.a.executeSearchQuery(e),l=(await Promise.all([i,o,s]))[0];if(!l.resultData)return l;const{matchedEntity:c}=l.resultData;return a.hasAuthenticatedUser()&&c?r.findAlertByQueryTypeAndValue(Ha.b.ENTITY_PAPER,c.id):l}render(){return a.createElement(wm,null)}}var Nm=r(994),xm=r(986),jm=r(987),Rm=r(964);t.default=[Object(Rm.a)({component:pn.a,routes:[Object(Rm.a)({path:ge.b.HOME,exact:!0,component:zu}),Object(Rm.a)({path:ge.b.ENTITY_LANDING,exact:!0,component:eu.a}),Object(Rm.a)({path:ge.b.ENTITY_BY_ID,exact:!0,component:tu.a}),Object(Rm.a)({path:ge.b.ENTITY,component:ru.a}),Object(Rm.a)({path:ge.b.SEARCH,component:Pm}),Object(Rm.a)({path:ge.b.PAPER_LANDING,exact:!0,component:Nh.a}),Object(Rm.a)({path:ge.b.PAPER_DETAIL_BY_ID,exact:!0,component:mh.a}),Object(Rm.a)({path:ge.b.PAPER_DETAIL_PDF_REDIRECT,exact:!0,component:mh.a}),Object(Rm.a)({path:ge.b.PAPER_DETAIL_CITED_BY,component:mh.a}),Object(Rm.a)({path:ge.b.PAPER_DETAIL_REFERENCES,component:mh.a}),Object(Rm.a)({path:ge.b.PAPER_DETAIL,component:ph.a,routes:[Object(Rm.a)({path:ge.b.PAPER_DETAIL_FIGURE,component:hh.a}),Object(Rm.a)({path:ge.b.PAPER_DETAIL_VIDEO,component:Ph})]}),Object(Rm.a)({path:ge.b.AUTHOR_ONBOARDING,component:cs,routes:[Object(Rm.a)({path:ge.b.AUTHOR_ONBOARDING_PROFILE,component:Yi}),Object(Rm.a)({path:ge.b.AUTHOR_ONBOARDING_REMOVE_PAPERS,component:Zi}),Object(Rm.a)({path:ge.b.AUTHOR_ONBOARDING_ADD_PAPERS,component:Ri}),Object(Rm.a)({path:ge.b.AUTHOR_ONBOARDING_COMPLETE,component:Li})]}),Object(Rm.a)({path:ge.b.ADMIN_EXPERIMENT_AUDIT,component:Aa}),Object(Rm.a)({path:ge.b.ADMIN,component:ia,routes:[Object(Rm.a)({path:ge.b.ADMIN_EXPERIMENTS,component:Ca}),Object(Rm.a)({path:ge.b.ADMIN_FEATURE_FLAGS,component:Ma})]}),Object(Rm.a)({path:ge.b.MODERATION,component:eh,routes:[Object(Rm.a)({path:ge.b.AUTHOR_CLAIM_MODERATION,component:pi}),Object(Rm.a)({path:ge.b.AUTHOR_AUTHORSHIP_MODERATION,component:uc}),Object(Rm.a)({path:ge.b.AUTHOR_CORRECTIONS_TOOL,component:uh,routes:[Object(Rm.a)({path:ge.b.AUTHOR_CORRECTIONS_TOOL_AUTHOR_INPUT,component:oh}),Object(Rm.a)({path:ge.b.AUTHOR_CORRECTIONS_TOOL_CONTACT,component:Rt}),Object(Rm.a)({path:ge.b.AUTHOR_CORRECTIONS_TOOL_REMOVE_PAPERS,component:Jr}),Object(Rm.a)({path:ge.b.AUTHOR_CORRECTIONS_TOOL_ADD_PAPERS,component:Ve}),Object(Rm.a)({path:ge.b.AUTHOR_CORRECTIONS_TOOL_STATUS,component:Xt})]})]}),Object(Rm.a)({path:ge.b.AUTHOR_LANDING,exact:!0,component:fi.a}),Object(Rm.a)({path:ge.b.AUTHOR_PROFILE_BY_CLAIMED,component:gi.a}),Object(Rm.a)({path:ge.b.AUTHOR_CLAIM,component:bi.a}),Object(Rm.a)({path:ge.b.AUTHOR_CLAIM_COMPLETE,component:bn.a}),Object(Rm.a)({path:ge.b.AUTHOR_PROFILE_BY_ID,exact:!0,component:ec}),Object(Rm.a)({path:ge.b.AUTHOR_PROFILE,component:ec}),Object(Rm.a)({path:ge.b.CREATE_ALERT,component:Sc}),Object(Rm.a)({path:ge.b.ALERTS,component:mn}),Object(Rm.a)({path:ge.b.ALERTS_UNSUBSCRIBE,component:xm.a}),Object(Rm.a)({path:ge.b.ALERTS_UNSUBSCRIBE_ALL,component:xm.a}),Object(Rm.a)({path:ge.b.LIBRARY,component:Dd,routes:[Object(Rm.a)({path:ge.b.LIBRARY,exact:!0,component:wd}),Object(Rm.a)({path:ge.b.LIBRARY_TAG_MANAGEMENT,exact:!0,component:Kd}),Object(Rm.a)({path:ge.b.LIBRARY_TAG,component:wd})]}),Object(Rm.a)({path:ge.b.FEEDS,exact:!0,component:_u.a}),Object(Rm.a)({path:ge.b.FEEDS_FEED,component:yu.a,routes:[Object(Rm.a)({path:ge.b.FEEDS_RATED,component:Eu.a}),Object(Rm.a)({path:ge.b.FEEDS_RECOMMENDATIONS,component:Su.a})]}),Object(Rm.a)({path:ge.b.FEEDS_FTUE,component:Ou.a}),Object(Rm.a)({path:ge.b.ACCOUNT,component:Tr,routes:[Object(Rm.a)({path:ge.b.ACCOUNT_AUTHOR_CLAIM_PENDING,component:Ge}),Object(Rm.a)({path:ge.b.ACCOUNT_AUTHOR_CONTACT,component:Rt}),Object(Rm.a)({path:ge.b.ACCOUNT_ALERTS,component:dn}),Object(Rm.a)({path:ge.b.ACCOUNT_REMOVE_PAPERS,component:Jr}),Object(Rm.a)({path:ge.b.ACCOUNT_ADD_PAPERS,component:Ve}),Object(Rm.a)({path:ge.b.ACCOUNT_CORRECTIONS,component:Xt}),Object(Rm.a)({path:ge.b.ACCOUNT_CONTACT,component:dr}),Object(Rm.a)({path:ge.b.ACCOUNT_MANAGE,component:yr})]}),Object(Rm.a)({path:ge.b.USER_VERIFY_EMAIL,component:jm.a}),Object(Rm.a)({path:ge.b.SIGN_IN,component:Nm.a}),Object(Rm.a)({path:ge.b.ADD_ENROLLMENT_REDIRECT,component:Zr.a}),Object(Rm.a)({path:ge.b.CRAWLER,component:_c}),Object(Rm.a)({path:ge.b.FAQ,component:fu}),Object(Rm.a)({path:ge.b.CORD19_HOME,exact:!0,component:dc.a}),Object(Rm.a)({path:ge.b.CORD19_ABOUT,component:hc.a}),Object(Rm.a)({path:ge.b.CORD19_GET_STARTED,component:pc.a}),Object(Rm.a)({path:ge.b.CORD19_DOWNLOAD,component:mc.a}),Object(Rm.a)({path:ge.b.DEBUG_COMPONENT_LIBRARY,exact:!0,component:Qc}),Object(Rm.a)({path:ge.b.DEBUG_COMPONENT_LIBRARY_COMPONENT,component:Qc}),Object(Rm.a)({path:ge.b.DEBUG_COMPONENT_LIBRARY_PREVIEW,component:Gc.a}),Object(Rm.a)({path:ge.b.DEBUG_SILO_VIEWER,component:Uu.a}),Object(Rm.a)({path:ge.b.DEBUG_SPRITES,component:$c}),Object(Rm.a)({component:dh.a})]})]},738:function(e,t,r){e.exports=r(1074)()},762:function(e,t){e.exports=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}},775:function(e,t){e.exports=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}},776:function(e,t,r){var a=r(1073);e.exports=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){a(e,t,r[t])}))}return e}},777:function(e,t){function r(){return e.exports=r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},r.apply(this,arguments)}e.exports=r},778:function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},818:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return c})),r.d(t,"exampleConfig",(function(){return u}));var a=r(226),n=r(14),o=r(716),i=r.n(o);function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function l(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function c(e){let{children:t,className:r,isInline:a,isOptional:o,optionalLabel:c}=e,u=l(e,["children","className","isInline","isOptional","optionalLabel"]);return n.createElement("div",s({},u,{className:i()({"cl-field-label":!0,"cl-field-label--is-inline":a,"cl-field-label--is-optional":o},r)}),n.createElement("span",{className:"cl-field-label__content"},t),o&&n.createElement("span",{className:"cl-field-label__optional"},c))}c.defaultProps={isInline:!1,isOptional:!1,optionalLabel:Object(a.b)(e=>e.componentLibrary.form.fieldLabel.optionalLabel)};const u={fields:[{name:"isInline",desc:"Position the component inline with other elements (like a radio button)",value:{type:"boolean",default:c.defaultProps.isInline}},{name:"isOptional",desc:"Whether the field is optional",value:{type:"boolean",default:c.defaultProps.isOptional}},{name:"children",desc:"Content to be displayed within the component",value:{type:"jsx",default:"",transform:e=>n.createElement("span",{dangerouslySetInnerHTML:{__html:e}})}},{name:"optionalLabel",desc:"Content to be displayed within the component",value:{type:"jsx",default:c.defaultProps.optionalLabel,transform:e=>n.createElement("span",{dangerouslySetInnerHTML:{__html:e}})}}],examples:[{title:"Required",desc:"Label for a field which is required",props:{children:"Email Address"}},{title:"Optional (default)",desc:"Label for a field which is optional",props:{children:"Affiliation",isOptional:!0}},{title:"Optional (custom)",desc:"Label for a field which is optional",props:{children:"Affiliation",isOptional:!0,optionalLabel:"If you have one"}},{title:"Checkbox",desc:"Label for a checkbox",props:{children:"Checkbox",isInline:!0},render:e=>n.createElement("label",null,n.createElement("input",{type:"checkbox",className:"legacy__input",style:{marginRight:"7px"}}),e)}],events:{}}}}]);
//# sourceMappingURL=bundle-5.js.map